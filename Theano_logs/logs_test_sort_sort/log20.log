.........C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:293: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
....................................................................................................................................................................................................................................................................................................................................................................................................................C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
...........................................................................................................................................................................................................................................................................................................................................C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
......C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
......C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
......C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
..........................................................................................................................E.E..........E.C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
............C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
....C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
...
======================================================================
ERROR: test1 (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 36, in test1
    utt.assert_allclose(f(self.m_val), np.sort(self.m_val))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (3, 2) float64 (16, 8) 0.012703197034767633 0.9514579574463393 0 0 
  Value    : (3, 2) float64 (16, 8) 0.012703197034767633 0.9514579574463393 0 0 
  expected    : [[0.67651434 0.0127032 ]
 [0.70043712 0.72785806]
 [0.95145796 0.84418664]]
  value    : [[0.70043712 0.84418664]
 [0.67651434 0.72785806]
 [0.0127032  0.95145796]]
  Max Abs Diff:  0.9387547604115717
  Mean Abs Diff:  0.320892515443927
  Median Abs Diff:  0.06559705025805701
  Std Abs Diff:  0.40154802875056744
  Max Rel Diff:  65.4546602355268
  Mean Rel Diff:  11.106315910805913
  Median Rel Diff:  0.08121622246285165
  Std Rel Diff:  24.307759623387575

  rtol, atol: 1e-05 1e-08


======================================================================
ERROR: test3 (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 53, in perform
    z[0] = np.sort(a, axis, self.kind, self.order)
  File "<__array_function__ internals>", line 6, in sort
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 989, in sort
    a.sort(axis=axis, kind=kind, order=order)
numpy.AxisError: axis -2 is out of bounds for array of dimension 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 52, in test3
    gv = f(self.v_val)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 53, in perform
    z[0] = np.sort(a, axis, self.kind, self.order)
  File "<__array_function__ internals>", line 6, in sort
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 989, in sort
    a.sort(axis=axis, kind=kind, order=order)
numpy.AxisError: axis -2 is out of bounds for array of dimension 1
Apply node that caused the error: SortOp{quicksort, None}(<TensorType(float64, vector)>, TensorConstant{-2})
Toposort index: 0
Inputs types: [TensorType(float64, vector), TensorType(int8, scalar)]
Inputs shapes: [(4,), ()]
Inputs strides: [(8,), ()]
Inputs values: [array([0.4135877 , 0.04881279, 0.09992856, 0.50806631]), array(-2, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 50, in test3
    w2 = sort(a)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_grad_vector (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 53, in perform
    z[0] = np.sort(a, axis, self.kind, self.order)
  File "<__array_function__ internals>", line 6, in sort
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 989, in sort
    a.sort(axis=axis, kind=kind, order=order)
numpy.AxisError: axis -2 is out of bounds for array of dimension 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 85, in test_grad_vector
    utt.verify_grad(sort, [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1738, in verify_grad
    o_fn_out = o_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 53, in perform
    z[0] = np.sort(a, axis, self.kind, self.order)
  File "<__array_function__ internals>", line 6, in sort
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 989, in sort
    a.sort(axis=axis, kind=kind, order=order)
numpy.AxisError: axis -2 is out of bounds for array of dimension 1
Apply node that caused the error: SortOp{quicksort, None}(input 0, TensorConstant{-2})
Toposort index: 0
Inputs types: [TensorType(float64, vector), TensorType(int8, scalar)]
Inputs shapes: [(10,), ()]
Inputs strides: [(8,), ()]
Inputs values: ['not shown', array(-2, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 85, in test_grad_vector
    utt.verify_grad(sort, [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

----------------------------------------------------------------------
Ran 918 tests in 52.699s

FAILED (errors=3)
