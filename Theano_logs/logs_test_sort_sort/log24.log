.........C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:293: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
....................................................................................................................................................................................................................................................................................................................................................................................................................C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
...........................................................................................................................................................................................................................................................................................................................................C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
......C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
......C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
......C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:282: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zv = np.partition(x, -k, axis=axis)[idx]
C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
................................................................................................................................EEE.EEE..C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
............C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
....C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
...
======================================================================
ERROR: test_grad_negative_axis_2d (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: Input dimension mis-match. (input[1].shape[1] = 6, input[2].shape[1] = 3)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 99, in test_grad_negative_axis_2d
    utt.verify_grad(lambda x: sort(x, -1), [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ("Input dimension mis-match. (input[1].shape[1] = 6, input[2].shape[1] = 3)\nApply node that caused the error: Elemwise{Switch}[(0, 1)](TensorConstant{(1, 1) of True}, InplaceDimShuffle{x,0}.0, InplaceDimShuffle{x,0}.0)\nToposort index: 11\nInputs types: [TensorType(bool, (True, True)), TensorType(int64, row), TensorType(int64, row)]\nInputs shapes: [(1, 1), (1, 6), (1, 3)]\nInputs strides: [(1, 1), (48, 8), (24, 8)]\nInputs values: [array([[ True]]), 'not shown', array([[0, 1, 2]], dtype=int64)]\nOutputs clients: [[AdvancedSubtensor(random_projection, Elemwise{switch,no_inplace}.0, Elemwise{Switch}[(0, 1)].0)]]\n\nHINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.\nHINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.", '\nThe error happened with the following inputs:', [array([[0.39530844, 0.3775309 , 0.05935789],
       [0.7355325 , 0.30086229, 0.27390944]])], '\nThe value of eps is:', None, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_negative_axis_3d (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: Input dimension mis-match. (input[1].shape[2] = 24, input[2].shape[2] = 4)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 105, in test_grad_negative_axis_3d
    utt.verify_grad(lambda x: sort(x, -1), [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ("Input dimension mis-match. (input[1].shape[2] = 24, input[2].shape[2] = 4)\nApply node that caused the error: Elemwise{Switch}[(0, 1)](TensorConstant{(1, 1, 1) of True}, InplaceDimShuffle{x,x,0}.0, InplaceDimShuffle{x,x,0}.0)\nToposort index: 15\nInputs types: [TensorType(bool, (True, True, True)), TensorType(int64, (True, True, False)), TensorType(int64, (True, True, False))]\nInputs shapes: [(1, 1, 1), (1, 1, 24), (1, 1, 4)]\nInputs strides: [(1, 1, 1), (192, 192, 8), (32, 32, 8)]\nInputs values: [array([[[ True]]]), 'not shown', array([[[0, 1, 2, 3]]], dtype=int64)]\nOutputs clients: [[AdvancedSubtensor(random_projection, Elemwise{switch,no_inplace}.0, Elemwise{switch,no_inplace}.0, Elemwise{Switch}[(0, 1)].0)]]\n\nHINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.\nHINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.", '\nThe error happened with the following inputs:', [array([[[0.4135877 , 0.04881279, 0.09992856, 0.50806631],
        [0.20024754, 0.74415417, 0.192892  , 0.70084475],
        [0.29322811, 0.77447945, 0.00510884, 0.11285765]],

       [[0.11095367, 0.24766823, 0.0232363 , 0.72732115],
        [0.34003494, 0.19750316, 0.90917959, 0.97834699],
        [0.53280254, 0.25913185, 0.58381262, 0.32569065]]])], '\nThe value of eps is:', None, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_negative_axis_4d (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: Input dimension mis-match. (input[1].shape[3] = 48, input[2].shape[3] = 2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 113, in test_grad_negative_axis_4d
    utt.verify_grad(lambda x: sort(x, -1), [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ("Input dimension mis-match. (input[1].shape[3] = 48, input[2].shape[3] = 2)\nApply node that caused the error: Elemwise{Switch}[(0, 1)](TensorConstant{(1, 1, 1, 1) of True}, InplaceDimShuffle{x,x,x,0}.0, InplaceDimShuffle{x,x,x,0}.0)\nToposort index: 19\nInputs types: [TensorType(bool, (True, True, True, True)), TensorType(int64, (True, True, True, False)), TensorType(int64, (True, True, True, False))]\nInputs shapes: [(1, 1, 1, 1), (1, 1, 1, 48), (1, 1, 1, 2)]\nInputs strides: [(1, 1, 1, 1), (384, 384, 384, 8), (16, 16, 16, 8)]\nInputs values: [array([[[[ True]]]]), 'not shown', array([[[[0, 1]]]], dtype=int64)]\nOutputs clients: [[AdvancedSubtensor(random_projection, Elemwise{switch,no_inplace}.0, Elemwise{switch,no_inplace}.0, Elemwise{switch,no_inplace}.0, Elemwise{Switch}[(0, 1)].0)]]\n\nHINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.\nHINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.", '\nThe error happened with the following inputs:', [array([[[[0.90917959, 0.97834699],
         [0.53280254, 0.25913185],
         [0.58381262, 0.32569065],
         [0.88889931, 0.62640453]],

        [[0.81887369, 0.54734542],
         [0.41671201, 0.74304719],
         [0.36959638, 0.07516654],
         [0.77519298, 0.21940924]],

        [[0.07934213, 0.48678052],
         [0.1536739 , 0.82846513],
         [0.19136857, 0.27040895],
         [0.56103442, 0.90238039]]],


       [[[0.85178834, 0.41808196],
         [0.39347627, 0.01622051],
         [0.29921337, 0.35377822],
         [0.89350267, 0.78613657]],

        [[0.77138693, 0.42005486],
         [0.77602514, 0.46430814],
         [0.18177017, 0.8840256 ],
         [0.71879227, 0.6718813 ]],

        [[0.25656363, 0.43080182],
         [0.01645358, 0.23499383],
         [0.51117131, 0.29200924],
         [0.50189351, 0.49827313]]]])], '\nThe value of eps is:', None, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_nonnegative_axis_2d (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: Input dimension mis-match. (input[1].shape[1] = 6, input[2].shape[1] = 3)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 123, in test_grad_nonnegative_axis_2d
    utt.verify_grad(lambda x: sort(x, 0), [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ("Input dimension mis-match. (input[1].shape[1] = 6, input[2].shape[1] = 3)\nApply node that caused the error: Elemwise{Switch}[(0, 1)](TensorConstant{(1, 1) of False}, InplaceDimShuffle{x,0}.0, InplaceDimShuffle{x,0}.0)\nToposort index: 11\nInputs types: [TensorType(bool, (True, True)), TensorType(int64, row), TensorType(int64, row)]\nInputs shapes: [(1, 1), (1, 6), (1, 3)]\nInputs strides: [(1, 1), (48, 8), (24, 8)]\nInputs values: [array([[False]]), 'not shown', array([[0, 1, 2]], dtype=int64)]\nOutputs clients: [[AdvancedSubtensor(random_projection, Elemwise{switch,no_inplace}.0, Elemwise{Switch}[(0, 1)].0)]]\n\nHINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.\nHINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.", '\nThe error happened with the following inputs:', [array([[0.85178834, 0.41808196, 0.39347627],
       [0.01622051, 0.29921337, 0.35377822]])], '\nThe value of eps is:', None, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_nonnegative_axis_3d (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: Input dimension mis-match. (input[1].shape[2] = 24, input[2].shape[2] = 4)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 129, in test_grad_nonnegative_axis_3d
    utt.verify_grad(lambda x: sort(x, 0), [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ("Input dimension mis-match. (input[1].shape[2] = 24, input[2].shape[2] = 4)\nApply node that caused the error: Elemwise{Switch}[(0, 1)](TensorConstant{(1, 1, 1) of False}, InplaceDimShuffle{x,x,0}.0, InplaceDimShuffle{x,x,0}.0)\nToposort index: 15\nInputs types: [TensorType(bool, (True, True, True)), TensorType(int64, (True, True, False)), TensorType(int64, (True, True, False))]\nInputs shapes: [(1, 1, 1), (1, 1, 24), (1, 1, 4)]\nInputs strides: [(1, 1, 1), (192, 192, 8), (32, 32, 8)]\nInputs values: [array([[[False]]]), 'not shown', array([[[0, 1, 2, 3]]], dtype=int64)]\nOutputs clients: [[AdvancedSubtensor(random_projection, Elemwise{switch,no_inplace}.0, Elemwise{switch,no_inplace}.0, Elemwise{Switch}[(0, 1)].0)]]\n\nHINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.\nHINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.", '\nThe error happened with the following inputs:', [array([[[0.4135877 , 0.04881279, 0.09992856, 0.50806631],
        [0.20024754, 0.74415417, 0.192892  , 0.70084475],
        [0.29322811, 0.77447945, 0.00510884, 0.11285765]],

       [[0.11095367, 0.24766823, 0.0232363 , 0.72732115],
        [0.34003494, 0.19750316, 0.90917959, 0.97834699],
        [0.53280254, 0.25913185, 0.58381262, 0.32569065]]])], '\nThe value of eps is:', None, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_nonnegative_axis_4d (test_sort.Test_sort)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: Input dimension mis-match. (input[1].shape[3] = 48, input[2].shape[3] = 2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 137, in test_grad_nonnegative_axis_4d
    utt.verify_grad(lambda x: sort(x, 0), [data])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ("Input dimension mis-match. (input[1].shape[3] = 48, input[2].shape[3] = 2)\nApply node that caused the error: Elemwise{Switch}[(0, 1)](TensorConstant{(1, 1, 1, ..) of False}, InplaceDimShuffle{x,x,x,0}.0, InplaceDimShuffle{x,x,x,0}.0)\nToposort index: 19\nInputs types: [TensorType(bool, (True, True, True, True)), TensorType(int64, (True, True, True, False)), TensorType(int64, (True, True, True, False))]\nInputs shapes: [(1, 1, 1, 1), (1, 1, 1, 48), (1, 1, 1, 2)]\nInputs strides: [(1, 1, 1, 1), (384, 384, 384, 8), (16, 16, 16, 8)]\nInputs values: [array([[[[False]]]]), 'not shown', array([[[[0, 1]]]], dtype=int64)]\nOutputs clients: [[AdvancedSubtensor(random_projection, Elemwise{switch,no_inplace}.0, Elemwise{switch,no_inplace}.0, Elemwise{switch,no_inplace}.0, Elemwise{Switch}[(0, 1)].0)]]\n\nHINT: Re-running with most Theano optimization disabled could give you a back-trace of when this node was created. This can be done with by setting the Theano flag 'optimizer=fast_compile'. If that does not work, Theano optimizations can be disabled with 'optimizer=None'.\nHINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.", '\nThe error happened with the following inputs:', [array([[[[0.90917959, 0.97834699],
         [0.53280254, 0.25913185],
         [0.58381262, 0.32569065],
         [0.88889931, 0.62640453]],

        [[0.81887369, 0.54734542],
         [0.41671201, 0.74304719],
         [0.36959638, 0.07516654],
         [0.77519298, 0.21940924]],

        [[0.07934213, 0.48678052],
         [0.1536739 , 0.82846513],
         [0.19136857, 0.27040895],
         [0.56103442, 0.90238039]]],


       [[[0.85178834, 0.41808196],
         [0.39347627, 0.01622051],
         [0.29921337, 0.35377822],
         [0.89350267, 0.78613657]],

        [[0.77138693, 0.42005486],
         [0.77602514, 0.46430814],
         [0.18177017, 0.8840256 ],
         [0.71879227, 0.6718813 ]],

        [[0.25656363, 0.43080182],
         [0.01645358, 0.23499383],
         [0.51117131, 0.29200924],
         [0.50189351, 0.49827313]]]])], '\nThe value of eps is:', None, '\nThe out_type is:', None)

----------------------------------------------------------------------
Ran 918 tests in 61.574s

FAILED (errors=6)
