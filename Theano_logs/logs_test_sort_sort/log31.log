.........FFFFFFFFFFFFEEEE........FFFFFFFFFFFFEEEE........FFFFFFFFFFFFEEEEF....EE....EE....EEE....FFFFEEEEFFFF....FFFFEEEEFFFF....FFFFEEEEFFFF................................................................................................................................................................................................................................................................................FFFFFFFFFFFFFFFF........FFFFFFFFFFFFFFFF........FFFFFFFFFFFFFFFFF..........................................................................................................................................................................................................................................................................EEEE..EEEE..EEEE..EEEE........EEEEEEEEEEEEEEEEEEEE........EEEEEEEEEEEEEEEEEEEE........EEEEEEEEEEEEEEEEEEEEE................................................FFC:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
..FF..FF..FFC:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
..FFC:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py:285: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  zi = np.argpartition(x, -k, axis=axis)[idx]
.
======================================================================
ERROR: test_argtopk_1d_20 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(float32, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_21 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(float32, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_22 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(int32, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_23 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(int32, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_44 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(float32, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_45 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(float32, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_46 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(int32, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_47 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(int32, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_68 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(float32, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_69 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(float32, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_70 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(int32, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_71 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 328, in test_argtopk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(int32, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(4,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 319, in test_argtopk_1d
    y = argtopk(x, k, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_1d_collision_04 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 388, in test_argtopk_1d_collision
    utt.assert_allclose(np.sort(xval[yval]), np.sort(xval[goal]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (9,) int32 (4,) -93 83 0 0 
  Value    : (9,) int32 (4,) -64 83 0 0 
  expected    : [-93 -72 -72 -67 -64 -64 -55   1  83]
  value    : [-64 -55 -55 -49 -49   1   1  83  83]
  Max Abs Diff:  82
  Mean Abs Diff:  33.22222222222222
  Median Abs Diff:  18.0
  Std Abs Diff:  26.07586273326255
  Max Rel Diff:  82.0
  Mean Rel Diff:  9.480098745979022
  Median Rel Diff:  0.26865671641791045
  Std Rel Diff:  25.641878896129896

  rtol, atol: 1e-05 1e-08


======================================================================
ERROR: test_argtopk_1d_collision_05 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 388, in test_argtopk_1d_collision
    utt.assert_allclose(np.sort(xval[yval]), np.sort(xval[goal]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (9,) float32 (4,) -48.097828 61.284775 0 0 
  Value    : (9,) float32 (4,) 39.039894 82.28401 0 0 
  expected    : [-48.097828 -37.58183  -37.58183  -37.13376   39.039894  46.66824
  47.273285  61.284775  61.284775]
  value    : [39.039894 46.66824  46.66824  47.273285 47.273285 61.284775 61.284775
 82.28401  82.28401 ]
  Max Abs Diff:  87.137726
  Mean Abs Diff:  46.544975
  Median Abs Diff:  20.999237
  Std Abs Diff:  34.60163
  Max Rel Diff:  2.2730541
  Mean Rel Diff:  1.1193417
  Median Rel Diff:  0.34265015
  Std Rel Diff:  0.9243003

  rtol, atol: 1e-05 1e-05


======================================================================
ERROR: test_argtopk_1d_collision_10 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 388, in test_argtopk_1d_collision
    utt.assert_allclose(np.sort(xval[yval]), np.sort(xval[goal]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (31,) int32 (4,) -96 90 0 0 
  Value    : (31,) int32 (4,) -3 90 0 0 
  expected    : [-96 -80 -75 -75 -73 -69 -69 -60 -60 -60 -51 -41 -31 -31 -21  -9  -9  -3
  -3  -1  19  28  28  36  45  45  45  45  50  53  90]
  value    : [-3 -1 -1  4  4 19 19 22 22 28 28 31 31 36 36 37 37 45 45 45 45 50 50 53
 53 72 72 86 86 90 90]
  Max Abs Diff:  93
  Mean Abs Diff:  53.67741935483871
  Median Abs Diff:  48.0
  Std Abs Diff:  26.433589453662677
  Max Rel Diff:  46.0
  Mean Rel Diff:  3.7846373718985435
  Median Rel Diff:  1.2753623188405796
  Std Rel Diff:  8.57209964347005

  rtol, atol: 1e-05 1e-08


======================================================================
ERROR: test_argtopk_1d_collision_11 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 388, in test_argtopk_1d_collision
    utt.assert_allclose(np.sort(xval[yval]), np.sort(xval[goal]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (31,) float32 (4,) -96.73682 99.84617 0 0 
  Value    : (31,) float32 (4,) 2.1766047 99.84617 0 0 
  expected    : [-96.73682   -90.2637    -90.2637    -69.36673   -63.74544   -63.74544
 -57.046257  -38.827763  -29.893032  -29.893032  -25.914848   -9.071373
   2.1766047  11.866425   14.067553   14.832549   14.832549   21.173351
  21.72489    21.72489    38.187954   51.218163   52.56272    53.91857
  53.91857    59.770763   66.625046   66.625046   94.85344    97.38248
  99.84617  ]
  value    : [ 2.1766047 11.866425  11.866425  14.067553  14.067553  14.832549
 14.832549  21.173351  21.173351  21.72489   21.72489   38.187954
 38.187954  51.218163  51.218163  52.56272   52.56272   53.91857
 53.91857   59.770763  59.770763  66.625046  66.625046  92.76095
 92.76095   94.85344   94.85344   97.38248   97.38248   99.84617
 99.84617  ]
  Max Abs Diff:  102.13013
  Mean Abs Diff:  44.878036
  Median Abs Diff:  38.045876
  Std Abs Diff:  27.51873
  Max Rel Diff:  16.544735
  Mean Rel Diff:  1.8289533
  Median Rel Diff:  1.2206833
  Std Rel Diff:  2.8922303

  rtol, atol: 1e-05 1e-05


======================================================================
ERROR: test_argtopk_1d_collision_16 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 388, in test_argtopk_1d_collision
    utt.assert_allclose(np.sort(xval[yval]), np.sort(xval[goal]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (129,) int32 (4,) -99 99 0 0 
  Value    : (129,) int32 (4,) -7 99 0 0 
  expected    : [-99 -96 -96 -96 -96 -96 -94 -92 -91 -91 -90 -89 -83 -83 -82 -77 -75 -66
 -66 -65 -64 -61 -61 -61 -59 -55 -48 -48 -44 -42 -42 -41 -41 -41 -35 -34
 -32 -30 -28 -27 -27 -27 -24 -23 -22 -18 -18 -16 -16 -16 -15 -15 -13 -13
 -12 -11 -10 -10 -10  -8  -8  -7  -7  -7  -6  -6  -5  -5  -5   3   4   4
   4   5   6   6   7   7  10  10  11  12  14  17  18  18  24  24  25  25
  26  28  28  29  29  31  32  32  35  35  35  44  45  52  52  56  58  59
  59  60  60  60  65  68  69  69  70  75  80  82  85  87  87  90  91  92
  95  95  99]
  value    : [-7 -7 -7 -7 -7 -6 -6 -5 -5 -5 -5  0  0  3  3  4  4  4  4  5  5  6  6  6
  6  7  7 10 10 10 10 11 11 11 11 12 12 14 14 15 15 17 17 18 18 24 24 25
 25 26 26 27 27 27 27 28 28 29 29 31 31 32 32 35 35 35 35 41 41 44 44 45
 45 45 45 47 47 50 50 52 52 52 52 56 56 58 58 59 59 59 59 60 60 60 60 62
 62 65 65 66 66 68 68 69 69 70 70 75 75 80 80 82 82 83 83 85 85 87 87 90
 90 91 91 92 92 95 95 99 99]
  Max Abs Diff:  92
  Mean Abs Diff:  42.248062015503876
  Median Abs Diff:  40.0
  Std Abs Diff:  23.289559495952986
  Max Rel Diff:  13.666666666666666
  Mean Rel Diff:  2.2245935747391132
  Median Rel Diff:  1.1458333333333333
  Std Rel Diff:  2.574181341892719

  rtol, atol: 1e-05 1e-08


======================================================================
ERROR: test_argtopk_1d_collision_17 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 388, in test_argtopk_1d_collision
    utt.assert_allclose(np.sort(xval[yval]), np.sort(xval[goal]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (129,) float32 (4,) -96.98811 99.50913 0 0 
  Value    : (129,) float32 (4,) -6.7033186 99.50913 0 0 
  expected    : [-96.98811   -95.92765   -92.30159   -89.747406  -89.747406  -89.22825
 -89.22825   -87.19843   -78.154564  -77.394684  -77.394684  -76.364914
 -75.15905   -75.15905   -71.9306    -68.664215  -68.664215  -68.07195
 -64.66036   -64.66036   -63.28984   -63.278744  -63.278744  -62.820564
 -61.055916  -57.63129   -54.873283  -50.184635  -50.184635  -50.01341
 -49.47135   -49.47135   -48.820156  -46.78283   -46.78283   -46.641716
 -46.39352   -45.776123  -44.495136  -43.664875  -43.664875  -39.512615
 -39.512615  -37.8513    -34.907936  -34.728283  -31.55029   -31.55029
 -26.666613  -25.984709  -25.984709  -22.049273  -21.975039  -12.189173
 -11.157608  -10.480831  -10.480831   -7.035431   -2.4863157   1.7208071
   1.7208071   2.019459    3.7449014   3.7449014   4.4471135   6.1114855
   8.907154    8.907154    9.132929    9.132929   10.824931   10.928406
  13.579429   13.818208   22.366947   24.133612   24.133612   24.174244
  24.174244   28.363192   33.2798     35.883743   35.883743   38.100933
  41.20307    41.20307    42.001953   42.001953   43.575855   43.575855
  44.36467    45.235645   45.858795   45.858795   47.883263   47.883263
  50.104546   51.598747   52.273518   52.273518   53.671486   58.274525
  58.274525   60.714752   61.97468    61.97468    61.97565    62.563423
  63.04749    64.454636   64.454636   66.55069    69.333725   71.99846
  71.99846    74.85414    75.17383    82.56172    83.908806   83.908806
  85.01982    85.01982    88.2418     88.2418     90.24445    90.24445
  97.22463    98.98352    99.50913  ]
  value    : [-6.7033186 -2.4863157 -2.4863157  1.7208071  1.7208071  2.019459
  2.019459   3.7449014  3.7449014  4.4471135  4.4471135  6.1114855
  6.1114855  6.1210294  6.1210294  6.811826   6.811826   8.297426
  8.297426   8.422764   8.422764   8.907154   8.907154   9.132929
  9.132929  10.824931  10.824931  10.928406  10.928406  13.579429
 13.579429  13.818208  13.818208  22.366947  22.366947  24.133612
 24.133612  24.174244  24.174244  28.363192  28.363192  33.2798
 33.2798    34.1084    34.1084    35.883743  35.883743  38.100933
 38.100933  41.20307   41.20307   42.001953  42.001953  43.575855
 43.575855  44.36467   44.36467   44.518913  44.518913  45.235645
 45.235645  45.858795  45.858795  47.883263  47.883263  50.104546
 50.104546  51.598747  51.598747  52.273518  52.273518  53.671486
 53.671486  55.930344  55.930344  58.274525  58.274525  60.714752
 60.714752  61.97468   61.97468   61.97565   61.97565   62.381824
 62.381824  62.563423  62.563423  63.04749   63.04749   64.454636
 64.454636  65.28895   65.28895   66.55069   66.55069   66.65098
 66.65098   66.701965  66.701965  69.333725  69.333725  71.99846
 71.99846   74.85414   74.85414   75.17383   75.17383   78.11036
 78.11036   81.25498   81.25498   82.46302   82.46302   82.56172
 82.56172   83.908806  83.908806  85.01982   85.01982   88.2418
 88.2418    90.24445   90.24445   97.22463   97.22463   98.98352
 98.98352   99.50913   99.50913  ]
  Max Abs Diff:  93.44134
  Mean Abs Diff:  44.768085
  Median Abs Diff:  43.43615
  Std Abs Diff:  27.823296
  Max Rel Diff:  25.28746
  Mean Rel Diff:  2.246195
  Median Rel Diff:  1.0992049
  Std Rel Diff:  4.2239394

  rtol, atol: 1e-05 1e-05


======================================================================
ERROR: test_argtopk_1d_collision_18 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 388, in test_argtopk_1d_collision
    utt.assert_allclose(np.sort(xval[yval]), np.sort(xval[goal]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (1337,) float32 (4,) -99.92 99.873955 0 0 
  Value    : (1337,) float32 (4,) -31.707943 99.873955 0 0 
  expected    : [-99.92     -99.92     -99.89603  ...  99.842285  99.873955  99.873955]
  value    : [-31.707943 -31.259514 -31.259514 ...  99.842285  99.873955  99.873955]
  Max Abs Diff:  71.30487
  Mean Abs Diff:  34.73507
  Median Abs Diff:  32.659405
  Std Abs Diff:  21.810295
  Max Rel Diff:  1029.5475
  Mean Rel Diff:  4.436083
  Median Rel Diff:  0.8622566
  Std Rel Diff:  43.305218

  rtol, atol: 1e-05 1e-05


======================================================================
ERROR: test_argtopk_nd_08 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)
Apply node that caused the error: TopKOp{axis=-2, sorted=False}(x, TensorConstant{-17})
Toposort index: 0
Inputs types: [TensorType(float32, matrix), TensorType(int8, scalar)]
Inputs shapes: [(17, 15), ()]
Inputs strides: [(60, 4), ()]
Inputs values: ['not shown', array(-17, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_09 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)
Apply node that caused the error: TopKOp{axis=-2, sorted=False}(x, TensorConstant{-17})
Toposort index: 0
Inputs types: [TensorType(float32, matrix), TensorType(int8, scalar)]
Inputs shapes: [(17, 15), ()]
Inputs strides: [(60, 4), ()]
Inputs values: ['not shown', array(-17, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_10 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)
Apply node that caused the error: TopKOp{axis=-2, sorted=False}(x, TensorConstant{-17})
Toposort index: 0
Inputs types: [TensorType(int32, matrix), TensorType(int8, scalar)]
Inputs shapes: [(17, 15), ()]
Inputs strides: [(60, 4), ()]
Inputs values: ['not shown', array(-17, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_11 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=17) out of bounds (17)
Apply node that caused the error: TopKOp{axis=-2, sorted=False}(x, TensorConstant{-17})
Toposort index: 0
Inputs types: [TensorType(int32, matrix), TensorType(int8, scalar)]
Inputs shapes: [(17, 15), ()]
Inputs strides: [(60, 4), ()]
Inputs values: ['not shown', array(-17, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_24 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)
Apply node that caused the error: TopKOp{axis=-5, sorted=False}(x, TensorConstant{-2})
Toposort index: 0
Inputs types: [TensorType(float32, 5D), TensorType(int8, scalar)]
Inputs shapes: [(2, 3, 5, 7, 11), ()]
Inputs strides: [(4620, 1540, 308, 44, 4), ()]
Inputs values: ['not shown', array(-2, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_25 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)
Apply node that caused the error: TopKOp{axis=-5, sorted=False}(x, TensorConstant{-2})
Toposort index: 0
Inputs types: [TensorType(float32, 5D), TensorType(int8, scalar)]
Inputs shapes: [(2, 3, 5, 7, 11), ()]
Inputs strides: [(4620, 1540, 308, 44, 4), ()]
Inputs values: ['not shown', array(-2, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_26 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)
Apply node that caused the error: TopKOp{axis=-5, sorted=False}(x, TensorConstant{-2})
Toposort index: 0
Inputs types: [TensorType(int32, 5D), TensorType(int8, scalar)]
Inputs shapes: [(2, 3, 5, 7, 11), ()]
Inputs strides: [(4620, 1540, 308, 44, 4), ()]
Inputs values: ['not shown', array(-2, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_27 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=2) out of bounds (2)
Apply node that caused the error: TopKOp{axis=-5, sorted=False}(x, TensorConstant{-2})
Toposort index: 0
Inputs types: [TensorType(int32, 5D), TensorType(int8, scalar)]
Inputs shapes: [(2, 3, 5, 7, 11), ()]
Inputs strides: [(4620, 1540, 308, 44, 4), ()]
Inputs values: ['not shown', array(-2, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_40 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)
Apply node that caused the error: TopKOp{axis=-3, sorted=False}(x, TensorConstant{-500})
Toposort index: 0
Inputs types: [TensorType(float32, 3D), TensorType(int16, scalar)]
Inputs shapes: [(500, 5, 3), ()]
Inputs strides: [(60, 12, 4), ()]
Inputs values: ['not shown', array(-500, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_41 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)
Apply node that caused the error: TopKOp{axis=-3, sorted=False}(x, TensorConstant{-500})
Toposort index: 0
Inputs types: [TensorType(float32, 3D), TensorType(int16, scalar)]
Inputs shapes: [(500, 5, 3), ()]
Inputs strides: [(60, 12, 4), ()]
Inputs values: ['not shown', array(-500, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_42 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)
Apply node that caused the error: TopKOp{axis=-3, sorted=False}(x, TensorConstant{-500})
Toposort index: 0
Inputs types: [TensorType(int32, 3D), TensorType(int16, scalar)]
Inputs shapes: [(500, 5, 3), ()]
Inputs strides: [(60, 12, 4), ()]
Inputs values: ['not shown', array(-500, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_argtopk_nd_43 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 414, in test_argtopk_nd
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 425, in perform
    pzi[0] = _topk_py_impl(self, x, k, axis, node.outputs[0].dtype)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 293, in _topk_py_impl
    zi = np.argpartition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in argpartition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 830, in argpartition
    return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 61, in _wrapfunc
    return bound(*args, **kwds)
ValueError: kth(=500) out of bounds (500)
Apply node that caused the error: TopKOp{axis=-3, sorted=False}(x, TensorConstant{-500})
Toposort index: 0
Inputs types: [TensorType(int32, 3D), TensorType(int16, scalar)]
Inputs shapes: [(500, 5, 3), ()]
Inputs strides: [(60, 12, 4), ()]
Inputs values: ['not shown', array(-500, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 409, in test_argtopk_nd
    y = argtopk(x, k, axis=axis, sorted=sorted, idx_dtype=idx_dtype)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_grad_02 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: array is not broadcastable to correct shape

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ('array is not broadcastable to correct shape\nApply node that caused the error: AdvancedIncSubtensor1{inplace,set}(Alloc.0, random_projection, TopKOp{axis=-1, sorted=False}.1)\nToposort index: 3\nInputs types: [TensorType(float64, vector), TensorType(float64, vector), TensorType(int64, vector)]\nInputs shapes: [(257,), (257,), (129,)]\nInputs strides: [(8,), (8,), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([ 334.85302867,  151.85302867,   61.85302867, -226.14697133,
        256.85302867,  -97.14697133,  337.85302867,   73.85302867,
        154.85302867, -385.14697133, -163.14697133,  193.85302867,
       -352.14697133,  205.85302867,  292.85302867,  247.85302867,
       -172.14697133,  181.85302867,  103.85302867,  295.85302867,
        148.85302867,  160.85302867,   85.85302867, -382.14697133,
        109.85302867,  352.85302867, -349.14697133,  -55.14697133,
        145.85302867,  229.85302867, -100.14697133, -157.14697133,
        379.85302867, -364.14697133, -235.14697133,  331.85302867,
        -61.14697133,  124.85302867,    1.85302867, -181.14697133,
       -118.14697133, -376.14697133,  211.85302867,  187.85302867,
       -130.14697133,  -28.14697133,  163.85302867,  -67.14697133,
       -280.14697133,   28.85302867, -202.14697133,   52.85302867,
       -340.14697133, -316.14697133,  238.85302867,   76.85302867,
        175.85302867, -124.14697133,  262.85302867, -217.14697133,
        316.85302867,  340.85302867,   16.85302867,  -10.14697133,
        100.85302867, -190.14697133, -265.14697133, -319.14697133,
       -109.14697133,  -82.14697133,  178.85302867,  172.85302867,
         91.85302867, -253.14697133, -292.14697133,  196.85302867,
       -256.14697133,    4.85302867,  364.85302867,  -73.14697133,
         94.85302867, -238.14697133,  -91.14697133, -142.14697133,
       -334.14697133, -220.14697133, -184.14697133, -187.14697133,
         25.85302867, -262.14697133,  -43.14697133, -199.14697133,
       -328.14697133, -160.14697133,  -52.14697133,    7.85302867,
        -31.14697133,  -58.14697133,   43.85302867,   -1.14697133,
       -244.14697133, -208.14697133,  304.85302867, -295.14697133,
        214.85302867, -241.14697133,  355.85302867,  166.85302867,
       -301.14697133,  217.85302867,   19.85302867, -298.14697133,
        208.85302867,  199.85302867,  -22.14697133,  -16.14697133,
         64.85302867,   88.85302867, -115.14697133,  -13.14697133,
        274.85302867,   70.85302867, -175.14697133,  367.85302867,
       -166.14697133,  -25.14697133, -193.14697133,  -94.14697133,
       -361.14697133,  -70.14697133, -367.14697133,  349.85302867,
        223.85302867, -289.14697133, -373.14697133,  325.85302867,
        -40.14697133,   22.85302867, -133.14697133, -355.14697133,
        -46.14697133,  133.85302867,  169.85302867, -169.14697133,
        184.85302867, -139.14697133,  121.85302867, -274.14697133,
        346.85302867, -286.14697133,  313.85302867,  271.85302867,
        220.85302867,  -37.14697133,  115.85302867,  268.85302867,
         49.85302867, -346.14697133, -151.14697133,  286.85302867,
        277.85302867,  382.85302867,  130.85302867, -229.14697133,
        322.85302867,  127.85302867, -331.14697133, -211.14697133,
        373.85302867,   34.85302867,   10.85302867,  328.85302867,
       -310.14697133,   13.85302867,  202.85302867,  -88.14697133,
       -106.14697133, -322.14697133,  157.85302867,  118.85302867,
         55.85302867,  361.85302867,   -4.14697133, -223.14697133,
        319.85302867,  -64.14697133,   67.85302867,  358.85302867,
       -121.14697133,  -85.14697133,  232.85302867,  265.85302867,
        370.85302867,  376.85302867, -358.14697133,  112.85302867,
       -136.14697133, -214.14697133, -145.14697133,   79.85302867,
        241.85302867,  307.85302867, -148.14697133,  250.85302867,
       -127.14697133, -283.14697133, -379.14697133,  253.85302867,
         -7.14697133, -271.14697133,  -79.14697133,   40.85302867,
       -304.14697133,  259.85302867,  298.85302867,  190.85302867,
         97.85302867, -250.14697133,  -76.14697133, -259.14697133,
       -370.14697133, -307.14697133,  301.85302867, -154.14697133,
       -337.14697133,  139.85302867,  -19.14697133,  136.85302867,
       -103.14697133,  106.85302867,  142.85302867,  -49.14697133,
       -277.14697133,   58.85302867, -313.14697133,   31.85302867,
       -325.14697133,  -34.14697133,  343.85302867,   37.85302867,
        235.85302867,  226.85302867,  244.85302867, -178.14697133,
       -268.14697133,  310.85302867, -247.14697133,   46.85302867,
       -196.14697133,  289.85302867, -343.14697133,   82.85302867,
        283.85302867, -205.14697133, -232.14697133,  280.85302867,
       -112.14697133])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_03 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: array is not broadcastable to correct shape

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ('array is not broadcastable to correct shape\nApply node that caused the error: AdvancedIncSubtensor1{inplace,set}(Alloc.0, random_projection, TopKOp{axis=-1, sorted=False}.1)\nToposort index: 3\nInputs types: [TensorType(float64, vector), TensorType(float64, vector), TensorType(int64, vector)]\nInputs shapes: [(257,), (257,), (256,)]\nInputs strides: [(8,), (8,), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([  62.14015406,  170.14015406,  221.14015406, -360.85984594,
       -129.85984594,  107.14015406, -219.85984594,  -90.85984594,
        179.14015406,  236.14015406, -234.85984594,  239.14015406,
        263.14015406,  308.14015406,   56.14015406,  230.14015406,
       -249.85984594,  -45.85984594,   17.14015406,   38.14015406,
        377.14015406, -114.85984594,  -12.85984594,  137.14015406,
        248.14015406, -117.85984594, -258.85984594,  161.14015406,
        -63.85984594, -132.85984594,  311.14015406, -300.85984594,
       -147.85984594,  290.14015406, -198.85984594,  296.14015406,
        359.14015406,  245.14015406, -336.85984594,  371.14015406,
         23.14015406, -108.85984594,  356.14015406,   14.14015406,
        347.14015406,   41.14015406, -192.85984594,  200.14015406,
       -315.85984594,  101.14015406, -270.85984594,  -24.85984594,
       -138.85984594,  113.14015406,    8.14015406, -279.85984594,
         29.14015406, -384.85984594, -264.85984594,  233.14015406,
         -0.85984594,  164.14015406,  368.14015406,  353.14015406,
        281.14015406,  -84.85984594,  -66.85984594,  167.14015406,
        104.14015406,   50.14015406,  227.14015406,   35.14015406,
        383.14015406, -111.85984594,   32.14015406, -168.85984594,
       -177.85984594, -162.85984594,  -57.85984594,  -54.85984594,
       -210.85984594,  152.14015406, -126.85984594, -180.85984594,
       -207.85984594,  284.14015406, -324.85984594,   20.14015406,
       -216.85984594,  146.14015406,  206.14015406,  -78.85984594,
       -102.85984594,  209.14015406,   80.14015406,  203.14015406,
        197.14015406,  -60.85984594, -354.85984594, -165.85984594,
        -87.85984594,  374.14015406,   92.14015406,  341.14015406,
        -99.85984594, -276.85984594,   53.14015406,  -18.85984594,
         83.14015406,  -96.85984594, -309.85984594,  212.14015406,
       -366.85984594,  191.14015406,  -81.85984594,  314.14015406,
        218.14015406, -288.85984594, -183.85984594,   59.14015406,
       -291.85984594, -213.85984594,  149.14015406,  176.14015406,
        110.14015406, -141.85984594,   -3.85984594,  182.14015406,
        251.14015406,   89.14015406,  365.14015406,  -21.85984594,
       -342.85984594,  338.14015406, -186.85984594, -282.85984594,
        344.14015406, -237.85984594, -225.85984594, -318.85984594,
        158.14015406,   77.14015406,  317.14015406,  -27.85984594,
       -150.85984594,  185.14015406,  -36.85984594,  320.14015406,
       -246.85984594,  188.14015406,  275.14015406,   98.14015406,
        329.14015406, -174.85984594, -231.85984594, -144.85984594,
       -123.85984594,  -15.85984594,  140.14015406,  173.14015406,
        257.14015406,  -69.85984594,    2.14015406, -171.85984594,
        125.14015406,  287.14015406, -255.85984594,  -33.85984594,
       -357.85984594,   47.14015406, -321.85984594,  128.14015406,
       -222.85984594,  -30.85984594, -306.85984594,  242.14015406,
       -243.85984594,   -9.85984594,  326.14015406,  299.14015406,
       -345.85984594,  -51.85984594, -156.85984594,  131.14015406,
        332.14015406, -351.85984594, -294.85984594,  350.14015406,
         -6.85984594, -228.85984594, -189.85984594, -339.85984594,
        122.14015406,  134.14015406, -240.85984594, -363.85984594,
        380.14015406, -135.85984594,    5.14015406, -120.85984594,
        278.14015406,   86.14015406, -333.85984594,  -48.85984594,
       -327.85984594, -330.85984594,  -42.85984594,  254.14015406,
       -252.85984594,   65.14015406,  -93.85984594,  143.14015406,
       -381.85984594,   71.14015406,   95.14015406, -348.85984594,
       -273.85984594, -369.85984594, -201.85984594,  260.14015406,
       -267.85984594, -297.85984594,  155.14015406, -261.85984594,
         26.14015406, -285.85984594,   11.14015406, -378.85984594,
        -75.85984594,   68.14015406,  302.14015406,  224.14015406,
        116.14015406, -153.85984594,  119.14015406,   44.14015406,
        194.14015406,  272.14015406,  266.14015406,  335.14015406,
        215.14015406, -312.85984594,  269.14015406,  -72.85984594,
        293.14015406, -303.85984594, -204.85984594,  -39.85984594,
       -105.85984594,  362.14015406,  305.14015406, -375.85984594,
       -372.85984594,  323.14015406, -195.85984594,   74.14015406,
       -159.85984594])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_04 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1738, in verify_grad
    o_fn_out = o_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(input 0, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(float64, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(8,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in <lambda>
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_grad_05 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: array is not broadcastable to correct shape

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
ValueError: ('array is not broadcastable to correct shape\nApply node that caused the error: AdvancedIncSubtensor1{inplace,set}(Alloc.0, random_projection, TopKOp{axis=-1, sorted=False}.1)\nToposort index: 3\nInputs types: [TensorType(float64, vector), TensorType(float64, vector), TensorType(int64, vector)]\nInputs shapes: [(257,), (257,), (256,)]\nInputs strides: [(8,), (8,), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([ 214.90087424,  124.90087424, -352.09912576,   52.90087424,
        148.90087424,  247.90087424,  337.90087424, -157.09912576,
       -385.09912576, -100.09912576,   85.90087424,  211.90087424,
        160.90087424, -142.09912576,  -10.09912576,   19.90087424,
       -118.09912576,  166.90087424,   73.90087424, -190.09912576,
        178.90087424, -349.09912576,   28.90087424,  133.90087424,
        163.90087424,  -52.09912576,   94.90087424, -364.09912576,
        -43.09912576,  241.90087424,  172.90087424, -163.09912576,
          7.90087424,  157.90087424,    4.90087424,  -22.09912576,
        340.90087424, -376.09912576,  -91.09912576,   91.90087424,
       -235.09912576,  175.90087424,  -82.09912576, -280.09912576,
       -130.09912576, -202.09912576,  -61.09912576, -340.09912576,
       -316.09912576,   64.90087424, -226.09912576,  220.90087424,
        265.90087424, -217.09912576,  301.90087424, -172.09912576,
        184.90087424,   16.90087424,  376.90087424, -382.09912576,
       -265.09912576, -109.09912576,  229.90087424, -319.09912576,
       -124.09912576,  -97.09912576, -181.09912576,  346.90087424,
        196.90087424, -253.09912576, -292.09912576,  370.90087424,
       -256.09912576,   -1.09912576,  349.90087424,  127.90087424,
        352.90087424, -238.09912576,  277.90087424, -334.09912576,
       -220.09912576, -184.09912576, -187.09912576,  -55.09912576,
       -262.09912576,  -58.09912576, -199.09912576, -328.09912576,
       -160.09912576,  -67.09912576,    1.90087424,   25.90087424,
        -73.09912576,   43.90087424,  -16.09912576, -244.09912576,
       -208.09912576,  130.90087424, -295.09912576,  199.90087424,
       -241.09912576,  -13.09912576,   22.90087424, -301.09912576,
        151.90087424,  202.90087424, -298.09912576,  193.90087424,
        100.90087424,   61.90087424,  -31.09912576,   70.90087424,
         76.90087424, -115.09912576,  145.90087424,  259.90087424,
        298.90087424,  382.90087424,  232.90087424, -166.09912576,
        -25.09912576, -193.09912576,  -94.09912576,  223.90087424,
        316.90087424,  -70.09912576, -361.09912576,  -28.09912576,
       -367.09912576,  295.90087424,  208.90087424, -289.09912576,
       -373.09912576,  334.90087424,  -40.09912576, -133.09912576,
       -355.09912576,  -46.09912576,  121.90087424,  154.90087424,
       -169.09912576,  169.90087424, -139.09912576,  109.90087424,
       -274.09912576,  331.90087424, -286.09912576,  256.90087424,
        205.90087424,  -37.09912576,  103.90087424,  253.90087424,
         49.90087424, -346.09912576, -151.09912576,  271.90087424,
        262.90087424,  367.90087424,  364.90087424, -229.09912576,
        307.90087424,  115.90087424, -331.09912576, -211.09912576,
        358.90087424,   34.90087424,   10.90087424,  313.90087424,
       -310.09912576,   13.90087424,  187.90087424,  -88.09912576,
       -106.09912576, -322.09912576,  118.90087424,   55.90087424,
        274.90087424,   -4.09912576, -223.09912576,  304.90087424,
        -64.09912576,   67.90087424,  343.90087424, -121.09912576,
        -85.09912576,  379.90087424,  250.90087424,  268.90087424,
        361.90087424, -358.09912576,  112.90087424, -136.09912576,
       -214.09912576, -145.09912576,   79.90087424,  322.90087424,
        292.90087424, -148.09912576,  319.90087424, -127.09912576,
       -283.09912576, -379.09912576,  238.90087424,   -7.09912576,
       -271.09912576,  -79.09912576,   40.90087424, -304.09912576,
        325.90087424,  355.90087424,  190.90087424,   97.90087424,
       -250.09912576,  -76.09912576, -259.09912576, -370.09912576,
       -307.09912576,  286.90087424, -154.09912576, -337.09912576,
        139.90087424,  -19.09912576,  136.90087424, -103.09912576,
        373.90087424,  142.90087424,  -49.09912576, -277.09912576,
         58.90087424, -313.09912576,   31.90087424, -325.09912576,
        -34.09912576,  328.90087424,   37.90087424,  235.90087424,
        226.90087424,  244.90087424, -178.09912576, -268.09912576,
        310.90087424, -247.09912576,   46.90087424, -196.09912576,
        289.90087424, -343.09912576,   82.90087424,  283.90087424,
       -205.09912576, -232.09912576,  280.90087424, -112.09912576,
        181.90087424,  106.90087424,   88.90087424,  217.90087424,
       -175.09912576])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_08 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (17,15) could not be broadcast to indexing result of shape (9,15)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (17,15) could not be broadcast to indexing result of shape (9,15)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, TopKOp{axis=-2, sorted=False}.1, ARange{dtype=\'int64\'}.0)\nToposort index: 5\nInputs types: [TensorType(float64, matrix), TensorType(float64, matrix), TensorType(int64, matrix), TensorType(int64, vector)]\nInputs shapes: [(17, 15), (17, 15), (9, 15), (15,)]\nInputs strides: [(120, 8), (120, 8), (120, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[-124.66657599,   10.33342401,    1.33342401,  208.33342401,
         265.33342401, -331.66657599,  -88.66657599, -280.66657599,
         364.33342401, -154.66657599,  127.33342401, -337.66657599,
        -349.66657599,  -25.66657599,  250.33342401],
       [ 151.33342401, -157.66657599,  298.33342401, -184.66657599,
         -97.66657599,  241.33342401,  235.33342401,  304.33342401,
        -106.66657599,  322.33342401,    4.33342401, -214.66657599,
          46.33342401, -196.66657599, -361.66657599],
       [-382.66657599,  199.33342401,  376.33342401, -310.66657599,
         229.33342401,  -76.66657599,  -28.66657599,  103.33342401,
        -190.66657599,  379.33342401,  112.33342401,  -55.66657599,
         358.33342401,  -79.66657599,  217.33342401],
       [-232.66657599,  -58.66657599,  172.33342401,  355.33342401,
         124.33342401, -100.66657599,  337.33342401,  -49.66657599,
        -295.66657599,  139.33342401,  370.33342401,  118.33342401,
        -340.66657599,   76.33342401,   55.33342401],
       [-121.66657599,   19.33342401,   40.33342401, -259.66657599,
         169.33342401,  -13.66657599,  145.33342401, -244.66657599,
          79.33342401,   91.33342401,  262.33342401,  295.33342401,
        -379.66657599,  -64.66657599, -346.66657599],
       [-223.66657599,  -70.66657599,  331.33342401, -169.66657599,
         163.33342401,  148.33342401,  -10.66657599,  325.33342401,
        -199.66657599,  226.33342401,  346.33342401,   22.33342401,
        -373.66657599,   28.33342401,  259.33342401],
       [ 274.33342401,  -94.66657599,  313.33342401,   67.33342401,
         352.33342401,  -16.66657599, -235.66657599,   73.33342401,
        -277.66657599,  232.33342401,  340.33342401,  -46.66657599,
        -217.66657599,   97.33342401,  196.33342401],
       [-313.66657599,   64.33342401,  -52.66657599,  -40.66657599,
         157.33342401, -178.66657599,  343.33342401,  109.33342401,
         154.33342401, -367.66657599,  256.33342401, -187.66657599,
        -262.66657599, -160.66657599, -316.66657599],
       [-325.66657599, -205.66657599, -115.66657599,   -4.66657599,
         211.33342401,  160.33342401,  244.33342401, -250.66657599,
         280.33342401, -289.66657599,  361.33342401, -253.66657599,
        -127.66657599,   43.33342401,  247.33342401],
       [ -22.66657599, -139.66657599, -181.66657599,  100.33342401,
         181.33342401,  328.33342401,  307.33342401,  220.33342401,
        -112.66657599,  184.33342401,  136.33342401, -241.66657599,
         301.33342401, -292.66657599,  187.33342401],
       [ 175.33342401, -238.66657599,  319.33342401,   31.33342401,
        -298.66657599,   94.33342401,   -7.66657599,  106.33342401,
          88.33342401,  373.33342401,  286.33342401,  193.33342401,
         202.33342401,  238.33342401,  310.33342401],
       [ 178.33342401,  -19.66657599, -172.66657599, -163.66657599,
         -91.66657599, -358.66657599,    7.33342401,  -67.66657599,
         166.33342401, -364.66657599, -274.66657599, -301.66657599,
        -286.66657599,   49.33342401, -370.66657599],
       [ -31.66657599,  -37.66657599,  130.33342401,   25.33342401,
        -130.66657599, -352.66657599,  -43.66657599,  292.33342401,
         334.33342401, -166.66657599,   85.33342401,  349.33342401,
        -136.66657599,  277.33342401, -271.66657599],
       [-265.66657599, -283.66657599,   61.33342401, -256.66657599,
        -145.66657599,  -34.66657599,  133.33342401,  223.33342401,
         271.33342401,  -73.66657599,   52.33342401, -343.66657599,
        -148.66657599,  205.33342401, -334.66657599],
       [-304.66657599, -109.66657599,  190.33342401,  289.33342401,
        -226.66657599, -322.66657599,  283.33342401, -328.66657599,
        -208.66657599, -202.66657599,   37.33342401,   13.33342401,
        -175.66657599,  268.33342401, -307.66657599],
       [  16.33342401,  367.33342401,  -85.66657599, -103.66657599,
        -319.66657599,  316.33342401,  121.33342401,   58.33342401,
         142.33342401,  253.33342401,   -1.66657599, -220.66657599,
         214.33342401,   34.33342401,  -61.66657599],
       [  70.33342401, -193.66657599, -118.66657599,  -82.66657599,
        -376.66657599, -247.66657599, -151.66657599, -229.66657599,
        -355.66657599,  115.33342401, -133.66657599, -211.66657599,
        -142.66657599,   82.33342401, -268.66657599]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_09 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (17,15) could not be broadcast to indexing result of shape (16,15)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (17,15) could not be broadcast to indexing result of shape (16,15)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, TopKOp{axis=-2, sorted=False}.1, ARange{dtype=\'int64\'}.0)\nToposort index: 5\nInputs types: [TensorType(float64, matrix), TensorType(float64, matrix), TensorType(int64, matrix), TensorType(int64, vector)]\nInputs shapes: [(17, 15), (17, 15), (16, 15), (15,)]\nInputs strides: [(120, 8), (120, 8), (120, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[  58.33827582,  160.33827582,  211.33827582, -358.66172418,
         154.33827582,  100.33827582,   94.33827582,  361.33827582,
          40.33827582,   85.33827582, -115.66172418, -127.66172418,
         280.33827582,  -61.66172418, -232.66172418],
       [ 220.33827582, -256.66172418, -247.66172418, -190.66172418,
        -160.66172418,  115.33827582, -217.66172418,  379.33827582,
         127.33827582,  229.33827582,   34.33827582,  223.33827582,
        -196.66172418,  -76.66172418,  283.33827582],
       [ 214.33827582, -298.66172418,  367.33827582,  -64.66172418,
         286.33827582, -124.66172418, -334.66172418,  355.33827582,
        -145.66172418,  247.33827582,   10.33827582,  199.33827582,
          37.33827582,  340.33827582,  373.33827582],
       [-313.66172418,  169.33827582, -268.66172418,  343.33827582,
         184.33827582,  106.33827582,  151.33827582, -277.66172418,
          25.33827582, -382.66172418, -262.66172418,   19.33827582,
          82.33827582,  304.33827582,  352.33827582],
       [ 238.33827582,  190.33827582, -109.66172418, -100.66172418,
         -55.66172418,  328.33827582,  -85.66172418,   52.33827582,
         319.33827582, -130.66172418,  346.33827582,  103.33827582,
        -166.66172418, -175.66172418, -106.66172418],
       [   1.33827582, -208.66172418,  -88.66172418, -136.66172418,
        -178.66172418, -205.66172418,  313.33827582, -322.66172418,
          16.33827582, -214.66172418,  -22.66172418,  310.33827582,
         235.33827582, -112.66172418,  -82.66172418],
       [  -1.66172418,  292.33827582,  187.33827582,  142.33827582,
        -352.66172418, -163.66172418,  -43.66172418,  208.33827582,
         259.33827582,  -97.66172418, -274.66172418,   31.33827582,
         109.33827582,   79.33827582,  -94.66172418],
       [-307.66172418,  202.33827582, -364.66172418,   43.33827582,
         -79.66172418,  301.33827582,  181.33827582, -286.66172418,
        -181.66172418,   55.33827582, -289.66172418, -211.66172418,
         139.33827582,  166.33827582,   22.33827582],
       [-139.66172418,  -16.66172418,  172.33827582,  -10.66172418,
         241.33827582,  -58.66172418,   61.33827582,  193.33827582,
          64.33827582,  -19.66172418, -340.66172418,  358.33827582,
        -184.66172418, -280.66172418,  331.33827582],
       [-235.66172418, -223.66172418, -316.66172418,  148.33827582,
         334.33827582,  112.33827582,  -25.66172418, -148.66172418,
         175.33827582,  -34.66172418,  349.33827582, -244.66172418,
         178.33827582,  265.33827582,   91.33827582],
       [ 256.33827582, -172.66172418, -229.66172418, -142.66172418,
        -121.66172418,  -13.66172418,  130.33827582,  163.33827582,
         -67.66172418,    4.33827582, -169.66172418,  298.33827582,
         277.33827582, -253.66172418,  376.33827582],
       [-355.66172418,   49.33827582, -319.66172418, -220.66172418,
         -28.66172418, -304.66172418,  232.33827582, -241.66172418,
          -7.66172418,  250.33827582,  289.33827582, -343.66172418,
         -49.66172418, -154.66172418,  133.33827582],
       [ 205.33827582, -349.66172418, -292.66172418,  337.33827582,
          -4.66172418, -226.66172418, -187.66172418, -337.66172418,
         124.33827582,  136.33827582,  370.33827582, -361.66172418,
         364.33827582, -133.66172418,    7.33827582],
       [-118.66172418,  316.33827582,   88.33827582, -331.66172418,
         -46.66172418, -325.66172418, -328.66172418,  -40.66172418,
         244.33827582, -250.66172418,   67.33827582,  -91.66172418,
         145.33827582, -379.66172418,   73.33827582],
       [  97.33827582, -346.66172418, -271.66172418, -367.66172418,
        -199.66172418,  262.33827582, -265.66172418, -295.66172418,
         157.33827582, -259.66172418,   28.33827582, -283.66172418,
          13.33827582, -376.66172418,  -73.66172418],
       [  70.33827582,  226.33827582,  118.33827582, -151.66172418,
         121.33827582,   46.33827582,  196.33827582,  274.33827582,
         268.33827582,  322.33827582,  217.33827582, -310.66172418,
         271.33827582,  -70.66172418,  295.33827582],
       [-301.66172418, -202.66172418,  -37.66172418, -103.66172418,
         307.33827582, -373.66172418, -370.66172418,  325.33827582,
        -193.66172418,   76.33827582, -157.66172418, -238.66172418,
         -52.66172418,  -31.66172418,  253.33827582]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_10 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=17) out of bounds (17)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1738, in verify_grad
    o_fn_out = o_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=17) out of bounds (17)
Apply node that caused the error: TopKOp{axis=-2, sorted=False}(input 0, TensorConstant{-17})
Toposort index: 0
Inputs types: [TensorType(float64, matrix), TensorType(int8, scalar)]
Inputs shapes: [(17, 15), ()]
Inputs strides: [(120, 8), ()]
Inputs values: ['not shown', array(-17, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in <lambda>
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_grad_11 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (17,15) could not be broadcast to indexing result of shape (16,15)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (17,15) could not be broadcast to indexing result of shape (16,15)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, TopKOp{axis=-2, sorted=False}.1, ARange{dtype=\'int64\'}.0)\nToposort index: 5\nInputs types: [TensorType(float64, matrix), TensorType(float64, matrix), TensorType(int64, matrix), TensorType(int64, vector)]\nInputs shapes: [(17, 15), (17, 15), (16, 15), (15,)]\nInputs strides: [(120, 8), (120, 8), (120, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[-127.09912576, -223.09912576, -121.09912576,  166.90087424,
          88.90087424, -349.09912576,  160.90087424,  235.90087424,
        -187.09912576, -139.09912576,  325.90087424,  172.90087424,
        -169.09912576,  -97.09912576,  367.90087424],
       [ 202.90087424,   64.90087424,   55.90087424, -232.09912576,
        -346.09912576,  151.90087424,  124.90087424,    1.90087424,
        -160.09912576,  340.90087424, -361.09912576,  163.90087424,
        -106.09912576, -178.09912576,  190.90087424],
       [-382.09912576, -199.09912576,  -79.09912576,  133.90087424,
         148.90087424, -115.09912576, -373.09912576,  -94.09912576,
         -55.09912576, -154.09912576,  -88.09912576,  118.90087424,
        -277.09912576,  130.90087424,  379.90087424],
       [ -64.09912576, -337.09912576, -313.09912576,  178.90087424,
         358.90087424, -214.09912576,  -28.09912576,   97.90087424,
         289.90087424,   10.90087424,    4.90087424,   19.90087424,
          79.90087424, -379.09912576, -262.09912576],
       [ 103.90087424,  154.90087424, -316.09912576,  199.90087424,
         310.90087424,  -49.09912576,   46.90087424,  277.90087424,
        -250.09912576, -289.09912576,  169.90087424, -253.09912576,
          -7.09912576,  337.90087424,  -10.09912576],
       [  73.90087424, -235.09912576,   76.90087424, -331.09912576,
        -217.09912576, -181.09912576, -184.09912576,  -58.09912576,
        -259.09912576,   25.90087424,  373.90087424, -325.09912576,
        -157.09912576,  -70.09912576,  211.90087424],
       [ 217.90087424,   28.90087424,  -22.09912576, -241.09912576,
        -205.09912576,  127.90087424, -292.09912576,  187.90087424,
        -238.09912576,  -19.09912576,   22.90087424, -298.09912576,
         265.90087424,  -52.09912576, -295.09912576],
       [ 181.90087424,  364.90087424,  -40.09912576,  343.90087424,
         304.90087424,   67.90087424, -112.09912576,    7.90087424,
         322.90087424,  328.90087424,  370.90087424,  268.90087424,
        -163.09912576, -190.09912576,  -91.09912576],
       [ -13.09912576,   31.90087424,  -67.09912576, -358.09912576,
         -25.09912576, -364.09912576,  352.90087424,  196.90087424,
        -286.09912576, -370.09912576,  298.90087424,  -37.09912576,
        -130.09912576, -352.09912576,  -43.09912576],
       [ 112.90087424,  262.90087424, -166.09912576,  157.90087424,
        -136.09912576, -271.09912576,  319.90087424, -283.09912576,
         244.90087424,  208.90087424,  -34.09912576,   94.90087424,
         241.90087424,   52.90087424, -343.09912576],
       [-148.09912576,  259.90087424,  250.90087424,  355.90087424,
         253.90087424, -226.09912576,  295.90087424,  106.90087424,
        -328.09912576, -208.09912576,  346.90087424,   37.90087424,
          13.90087424,  301.90087424, -307.09912576],
       [  16.90087424,  175.90087424,  -85.09912576, -103.09912576,
        -319.09912576,  121.90087424,   58.90087424,   -1.09912576,
        -220.09912576,  334.90087424,  -61.09912576,   70.90087424,
         331.90087424, -118.09912576,  -82.09912576],
       [ 205.90087424,  307.90087424,  256.90087424,  349.90087424,
        -355.09912576,  115.90087424, -133.09912576, -211.09912576,
        -142.09912576,   82.90087424,  214.90087424,  280.90087424,
        -145.09912576,  223.90087424, -124.09912576],
       [-280.09912576, -376.09912576,  226.90087424,   -4.09912576,
        -268.09912576,  -76.09912576,   43.90087424, -301.09912576,
         232.90087424,  271.90087424,  193.90087424,  100.90087424,
        -247.09912576,  -73.09912576, -256.09912576],
       [-367.09912576, -304.09912576,  274.90087424, -151.09912576,
        -334.09912576,  142.90087424,  -16.09912576,  139.90087424,
        -100.09912576,  361.90087424,  145.90087424,  -46.09912576,
        -274.09912576,   61.90087424, -310.09912576],
       [  34.90087424, -322.09912576,  -31.09912576,  316.90087424,
          40.90087424,  238.90087424,  229.90087424,  247.90087424,
        -175.09912576, -265.09912576,  313.90087424, -244.09912576,
          49.90087424, -193.09912576,  292.90087424],
       [-340.09912576,   85.90087424,  286.90087424, -202.09912576,
        -229.09912576,  283.90087424, -109.09912576,  184.90087424,
         109.90087424,  376.90087424,  220.90087424, -172.09912576,
        -196.09912576,   91.90087424,  136.90087424]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_14 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (5,3,5,3) could not be broadcast to indexing result of shape (3,3,5,3)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (5,3,5,3) could not be broadcast to indexing result of shape (3,3,5,3)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, TopKOp{axis=-4, sorted=False}.1, InplaceDimShuffle{0,x,x}.0, InplaceDimShuffle{0,x}.0, ARange{dtype=\'int64\'}.0)\nToposort index: 11\nInputs types: [TensorType(float64, 4D), TensorType(float64, 4D), TensorType(int64, 4D), TensorType(int64, (False, True, True)), TensorType(int64, col), TensorType(int64, vector)]\nInputs shapes: [(5, 3, 5, 3), (5, 3, 5, 3), (3, 3, 5, 3), (3, 1, 1), (5, 1), (3,)]\nInputs strides: [(360, 120, 24, 8), (360, 120, 24, 8), (360, 120, 24, 8), (8, 8, 8), (8, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\', array([[[0]],\n\n       [[1]],\n\n       [[2]]], dtype=int64), array([[0],\n       [1],\n       [2],\n       [3],\n       [4]], dtype=int64), array([0, 1, 2], dtype=int64)]\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[[[ 274.22115921,  -28.77884079,  112.22115921],
         [ 142.22115921,  325.22115921, -337.77884079],
         [-184.77884079, -160.77884079,  -94.77884079],
         [-187.77884079,   19.22115921,  292.22115921],
         [ 319.22115921,  157.22115921, -235.77884079]],

        [[ 307.22115921,  262.22115921,  178.22115921],
         [ -58.77884079,  -49.77884079,  -64.77884079],
         [ 283.22115921, -274.77884079,  328.22115921],
         [ 139.22115921, -298.77884079,   13.22115921],
         [ 316.22115921,  115.22115921,   28.22115921]],

        [[-304.77884079, -229.77884079,   94.22115921],
         [-175.77884079,  187.22115921, -259.77884079],
         [ 286.22115921, -172.77884079, -115.77884079],
         [ 226.22115921,  196.22115921, -196.77884079],
         [-127.77884079, -190.77884079,  211.22115921]]],


       [[[-145.77884079, -286.77884079,   64.22115921],
         [-283.77884079, -169.77884079, -205.77884079],
         [-271.77884079,   25.22115921,  -79.77884079],
         [-100.77884079,  145.22115921,  238.22115921],
         [  16.22115921,  265.22115921,  -73.77884079]],

        [[-322.77884079,  310.22115921,   76.22115921],
         [ 277.22115921,  -52.77884079,   97.22115921],
         [ 247.22115921,  322.22115921, -238.77884079],
         [  70.22115921, -331.77884079, -268.77884079],
         [  43.22115921,  289.22115921,   52.22115921]],

        [[ 190.22115921,  256.22115921, -121.77884079],
         [ 223.22115921,   58.22115921,  202.22115921],
         [-328.77884079, -325.77884079, -148.77884079],
         [-262.77884079,  -46.77884079, -193.77884079],
         [ -85.77884079,  163.22115921, -202.77884079]]],


       [[[ -40.77884079, -208.77884079,   91.22115921],
         [ 259.22115921,  -82.77884079, -250.77884079],
         [  85.22115921,  244.22115921,  193.22115921],
         [-214.77884079, -151.77884079, -136.77884079],
         [ 109.22115921,  100.22115921,   55.22115921]],

        [[  46.22115921,  241.22115921,  -91.77884079],
         [ -55.77884079, -232.77884079,  235.22115921],
         [-199.77884079, -211.77884079,  175.22115921],
         [  40.22115921, -181.77884079,  148.22115921],
         [  61.22115921,   67.22115921, -118.77884079]],

        [[-163.77884079, -133.77884079, -154.77884079],
         [   1.22115921, -307.77884079, -244.77884079],
         [-316.77884079, -220.77884079,   -1.77884079],
         [-109.77884079, -292.77884079, -142.77884079],
         [-256.77884079, -223.77884079, -280.77884079]]],


       [[[ 253.22115921,  -16.77884079,  205.22115921],
         [ 304.22115921, -277.77884079, -265.77884079],
         [ -22.77884079,    4.22115921,  154.22115921],
         [ 271.22115921,   31.22115921, -313.77884079],
         [   7.22115921,  -19.77884079,  136.22115921]],

        [[ 217.22115921,   22.22115921,  103.22115921],
         [  73.22115921,  -67.77884079, -247.77884079],
         [-112.77884079, -166.77884079,   79.22115921],
         [ 199.22115921, -139.77884079, -334.77884079],
         [-301.77884079, -226.77884079,  331.22115921]],

        [[ -97.77884079,  172.22115921,  151.22115921],
         [ 334.22115921, -241.77884079,  -31.77884079],
         [ 118.22115921, -295.77884079,  313.22115921],
         [ 232.22115921,  160.22115921,  -25.77884079],
         [-217.77884079,  -76.77884079,  -10.77884079]]],


       [[[ 214.22115921,  166.22115921,  130.22115921],
         [ -70.77884079, -157.77884079, -130.77884079],
         [ -61.77884079,  181.22115921,   -7.77884079],
         [ 133.22115921, -319.77884079,   88.22115921],
         [ 295.22115921, -103.77884079,  208.22115921]],

        [[ 124.22115921,  -37.77884079,  169.22115921],
         [ 220.22115921,   37.22115921, -289.77884079],
         [  10.22115921,  268.22115921,  127.22115921],
         [ 184.22115921,  -88.77884079, -253.77884079],
         [ -13.77884079,  301.22115921,  -43.77884079]],

        [[  -4.77884079,  106.22115921, -106.77884079],
         [ 229.22115921,   49.22115921,  -34.77884079],
         [ 121.22115921,   82.22115921,  280.22115921],
         [-178.77884079, -310.77884079,   34.22115921],
         [ 250.22115921,  298.22115921, -124.77884079]]]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_15 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (5,3,5,3) could not be broadcast to indexing result of shape (4,3,5,3)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (5,3,5,3) could not be broadcast to indexing result of shape (4,3,5,3)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, TopKOp{axis=-4, sorted=False}.1, InplaceDimShuffle{0,x,x}.0, InplaceDimShuffle{0,x}.0, ARange{dtype=\'int64\'}.0)\nToposort index: 11\nInputs types: [TensorType(float64, 4D), TensorType(float64, 4D), TensorType(int64, 4D), TensorType(int64, (False, True, True)), TensorType(int64, col), TensorType(int64, vector)]\nInputs shapes: [(5, 3, 5, 3), (5, 3, 5, 3), (4, 3, 5, 3), (3, 1, 1), (5, 1), (3,)]\nInputs strides: [(360, 120, 24, 8), (360, 120, 24, 8), (360, 120, 24, 8), (8, 8, 8), (8, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\', array([[[0]],\n\n       [[1]],\n\n       [[2]]], dtype=int64), array([[0],\n       [1],\n       [2],\n       [3],\n       [4]], dtype=int64), array([0, 1, 2], dtype=int64)]\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[[[ 158.24820144,   47.24820144,  305.24820144],
         [ -93.75179856,  119.24820144,  221.24820144],
         [ 209.24820144, -336.75179856,  -21.75179856],
         [-201.75179856,  236.24820144,  -33.75179856],
         [ 266.24820144,  128.24820144,  242.24820144]],

        [[ -78.75179856, -165.75179856,   26.24820144],
         [ 215.24820144,  227.24820144, -252.75179856],
         [ 185.24820144, -276.75179856,   98.24820144],
         [ 302.24820144,  263.24820144,  140.24820144],
         [  56.24820144,  176.24820144, -222.75179856]],

        [[-114.75179856,  -15.75179856,  248.24820144],
         [ 311.24820144,  -81.75179856, -231.75179856],
         [-159.75179856,  131.24820144,    2.24820144],
         [-228.75179856, -186.75179856,  194.24820144],
         [-267.75179856,  -99.75179856, -261.75179856]]],


       [[[ -63.75179856, -318.75179856,  233.24820144],
         [ 113.24820144,   29.24820144, -168.75179856],
         [ -42.75179856,  -84.75179856,  -54.75179856],
         [ 212.24820144,   17.24820144,   77.24820144],
         [  35.24820144,  257.24820144, -129.75179856]],

        [[ 137.24820144, -150.75179856,  -36.75179856],
         [ 281.24820144,  -69.75179856,  218.24820144],
         [ 164.24820144, -294.75179856,   95.24820144],
         [-120.75179856,  155.24820144,  179.24820144],
         [  89.24820144,   71.24820144,  149.24820144]],

        [[-234.75179856, -189.75179856,   44.24820144],
         [ -51.75179856,  -60.75179856,   23.24820144],
         [ 254.24820144,   86.24820144,  104.24820144],
         [  62.24820144,  278.24820144,   80.24820144],
         [ 251.24820144,   65.24820144,  200.24820144]]],


       [[[ 146.24820144, -126.75179856, -183.75179856],
         [ -96.75179856,  -75.75179856,  167.24820144],
         [-144.75179856,   50.24820144, -240.75179856],
         [ 239.24820144,  -39.75179856, -123.75179856],
         [  -9.75179856,  -18.75179856,  191.24820144]],

        [[ 299.24820144, -309.75179856, -288.75179856],
         [ 269.24820144, -273.75179856,  206.24820144],
         [ -66.75179856, -138.75179856, -174.75179856],
         [-258.75179856, -270.75179856, -195.75179856],
         [-171.75179856,  110.24820144, -177.75179856]],

        [[ 296.24820144,   32.24820144, -297.75179856],
         [  -3.75179856,  329.24820144,  101.24820144],
         [ 290.24820144,   20.24820144, -303.75179856],
         [-246.75179856,  293.24820144,   41.24820144],
         [-180.75179856,  245.24820144,  332.24820144]]],


       [[[ 188.24820144,  284.24820144,  -87.75179856],
         [  53.24820144,  -72.75179856,  125.24820144],
         [-285.75179856,  323.24820144, -279.75179856],
         [-282.75179856,    5.24820144, -204.75179856],
         [ -45.75179856, -333.75179856, -300.75179856]],

        [[ 197.24820144, -321.75179856, -153.75179856],
         [ 320.24820144, -249.75179856,  308.24820144],
         [  74.24820144, -237.75179856,   59.24820144],
         [-330.75179856,  -27.75179856,  116.24820144],
         [-105.75179856,   92.24820144, -264.75179856]],

        [[ -24.75179856, -255.75179856, -156.75179856],
         [   8.24820144,  -57.75179856, -327.75179856],
         [-324.75179856, -147.75179856,  122.24820144],
         [-111.75179856, -192.75179856,   -6.75179856],
         [ 272.24820144, -225.75179856,  182.24820144]]],


       [[[ 170.24820144, -207.75179856,  -48.75179856],
         [ 314.24820144,  134.24820144,  275.24820144],
         [ 224.24820144,  -30.75179856, -216.75179856],
         [-213.75179856, -135.75179856,  260.24820144],
         [ 107.24820144, -312.75179856,  335.24820144]],

        [[-210.75179856,  -12.75179856, -102.75179856],
         [ -90.75179856,   11.24820144,  152.24820144],
         [ 326.24820144, -198.75179856,   14.24820144],
         [ 173.24820144,  287.24820144,   38.24820144],
         [-315.75179856,  203.24820144,   83.24820144]],

        [[ 161.24820144,  143.24820144, -117.75179856],
         [-162.75179856, -132.75179856,  230.24820144],
         [-306.75179856, -243.75179856,   68.24820144],
         [-219.75179856,   -0.75179856,  317.24820144],
         [-108.75179856, -291.75179856, -141.75179856]]]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_16 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=5) out of bounds (5)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1738, in verify_grad
    o_fn_out = o_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=5) out of bounds (5)
Apply node that caused the error: TopKOp{axis=-4, sorted=False}(input 0, TensorConstant{-5})
Toposort index: 0
Inputs types: [TensorType(float64, 4D), TensorType(int8, scalar)]
Inputs shapes: [(5, 3, 5, 3), ()]
Inputs strides: [(360, 120, 24, 8), ()]
Inputs values: ['not shown', array(-5, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in <lambda>
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_grad_17 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (5,3,5,3) could not be broadcast to indexing result of shape (4,3,5,3)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (5,3,5,3) could not be broadcast to indexing result of shape (4,3,5,3)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, TopKOp{axis=-4, sorted=False}.1, InplaceDimShuffle{0,x,x}.0, InplaceDimShuffle{0,x}.0, ARange{dtype=\'int64\'}.0)\nToposort index: 11\nInputs types: [TensorType(float64, 4D), TensorType(float64, 4D), TensorType(int64, 4D), TensorType(int64, (False, True, True)), TensorType(int64, col), TensorType(int64, vector)]\nInputs shapes: [(5, 3, 5, 3), (5, 3, 5, 3), (4, 3, 5, 3), (3, 1, 1), (5, 1), (3,)]\nInputs strides: [(360, 120, 24, 8), (360, 120, 24, 8), (360, 120, 24, 8), (8, 8, 8), (8, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', \'not shown\', array([[[0]],\n\n       [[1]],\n\n       [[2]]], dtype=int64), array([[0],\n       [1],\n       [2],\n       [3],\n       [4]], dtype=int64), array([0, 1, 2], dtype=int64)]\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[[[-187.09912576, -304.09912576, -337.09912576],
         [   1.90087424,  196.90087424,  -70.09912576],
         [ 259.90087424, -316.09912576,   25.90087424],
         [ 241.90087424, -217.09912576, -232.09912576],
         [  22.90087424,   70.90087424, -268.09912576]],

        [[  52.90087424,   34.90087424,  277.90087424],
         [-124.09912576,  121.90087424, -136.09912576],
         [-142.09912576, -292.09912576,  151.90087424],
         [ 250.90087424, -178.09912576,  -10.09912576],
         [ 148.90087424,  262.90087424,  208.90087424]],

        [[ -34.09912576,  -76.09912576,   16.90087424],
         [-334.09912576, -109.09912576, -271.09912576],
         [-139.09912576,   67.90087424,  -22.09912576],
         [ 139.90087424,  289.90087424, -133.09912576],
         [-244.09912576,  226.90087424,  238.90087424]]],


       [[[ 133.90087424,  112.90087424, -169.09912576],
         [ -49.09912576,  298.90087424,  334.90087424],
         [  46.90087424, -190.09912576,   -7.09912576],
         [ 160.90087424, -286.09912576,  -61.09912576],
         [-172.09912576, -154.09912576, -328.09912576]],

        [[-112.09912576,  100.90087424,  -94.09912576],
         [  49.90087424, -214.09912576,  328.90087424],
         [-280.09912576,  301.90087424,  -46.09912576],
         [ 271.90087424, -196.09912576, -160.09912576],
         [-247.09912576,  169.90087424, -193.09912576]],

        [[ 205.90087424,  -19.09912576,   -4.09912576],
         [ -82.09912576, -250.09912576,  163.90087424],
         [ 124.90087424,  319.90087424,   37.90087424],
         [  19.90087424,   55.90087424,   64.90087424],
         [ -13.09912576,   31.90087424,  172.90087424]]],


       [[[   7.90087424, -118.09912576, -145.09912576],
         [ -52.09912576,    4.90087424,  -25.09912576],
         [-319.09912576,  256.90087424,  178.90087424],
         [-241.09912576,   91.90087424, -325.09912576],
         [ 118.90087424, -208.09912576, -313.09912576]],

        [[ -85.09912576, -307.09912576,  220.90087424],
         [ 166.90087424, -121.09912576,   76.90087424],
         [-253.09912576,  325.90087424,  -43.09912576],
         [ 142.90087424,  -91.09912576, -301.09912576],
         [ 109.90087424, -226.09912576,  286.90087424]],

        [[-238.09912576,   73.90087424,  217.90087424],
         [ 175.90087424,   10.90087424,  -67.09912576],
         [-205.09912576, -115.09912576,  199.90087424],
         [ 214.90087424, -298.09912576, -103.09912576],
         [ 232.90087424,  223.90087424,  310.90087424]]],


       [[[  97.90087424, -181.09912576,  268.90087424],
         [ 292.90087424, -283.09912576, -163.09912576],
         [ 304.90087424,   82.90087424,   58.90087424],
         [ 280.90087424, -262.09912576,   61.90087424],
         [ 157.90087424,  -40.09912576,  -58.09912576]],

        [[-274.09912576,  103.90087424,   43.90087424],
         [-175.09912576,  322.90087424,  -16.09912576],
         [ 115.90087424,  295.90087424,  -73.09912576],
         [ -37.09912576,  235.90087424,  211.90087424],
         [ 313.90087424,  307.90087424, -310.09912576]],

        [[ -88.09912576, -166.09912576,  -97.09912576],
         [ 127.90087424,  193.90087424,  253.90087424],
         [-100.09912576,  202.90087424,  -79.09912576],
         [-235.09912576, -331.09912576,   40.90087424],
         [-223.09912576,  -31.09912576,   88.90087424]]],


       [[[-256.09912576,  244.90087424,  145.90087424],
         [-202.09912576,  -28.09912576, -211.09912576],
         [-322.09912576, -259.09912576,  247.90087424],
         [-106.09912576, -289.09912576,  187.90087424],
         [  28.90087424,  184.90087424,  -55.09912576]],

        [[ 316.90087424,  190.90087424,   -1.09912576],
         [-229.09912576,  106.90087424, -265.09912576],
         [  79.90087424, -277.09912576,   13.90087424],
         [ 283.90087424,   85.90087424,  274.90087424],
         [-130.09912576, -220.09912576, -199.09912576]],

        [[  94.90087424, -148.09912576, -295.09912576],
         [ 130.90087424, -157.09912576, -184.09912576],
         [ -64.09912576,  229.90087424,  154.90087424],
         [ 331.90087424,  265.90087424, -127.09912576],
         [-151.09912576,  136.90087424,  181.90087424]]]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_20 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (2,3,5,7,11) could not be broadcast to indexing result of shape (2,2,5,7,11)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (2,3,5,7,11) could not be broadcast to indexing result of shape (2,2,5,7,11)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, InplaceDimShuffle{0,x,x,x,x}.0, TopKOp{axis=-4, sorted=False}.1, InplaceDimShuffle{0,x,x}.0, InplaceDimShuffle{0,x}.0, ARange{dtype=\'int64\'}.0)\nToposort index: 14\nInputs types: [TensorType(float64, 5D), TensorType(float64, 5D), TensorType(int64, (False, True, True, True, True)), TensorType(int64, 5D), TensorType(int64, (False, True, True)), TensorType(int64, col), TensorType(int64, vector)]\nInputs shapes: [(2, 3, 5, 7, 11), (2, 3, 5, 7, 11), (2, 1, 1, 1, 1), (2, 2, 5, 7, 11), (5, 1, 1), (7, 1), (11,)]\nInputs strides: [(9240, 3080, 616, 88, 8), (9240, 3080, 616, 88, 8), (8, 8, 8, 8, 8), (6160, 3080, 616, 88, 8), (8, 8, 8), (8, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', array([[[[[0]]]],\n\n\n\n       [[[[1]]]]], dtype=int64), \'not shown\', array([[[0]],\n\n       [[1]],\n\n       [[2]],\n\n       [[3]],\n\n       [[4]]], dtype=int64), \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[[[[ 1887.3717868,   663.3717868,  2022.3717868, ...,
           -1187.6282132, -2942.6282132,  -440.6282132],
          [  297.3717868,  1980.3717868, -2705.6282132, ...,
             660.3717868, -1232.6282132,    -5.6282132],
          [ 2139.3717868, -3215.6282132,  -284.6282132, ...,
            -674.6282132, -2003.6282132, -3188.6282132],
          ...,
          [ 3315.3717868,  -602.6282132,  1050.3717868, ...,
           -1985.6282132, -1070.6282132, -2072.6282132],
          [  186.3717868, -1691.6282132,  -410.6282132, ...,
           -2879.6282132,  2010.3717868,  1323.3717868],
          [ 1452.3717868,  3261.3717868,  2262.3717868, ...,
             822.3717868,  -638.6282132,   438.3717868]],

         [[-2906.6282132,  2259.3717868, -1196.6282132, ...,
           -1739.6282132, -1175.6282132, -2816.6282132],
          [-1043.6282132,  -848.6282132,    81.3717868, ...,
           -1037.6282132,   174.3717868,  2244.3717868],
          [ 3447.3717868, -3119.6282132,  -392.6282132, ...,
            3273.3717868,  1212.3717868, -2015.6282132],
          ...,
          [-3092.6282132,  1650.3717868,   906.3717868, ...,
            -788.6282132, -1010.6282132,  1758.3717868],
          [ 1395.3717868,  -971.6282132,  -182.6282132, ...,
           -2069.6282132,  -692.6282132,  1356.3717868],
          [  606.3717868, -1712.6282132,  2070.3717868, ...,
           -3335.6282132,  -152.6282132, -2123.6282132]],

         [[-1586.6282132,  3177.3717868, -3359.6282132, ...,
           -2096.6282132,   858.3717868, -2168.6282132],
          [  642.3717868,   849.3717868, -1898.6282132, ...,
               6.3717868, -2432.6282132,  2178.3717868],
          [-2777.6282132,  2451.3717868,  1335.3717868, ...,
            -653.6282132, -2564.6282132,  2391.3717868],
          ...,
          [  708.3717868, -2510.6282132, -3410.6282132, ...,
            -227.6282132, -2567.6282132, -2975.6282132],
          [ 2049.3717868,  -521.6282132,  1380.3717868, ...,
            2235.3717868, -2675.6282132,   810.3717868],
          [ 3153.3717868, -3050.6282132, -2525.6282132, ...,
           -2150.6282132, -1733.6282132, -2954.6282132]],

         [[ 1827.3717868, -2837.6282132, -3371.6282132, ...,
             252.3717868, -2759.6282132,  -323.6282132],
          [ 2052.3717868,  3225.3717868,   -23.6282132, ...,
            2166.3717868,   636.3717868,  2487.3717868],
          [ 3057.3717868,  1809.3717868, -1481.6282132, ...,
            1080.3717868, -3083.6282132, -2852.6282132],
          ...,
          [ 2850.3717868, -3314.6282132, -1439.6282132, ...,
           -2645.6282132,  3012.3717868,  2400.3717868],
          [-1190.6282132, -1220.6282132,  1860.3717868, ...,
            1425.3717868,  -278.6282132, -1802.6282132],
          [ -791.6282132, -2201.6282132,  -428.6282132, ...,
           -1466.6282132,   420.3717868,  3201.3717868]],

         [[ -671.6282132,   678.3717868, -2156.6282132, ...,
           -3329.6282132, -1316.6282132,   570.3717868],
          [-3224.6282132, -3386.6282132,  1446.3717868, ...,
             735.3717868, -1145.6282132,  1704.3717868],
          [ 2985.3717868,  2814.3717868,  2058.3717868, ...,
           -2099.6282132,  1191.3717868, -2624.6282132],
          ...,
          [ 3078.3717868, -1895.6282132,  -857.6282132, ...,
            2745.3717868,   429.3717868,   954.3717868],
          [ 1146.3717868, -2612.6282132,  2442.3717868, ...,
              63.3717868,  1638.3717868,  1437.3717868],
          [ 2838.3717868, -2093.6282132,   771.3717868, ...,
           -2774.6282132,  2445.3717868, -2240.6282132]]],


        [[[ -743.6282132, -2558.6282132,  2124.3717868, ...,
           -1127.6282132, -1919.6282132,  1518.3717868],
          [ 2757.3717868,  1200.3717868, -1076.6282132, ...,
             465.3717868, -2273.6282132,  3069.3717868],
          [ 2931.3717868,  -206.6282132, -1484.6282132, ...,
             315.3717868, -2006.6282132,   321.3717868],
          ...,
          [ 2583.3717868,  2571.3717868,   945.3717868, ...,
            3453.3717868,  1728.3717868, -1283.6282132],
          [-3437.6282132, -1595.6282132,  1497.3717868, ...,
            1404.3717868,  3330.3717868,  -224.6282132],
          [-1682.6282132, -3152.6282132,  1047.3717868, ...,
            2331.3717868,  3021.3717868,    30.3717868]],

         [[ -665.6282132, -3317.6282132, -1367.6282132, ...,
             150.3717868,  2589.3717868,  1566.3717868],
          [-1340.6282132, -2318.6282132,  1359.3717868, ...,
             540.3717868,  -887.6282132,  2943.3717868],
          [-1724.6282132,  2316.3717868,  -524.6282132, ...,
           -3350.6282132, -2219.6282132,  1725.3717868],
          ...,
          [-2297.6282132, -1409.6282132,  1920.3717868, ...,
            1155.3717868,   -29.6282132, -3326.6282132],
          [-1727.6282132, -3293.6282132,  2616.3717868, ...,
            2883.3717868,  -473.6282132, -2084.6282132],
          [ -173.6282132, -1154.6282132, -3419.6282132, ...,
            1917.3717868,  -356.6282132, -1808.6282132]],

         [[ 3132.3717868,  1203.3717868,  2667.3717868, ...,
            1974.3717868,  1500.3717868,  2508.3717868],
          [ -644.6282132,  -362.6282132,  -296.6282132, ...,
           -2615.6282132, -2414.6282132,  2073.3717868],
          [-1436.6282132,  1026.3717868,  -605.6282132, ...,
           -2993.6282132,  3420.3717868,   882.3717868],
          ...,
          [ 1560.3717868, -1790.6282132,   984.3717868, ...,
           -2354.6282132,   282.3717868,  1197.3717868],
          [-2054.6282132,   198.3717868, -2594.6282132, ...,
             237.3717868,  3231.3717868,  1269.3717868],
          [   99.3717868, -1745.6282132,   264.3717868, ...,
           -1289.6282132,   630.3717868, -2534.6282132]],

         [[ 2307.3717868, -1850.6282132,  2610.3717868, ...,
           -3104.6282132, -1205.6282132, -1613.6282132],
          [-1430.6282132,  1947.3717868, -2750.6282132, ...,
           -2183.6282132,  1416.3717868,  1737.3717868],
          [-2792.6282132,   246.3717868, -2618.6282132, ...,
            -716.6282132, -2639.6282132, -3134.6282132],
          ...,
          [  303.3717868,  3324.3717868,   939.3717868, ...,
             474.3717868,  -707.6282132,  2034.3717868],
          [-1853.6282132,   183.3717868,  1164.3717868, ...,
            1173.3717868,  3186.3717868,   993.3717868],
          [ 2967.3717868, -3029.6282132,  2763.3717868, ...,
            1125.3717868, -1226.6282132, -1559.6282132]],

         [[  591.3717868,  1599.3717868, -1475.6282132, ...,
            -218.6282132,  -818.6282132, -3068.6282132],
          [ 2472.3717868, -1493.6282132,   -41.6282132, ...,
            1668.3717868,  -269.6282132, -2231.6282132],
          [ 1845.3717868,  1350.3717868,  1605.3717868, ...,
             318.3717868, -1814.6282132, -3323.6282132],
          ...,
          [ 2367.3717868, -1928.6282132,  3027.3717868, ...,
            -764.6282132,  2193.3717868,  -983.6282132],
          [  594.3717868,  1731.3717868,  2934.3717868, ...,
             690.3717868,  2133.3717868,  1830.3717868],
          [  423.3717868,   558.3717868,   390.3717868, ...,
            -587.6282132,  -800.6282132, -1835.6282132]]],


        [[[  624.3717868, -3200.6282132,  1779.3717868, ...,
            1218.3717868,  1695.3717868, -1655.6282132],
          [-2144.6282132,   990.3717868,  1008.3717868, ...,
             180.3717868, -1916.6282132, -1445.6282132],
          [ 2136.3717868,  -803.6282132,  2538.3717868, ...,
            2646.3717868, -3035.6282132,   210.3717868],
          ...,
          [-2969.6282132, -1946.6282132,  1332.3717868, ...,
             243.3717868, -2597.6282132,  -569.6282132],
          [-2021.6282132,  1182.3717868,  -890.6282132, ...,
            3234.3717868, -1358.6282132, -3302.6282132],
          [ 1710.3717868, -2249.6282132,  1665.3717868, ...,
           -1004.6282132, -1997.6282132,   -20.6282132]],

         [[-3251.6282132, -3206.6282132,  -251.6282132, ...,
            2499.3717868,   -14.6282132,   345.3717868],
          [-1280.6282132, -1532.6282132,  -128.6282132, ...,
           -2441.6282132, -2162.6282132,  2790.3717868],
          [  675.3717868,  -734.6282132, -2687.6282132, ...,
             855.3717868, -1922.6282132,  3054.3717868],
          ...,
          [ 2094.3717868,  3336.3717868, -1634.6282132, ...,
            1902.3717868, -2891.6282132,  -914.6282132],
          [ 2691.3717868,  -395.6282132,  2688.3717868, ...,
           -2978.6282132,   999.3717868,  1719.3717868],
          [ 1629.3717868, -1442.6282132,   108.3717868, ...,
           -3257.6282132,   -38.6282132, -2783.6282132]],

         [[  138.3717868,  -236.6282132,  1401.3717868, ...,
             408.3717868, -1250.6282132,    96.3717868],
          [  774.3717868,  2463.3717868,  2199.3717868, ...,
            1431.3717868,  -641.6282132,  -926.6282132],
          [ 1122.3717868,  2718.3717868,  1524.3717868, ...,
           -1112.6282132, -2141.6282132, -3404.6282132],
          ...,
          [ 2343.3717868,   -98.6282132,  -389.6282132, ...,
             -71.6282132, -1754.6282132,   213.3717868],
          [  378.3717868,  2754.3717868,   840.3717868, ...,
            1272.3717868,   504.3717868, -2897.6282132],
          [-1649.6282132,   834.3717868,  3378.3717868, ...,
             702.3717868,  2910.3717868,   852.3717868]],

         [[-2138.6282132, -2696.6282132,    -8.6282132, ...,
            2658.3717868,  2286.3717868,  -899.6282132],
          [ 1086.3717868, -3407.6282132,  2550.3717868, ...,
             543.3717868,  1275.3717868,  2448.3717868],
          [ 2361.3717868, -1844.6282132,  1770.3717868, ...,
            -695.6282132,  -404.6282132,  1344.3717868],
          ...,
          [ -698.6282132,  2220.3717868, -2030.6282132, ...,
             582.3717868,  2817.3717868,  -509.6282132],
          [ 2223.3717868,  2310.3717868, -1211.6282132, ...,
           -2147.6282132,  1476.3717868,  1305.3717868],
          [ 2973.3717868,  -434.6282132,  1986.3717868, ...,
           -2714.6282132, -1091.6282132,   324.3717868]],

         [[ -821.6282132, -2729.6282132,  2775.3717868, ...,
            1959.3717868, -1424.6282132,   870.3717868],
          [ 1494.3717868,  3207.3717868,   588.3717868, ...,
            3015.3717868,  -536.6282132,   114.3717868],
          [-2027.6282132,  2295.3717868, -2189.6282132, ...,
            1386.3717868,  1233.3717868,   249.3717868],
          ...,
          [ -260.6282132,  -482.6282132, -1625.6282132, ...,
           -1013.6282132,   918.3717868,   333.3717868],
          [-2606.6282132,  2160.3717868,  -293.6282132, ...,
            3357.3717868,  -305.6282132,  1659.3717868],
          [-3044.6282132,  2466.3717868,  1803.3717868, ...,
            3150.3717868, -1676.6282132,  1176.3717868]]]],



       [[[[-3236.6282132, -3062.6282132,  2088.3717868, ...,
            2100.3717868,    84.3717868,  -164.6282132],
          [ 1101.3717868,  -437.6282132,  2430.3717868, ...,
            3123.3717868,  2406.3717868, -2633.6282132],
          [  888.3717868,   441.3717868,   681.3717868, ...,
           -2477.6282132,  3387.3717868,  2298.3717868],
          ...,
          [-2465.6282132,  -575.6282132,  2274.3717868, ...,
            3429.3717868, -1796.6282132,  3282.3717868],
          [  522.3717868,  2238.3717868,  3105.3717868, ...,
            3246.3717868,  1662.3717868,  3270.3717868],
          [ 1083.3717868,  1743.3717868,  2388.3717868, ...,
           -1088.6282132,   936.3717868, -1499.6282132]],

         [[-2948.6282132,   393.3717868,  -581.6282132, ...,
            3402.3717868,  2853.3717868,  -419.6282132],
          [-2786.6282132,   585.3717868,  3327.3717868, ...,
           -1139.6282132, -1337.6282132,  2796.3717868],
          [ 2232.3717868, -1172.6282132,  2064.3717868, ...,
           -3080.6282132,  3114.3717868,  1095.3717868],
          ...,
          [ 3297.3717868, -2369.6282132, -1604.6282132, ...,
           -1508.6282132,  1857.3717868, -1352.6282132],
          [-2495.6282132,  2355.3717868, -2627.6282132, ...,
             900.3717868,  1953.3717868,  2454.3717868],
          [-3368.6282132,   837.3717868, -3170.6282132, ...,
            -563.6282132,  -101.6282132,  -197.6282132]],

         [[ 3102.3717868,   516.3717868, -2642.6282132, ...,
            2565.3717868,  1713.3717868,  -359.6282132],
          [ 1098.3717868,  -344.6282132,  -749.6282132, ...,
           -1670.6282132,  2574.3717868,  2313.3717868],
          [ 1185.3717868,  1254.3717868,   975.3717868, ...,
            1092.3717868,  -290.6282132, -2009.6282132],
          ...,
          [-1763.6282132, -1871.6282132,  1674.3717868, ...,
           -2360.6282132, -1910.6282132, -2258.6282132],
          [  777.3717868, -2330.6282132, -1406.6282132, ...,
           -1118.6282132, -2585.6282132, -2018.6282132],
          [-1760.6282132,  -761.6282132,  2148.3717868, ...,
           -2087.6282132,  3318.3717868,  2652.3717868]],

         [[ 2340.3717868,   -47.6282132, -1328.6282132, ...,
            -584.6282132, -1523.6282132,  2826.3717868],
          [  414.3717868,  3462.3717868, -1952.6282132, ...,
            -407.6282132, -2288.6282132,  1632.3717868],
          [  426.3717868,  1680.3717868,   621.3717868, ...,
            3306.3717868, -1505.6282132, -3125.6282132],
          ...,
          [ 1989.3717868, -2066.6282132,  2115.3717868, ...,
            2433.3717868,   -11.6282132,  -932.6282132],
          [ 1899.3717868, -3047.6282132,   -53.6282132, ...,
             816.3717868, -2489.6282132,  1434.3717868],
          [ 2085.3717868,  3219.3717868,  2886.3717868, ...,
           -2444.6282132, -1106.6282132,  2346.3717868]],

         [[-1781.6282132,  2559.3717868,  -413.6282132, ...,
           -1793.6282132,   171.3717868, -1865.6282132],
          [ 2187.3717868, -2831.6282132,  -608.6282132, ...,
           -1487.6282132,  1689.3717868,  1992.3717868],
          [-3362.6282132,  3285.3717868, -1097.6282132, ...,
             156.3717868,  2706.3717868,  2547.3717868],
          ...,
          [ 2982.3717868,  -380.6282132,  2829.3717868, ...,
            -962.6282132, -2033.6282132,  2958.3717868],
          [-3098.6282132,  1284.3717868,  1617.3717868, ...,
            1794.3717868,  -998.6282132,   756.3717868],
          [ 2289.3717868,  1329.3717868, -1391.6282132, ...,
           -2738.6282132,  -494.6282132, -2768.6282132]]],


        [[[ 1824.3717868, -1700.6282132,  2403.3717868, ...,
           -1826.6282132,  2781.3717868,  -938.6282132],
          [ -350.6282132,  1287.3717868,  -212.6282132, ...,
           -2264.6282132,  -986.6282132,  -353.6282132],
          [-1529.6282132,   765.3717868, -3389.6282132, ...,
           -1238.6282132,  2511.3717868,  2169.3717868],
          ...,
          [ 1413.3717868, -2723.6282132, -2309.6282132, ...,
            2301.3717868, -1157.6282132,  2778.3717868],
          [ -902.6282132,  2151.3717868,   195.3717868, ...,
            2925.3717868,  1239.3717868,  -590.6282132],
          [ -233.6282132,  1911.3717868, -1007.6282132, ...,
           -2321.6282132,    36.3717868,  2604.3717868]],

         [[ 3183.3717868,  -425.6282132, -3269.6282132, ...,
            -449.6282132,  1545.3717868, -1469.6282132],
          [ 1977.3717868, -2261.6282132, -2198.6282132, ...,
             270.3717868,   843.3717868, -2933.6282132],
          [ 1905.3717868,  3333.3717868,  2700.3717868, ...,
            1224.3717868, -2711.6282132,   576.3717868],
          ...,
          [ 2811.3717868,  3087.3717868,  2937.3717868, ...,
             294.3717868,  3141.3717868,    54.3717868],
          [ 1764.3717868,  -548.6282132,   693.3717868, ...,
           -3002.6282132,  2904.3717868, -2159.6282132],
          [ -974.6282132, -1820.6282132,  -944.6282132, ...,
            3120.3717868,  -677.6282132, -2045.6282132]],

         [[ 1131.3717868, -2174.6282132,  2952.3717868, ...,
            2568.3717868,  -884.6282132, -1460.6282132],
          [-3344.6282132,  1071.3717868,  2868.3717868, ...,
            1029.3717868, -2690.6282132,   -17.6282132],
          [ 1308.3717868,   300.3717868, -2492.6282132, ...,
            3030.3717868, -3095.6282132,  -533.6282132],
          ...,
          [  762.3717868,  3045.3717868,  -593.6282132, ...,
            -272.6282132,  2013.3717868,  1782.3717868],
          [ 2496.3717868,   177.3717868,  -623.6282132, ...,
            -131.6282132, -1463.6282132, -2702.6282132],
          [ 2760.3717868,   903.3717868,  2766.3717868, ...,
             891.3717868,   786.3717868,   105.3717868]],

         [[ 3006.3717868,  2871.3717868,   144.3717868, ...,
             192.3717868,  2577.3717868, -2042.6282132],
          [ -539.6282132,  -119.6282132,  -911.6282132, ...,
           -2861.6282132, -2747.6282132,  -383.6282132],
          [-1811.6282132,  2376.3717868,  -773.6282132, ...,
            -221.6282132,  1263.3717868,  2130.3717868],
          ...,
          [ 2685.3717868,  1161.3717868,  1362.3717868, ...,
            3075.3717868,   -77.6282132, -1988.6282132],
          [ 3459.3717868, -3056.6282132,  -476.6282132, ...,
           -2216.6282132,   912.3717868,  1614.3717868],
          [-2648.6282132,  1371.3717868,  -701.6282132, ...,
            1248.3717868, -2516.6282132,  2862.3717868]],

         [[-2663.6282132, -1412.6282132,   948.3717868, ...,
            2844.3717868,   489.3717868,  -416.6282132],
          [-2603.6282132,   597.3717868, -2000.6282132, ...,
             453.3717868,  1602.3717868, -1178.6282132],
          [-3014.6282132,  -257.6282132,  1746.3717868, ...,
           -2741.6282132,  -614.6282132, -2921.6282132],
          ...,
          [-1502.6282132,  1878.3717868, -2180.6282132, ...,
            2721.3717868, -3320.6282132,  3450.3717868],
          [ 1935.3717868,  3138.3717868, -3440.6282132, ...,
           -1949.6282132, -1589.6282132, -1376.6282132],
          [ 3156.3717868,  1152.3717868, -2126.6282132, ...,
            2229.3717868, -2930.6282132,    42.3717868]]],


        [[[-2399.6282132,   135.3717868, -1016.6282132, ...,
            -896.6282132, -1718.6282132, -2060.6282132],
          [ -785.6282132,   930.3717868, -3392.6282132, ...,
            2880.3717868, -1193.6282132, -2828.6282132],
          [-1592.6282132, -3431.6282132,  2283.3717868, ...,
            1407.3717868, -2342.6282132, -1526.6282132],
          ...,
          [-3281.6282132,   411.3717868,   714.3717868, ...,
            1449.3717868, -2945.6282132, -3032.6282132],
          [ 3222.3717868,    69.3717868,  -806.6282132, ...,
            -929.6282132,  -368.6282132,  -302.6282132],
          [  618.3717868, -2825.6282132, -1943.6282132, ...,
            -635.6282132, -1244.6282132,  1635.3717868]],

         [[-2810.6282132,  2106.3717868,  1059.3717868, ...,
             804.3717868,  3354.3717868, -1073.6282132],
          [ -719.6282132, -2855.6282132,  2637.3717868, ...,
           -2426.6282132,  1749.3717868, -1631.6282132],
          [-1286.6282132, -2378.6282132,   987.3717868, ...,
             564.3717868,   450.3717868,  1023.3717868],
          ...,
          [ 1776.3717868,  1107.3717868,  1473.3717868, ...,
            2901.3717868,   147.3717868, -2291.6282132],
          [  372.3717868,  2172.3717868, -1688.6282132, ...,
            1290.3717868,   -68.6282132,   327.3717868],
          [-2102.6282132, -2453.6282132,   696.3717868, ...,
           -1709.6282132,  2523.3717868, -2753.6282132]],

         [[  444.3717868,  2865.3717868,  -737.6282132, ...,
           -1229.6282132,  1389.3717868,  3018.3717868],
          [ 3414.3717868, -2108.6282132,  -116.6282132, ...,
           -3464.6282132,  3423.3717868,  1458.3717868],
          [-3233.6282132,   966.3717868, -3194.6282132, ...,
           -2192.6282132, -2459.6282132,  2175.3717868],
          ...,
          [ 1893.3717868,  2001.3717868, -2057.6282132, ...,
            3399.3717868, -1976.6282132, -3275.6282132],
          [-1610.6282132,   -83.6282132, -1400.6282132, ...,
             267.3717868,  -431.6282132,  1035.3717868],
          [ -710.6282132, -2447.6282132,  3210.3717868, ...,
            1653.3717868,    75.3717868,  2607.3717868]],

         [[ 1896.3717868,   258.3717868,   792.3717868, ...,
            -656.6282132,  3372.3717868, -2780.6282132],
          [-2798.6282132,  1683.3717868,  1116.3717868, ...,
           -2651.6282132,  -755.6282132,  3396.3717868],
          [ -953.6282132,   162.3717868,  2493.3717868, ...,
            -137.6282132, -3176.6282132, -1046.6282132],
          ...,
          [ -464.6282132,  2322.3717868,  2787.3717868, ...,
             759.3717868,  1563.3717868,  2079.3717868],
          [ 1299.3717868, -2726.6282132, -3059.6282132, ...,
           -1694.6282132, -1208.6282132,  1278.3717868],
          [-2243.6282132,   726.3717868,  2364.3717868, ...,
           -3311.6282132, -1019.6282132, -2390.6282132]],

         [[ 1515.3717868,  1854.3717868, -3305.6282132, ...,
             972.3717868,  -827.6282132,  -554.6282132],
          [ 2019.3717868,  -341.6282132, -1766.6282132, ...,
            1938.3717868, -1373.6282132,  3213.3717868],
          [ 2643.3717868, -1217.6282132,  1965.3717868, ...,
            2517.3717868,  2748.3717868, -3380.6282132],
          ...,
          [-2795.6282132,   285.3717868,  -596.6282132, ...,
            1119.3717868, -2081.6282132,  2679.3717868],
          [-1514.6282132,   753.3717868,   -62.6282132, ...,
            2913.3717868, -3185.6282132,  -824.6282132],
          [  639.3717868,  3099.3717868,    57.3717868, ...,
             894.3717868, -2609.6282132,  1053.3717868]]]]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_21 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (2,3,5,7,11) could not be broadcast to indexing result of shape (2,2,5,7,11)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (2,3,5,7,11) could not be broadcast to indexing result of shape (2,2,5,7,11)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, InplaceDimShuffle{0,x,x,x,x}.0, TopKOp{axis=-4, sorted=False}.1, InplaceDimShuffle{0,x,x}.0, InplaceDimShuffle{0,x}.0, ARange{dtype=\'int64\'}.0)\nToposort index: 14\nInputs types: [TensorType(float64, 5D), TensorType(float64, 5D), TensorType(int64, (False, True, True, True, True)), TensorType(int64, 5D), TensorType(int64, (False, True, True)), TensorType(int64, col), TensorType(int64, vector)]\nInputs shapes: [(2, 3, 5, 7, 11), (2, 3, 5, 7, 11), (2, 1, 1, 1, 1), (2, 2, 5, 7, 11), (5, 1, 1), (7, 1), (11,)]\nInputs strides: [(9240, 3080, 616, 88, 8), (9240, 3080, 616, 88, 8), (8, 8, 8, 8, 8), (6160, 3080, 616, 88, 8), (8, 8, 8), (8, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', array([[[[[0]]]],\n\n\n\n       [[[[1]]]]], dtype=int64), \'not shown\', array([[[0]],\n\n       [[1]],\n\n       [[2]],\n\n       [[3]],\n\n       [[4]]], dtype=int64), \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[[[[ 1887.3717868,   663.3717868,  2022.3717868, ...,
           -1187.6282132, -2942.6282132,  -440.6282132],
          [  297.3717868,  1980.3717868, -2705.6282132, ...,
             660.3717868, -1232.6282132,    -5.6282132],
          [ 2139.3717868, -3215.6282132,  -284.6282132, ...,
            -674.6282132, -2003.6282132, -3188.6282132],
          ...,
          [ 3315.3717868,  -602.6282132,  1050.3717868, ...,
           -1985.6282132, -1070.6282132, -2072.6282132],
          [  186.3717868, -1691.6282132,  -410.6282132, ...,
           -2879.6282132,  2010.3717868,  1323.3717868],
          [ 1452.3717868,  3261.3717868,  2262.3717868, ...,
             822.3717868,  -638.6282132,   438.3717868]],

         [[-2906.6282132,  2259.3717868, -1196.6282132, ...,
           -1739.6282132, -1175.6282132, -2816.6282132],
          [-1043.6282132,  -848.6282132,    81.3717868, ...,
           -1037.6282132,   174.3717868,  2244.3717868],
          [ 3447.3717868, -3119.6282132,  -392.6282132, ...,
            3273.3717868,  1212.3717868, -2015.6282132],
          ...,
          [-3092.6282132,  1650.3717868,   906.3717868, ...,
            -788.6282132, -1010.6282132,  1758.3717868],
          [ 1395.3717868,  -971.6282132,  -182.6282132, ...,
           -2069.6282132,  -692.6282132,  1356.3717868],
          [  606.3717868, -1712.6282132,  2070.3717868, ...,
           -3335.6282132,  -152.6282132, -2123.6282132]],

         [[-1586.6282132,  3177.3717868, -3359.6282132, ...,
           -2096.6282132,   858.3717868, -2168.6282132],
          [  642.3717868,   849.3717868, -1898.6282132, ...,
               6.3717868, -2432.6282132,  2178.3717868],
          [-2777.6282132,  2451.3717868,  1335.3717868, ...,
            -653.6282132, -2564.6282132,  2391.3717868],
          ...,
          [  708.3717868, -2510.6282132, -3410.6282132, ...,
            -227.6282132, -2567.6282132, -2975.6282132],
          [ 2049.3717868,  -521.6282132,  1380.3717868, ...,
            2235.3717868, -2675.6282132,   810.3717868],
          [ 3153.3717868, -3050.6282132, -2525.6282132, ...,
           -2150.6282132, -1733.6282132, -2954.6282132]],

         [[ 1827.3717868, -2837.6282132, -3371.6282132, ...,
             252.3717868, -2759.6282132,  -323.6282132],
          [ 2052.3717868,  3225.3717868,   -23.6282132, ...,
            2166.3717868,   636.3717868,  2487.3717868],
          [ 3057.3717868,  1809.3717868, -1481.6282132, ...,
            1080.3717868, -3083.6282132, -2852.6282132],
          ...,
          [ 2850.3717868, -3314.6282132, -1439.6282132, ...,
           -2645.6282132,  3012.3717868,  2400.3717868],
          [-1190.6282132, -1220.6282132,  1860.3717868, ...,
            1425.3717868,  -278.6282132, -1802.6282132],
          [ -791.6282132, -2201.6282132,  -428.6282132, ...,
           -1466.6282132,   420.3717868,  3201.3717868]],

         [[ -671.6282132,   678.3717868, -2156.6282132, ...,
           -3329.6282132, -1316.6282132,   570.3717868],
          [-3224.6282132, -3386.6282132,  1446.3717868, ...,
             735.3717868, -1145.6282132,  1704.3717868],
          [ 2985.3717868,  2814.3717868,  2058.3717868, ...,
           -2099.6282132,  1191.3717868, -2624.6282132],
          ...,
          [ 3078.3717868, -1895.6282132,  -857.6282132, ...,
            2745.3717868,   429.3717868,   954.3717868],
          [ 1146.3717868, -2612.6282132,  2442.3717868, ...,
              63.3717868,  1638.3717868,  1437.3717868],
          [ 2838.3717868, -2093.6282132,   771.3717868, ...,
           -2774.6282132,  2445.3717868, -2240.6282132]]],


        [[[ -743.6282132, -2558.6282132,  2124.3717868, ...,
           -1127.6282132, -1919.6282132,  1518.3717868],
          [ 2757.3717868,  1200.3717868, -1076.6282132, ...,
             465.3717868, -2273.6282132,  3069.3717868],
          [ 2931.3717868,  -206.6282132, -1484.6282132, ...,
             315.3717868, -2006.6282132,   321.3717868],
          ...,
          [ 2583.3717868,  2571.3717868,   945.3717868, ...,
            3453.3717868,  1728.3717868, -1283.6282132],
          [-3437.6282132, -1595.6282132,  1497.3717868, ...,
            1404.3717868,  3330.3717868,  -224.6282132],
          [-1682.6282132, -3152.6282132,  1047.3717868, ...,
            2331.3717868,  3021.3717868,    30.3717868]],

         [[ -665.6282132, -3317.6282132, -1367.6282132, ...,
             150.3717868,  2589.3717868,  1566.3717868],
          [-1340.6282132, -2318.6282132,  1359.3717868, ...,
             540.3717868,  -887.6282132,  2943.3717868],
          [-1724.6282132,  2316.3717868,  -524.6282132, ...,
           -3350.6282132, -2219.6282132,  1725.3717868],
          ...,
          [-2297.6282132, -1409.6282132,  1920.3717868, ...,
            1155.3717868,   -29.6282132, -3326.6282132],
          [-1727.6282132, -3293.6282132,  2616.3717868, ...,
            2883.3717868,  -473.6282132, -2084.6282132],
          [ -173.6282132, -1154.6282132, -3419.6282132, ...,
            1917.3717868,  -356.6282132, -1808.6282132]],

         [[ 3132.3717868,  1203.3717868,  2667.3717868, ...,
            1974.3717868,  1500.3717868,  2508.3717868],
          [ -644.6282132,  -362.6282132,  -296.6282132, ...,
           -2615.6282132, -2414.6282132,  2073.3717868],
          [-1436.6282132,  1026.3717868,  -605.6282132, ...,
           -2993.6282132,  3420.3717868,   882.3717868],
          ...,
          [ 1560.3717868, -1790.6282132,   984.3717868, ...,
           -2354.6282132,   282.3717868,  1197.3717868],
          [-2054.6282132,   198.3717868, -2594.6282132, ...,
             237.3717868,  3231.3717868,  1269.3717868],
          [   99.3717868, -1745.6282132,   264.3717868, ...,
           -1289.6282132,   630.3717868, -2534.6282132]],

         [[ 2307.3717868, -1850.6282132,  2610.3717868, ...,
           -3104.6282132, -1205.6282132, -1613.6282132],
          [-1430.6282132,  1947.3717868, -2750.6282132, ...,
           -2183.6282132,  1416.3717868,  1737.3717868],
          [-2792.6282132,   246.3717868, -2618.6282132, ...,
            -716.6282132, -2639.6282132, -3134.6282132],
          ...,
          [  303.3717868,  3324.3717868,   939.3717868, ...,
             474.3717868,  -707.6282132,  2034.3717868],
          [-1853.6282132,   183.3717868,  1164.3717868, ...,
            1173.3717868,  3186.3717868,   993.3717868],
          [ 2967.3717868, -3029.6282132,  2763.3717868, ...,
            1125.3717868, -1226.6282132, -1559.6282132]],

         [[  591.3717868,  1599.3717868, -1475.6282132, ...,
            -218.6282132,  -818.6282132, -3068.6282132],
          [ 2472.3717868, -1493.6282132,   -41.6282132, ...,
            1668.3717868,  -269.6282132, -2231.6282132],
          [ 1845.3717868,  1350.3717868,  1605.3717868, ...,
             318.3717868, -1814.6282132, -3323.6282132],
          ...,
          [ 2367.3717868, -1928.6282132,  3027.3717868, ...,
            -764.6282132,  2193.3717868,  -983.6282132],
          [  594.3717868,  1731.3717868,  2934.3717868, ...,
             690.3717868,  2133.3717868,  1830.3717868],
          [  423.3717868,   558.3717868,   390.3717868, ...,
            -587.6282132,  -800.6282132, -1835.6282132]]],


        [[[  624.3717868, -3200.6282132,  1779.3717868, ...,
            1218.3717868,  1695.3717868, -1655.6282132],
          [-2144.6282132,   990.3717868,  1008.3717868, ...,
             180.3717868, -1916.6282132, -1445.6282132],
          [ 2136.3717868,  -803.6282132,  2538.3717868, ...,
            2646.3717868, -3035.6282132,   210.3717868],
          ...,
          [-2969.6282132, -1946.6282132,  1332.3717868, ...,
             243.3717868, -2597.6282132,  -569.6282132],
          [-2021.6282132,  1182.3717868,  -890.6282132, ...,
            3234.3717868, -1358.6282132, -3302.6282132],
          [ 1710.3717868, -2249.6282132,  1665.3717868, ...,
           -1004.6282132, -1997.6282132,   -20.6282132]],

         [[-3251.6282132, -3206.6282132,  -251.6282132, ...,
            2499.3717868,   -14.6282132,   345.3717868],
          [-1280.6282132, -1532.6282132,  -128.6282132, ...,
           -2441.6282132, -2162.6282132,  2790.3717868],
          [  675.3717868,  -734.6282132, -2687.6282132, ...,
             855.3717868, -1922.6282132,  3054.3717868],
          ...,
          [ 2094.3717868,  3336.3717868, -1634.6282132, ...,
            1902.3717868, -2891.6282132,  -914.6282132],
          [ 2691.3717868,  -395.6282132,  2688.3717868, ...,
           -2978.6282132,   999.3717868,  1719.3717868],
          [ 1629.3717868, -1442.6282132,   108.3717868, ...,
           -3257.6282132,   -38.6282132, -2783.6282132]],

         [[  138.3717868,  -236.6282132,  1401.3717868, ...,
             408.3717868, -1250.6282132,    96.3717868],
          [  774.3717868,  2463.3717868,  2199.3717868, ...,
            1431.3717868,  -641.6282132,  -926.6282132],
          [ 1122.3717868,  2718.3717868,  1524.3717868, ...,
           -1112.6282132, -2141.6282132, -3404.6282132],
          ...,
          [ 2343.3717868,   -98.6282132,  -389.6282132, ...,
             -71.6282132, -1754.6282132,   213.3717868],
          [  378.3717868,  2754.3717868,   840.3717868, ...,
            1272.3717868,   504.3717868, -2897.6282132],
          [-1649.6282132,   834.3717868,  3378.3717868, ...,
             702.3717868,  2910.3717868,   852.3717868]],

         [[-2138.6282132, -2696.6282132,    -8.6282132, ...,
            2658.3717868,  2286.3717868,  -899.6282132],
          [ 1086.3717868, -3407.6282132,  2550.3717868, ...,
             543.3717868,  1275.3717868,  2448.3717868],
          [ 2361.3717868, -1844.6282132,  1770.3717868, ...,
            -695.6282132,  -404.6282132,  1344.3717868],
          ...,
          [ -698.6282132,  2220.3717868, -2030.6282132, ...,
             582.3717868,  2817.3717868,  -509.6282132],
          [ 2223.3717868,  2310.3717868, -1211.6282132, ...,
           -2147.6282132,  1476.3717868,  1305.3717868],
          [ 2973.3717868,  -434.6282132,  1986.3717868, ...,
           -2714.6282132, -1091.6282132,   324.3717868]],

         [[ -821.6282132, -2729.6282132,  2775.3717868, ...,
            1959.3717868, -1424.6282132,   870.3717868],
          [ 1494.3717868,  3207.3717868,   588.3717868, ...,
            3015.3717868,  -536.6282132,   114.3717868],
          [-2027.6282132,  2295.3717868, -2189.6282132, ...,
            1386.3717868,  1233.3717868,   249.3717868],
          ...,
          [ -260.6282132,  -482.6282132, -1625.6282132, ...,
           -1013.6282132,   918.3717868,   333.3717868],
          [-2606.6282132,  2160.3717868,  -293.6282132, ...,
            3357.3717868,  -305.6282132,  1659.3717868],
          [-3044.6282132,  2466.3717868,  1803.3717868, ...,
            3150.3717868, -1676.6282132,  1176.3717868]]]],



       [[[[-3236.6282132, -3062.6282132,  2088.3717868, ...,
            2100.3717868,    84.3717868,  -164.6282132],
          [ 1101.3717868,  -437.6282132,  2430.3717868, ...,
            3123.3717868,  2406.3717868, -2633.6282132],
          [  888.3717868,   441.3717868,   681.3717868, ...,
           -2477.6282132,  3387.3717868,  2298.3717868],
          ...,
          [-2465.6282132,  -575.6282132,  2274.3717868, ...,
            3429.3717868, -1796.6282132,  3282.3717868],
          [  522.3717868,  2238.3717868,  3105.3717868, ...,
            3246.3717868,  1662.3717868,  3270.3717868],
          [ 1083.3717868,  1743.3717868,  2388.3717868, ...,
           -1088.6282132,   936.3717868, -1499.6282132]],

         [[-2948.6282132,   393.3717868,  -581.6282132, ...,
            3402.3717868,  2853.3717868,  -419.6282132],
          [-2786.6282132,   585.3717868,  3327.3717868, ...,
           -1139.6282132, -1337.6282132,  2796.3717868],
          [ 2232.3717868, -1172.6282132,  2064.3717868, ...,
           -3080.6282132,  3114.3717868,  1095.3717868],
          ...,
          [ 3297.3717868, -2369.6282132, -1604.6282132, ...,
           -1508.6282132,  1857.3717868, -1352.6282132],
          [-2495.6282132,  2355.3717868, -2627.6282132, ...,
             900.3717868,  1953.3717868,  2454.3717868],
          [-3368.6282132,   837.3717868, -3170.6282132, ...,
            -563.6282132,  -101.6282132,  -197.6282132]],

         [[ 3102.3717868,   516.3717868, -2642.6282132, ...,
            2565.3717868,  1713.3717868,  -359.6282132],
          [ 1098.3717868,  -344.6282132,  -749.6282132, ...,
           -1670.6282132,  2574.3717868,  2313.3717868],
          [ 1185.3717868,  1254.3717868,   975.3717868, ...,
            1092.3717868,  -290.6282132, -2009.6282132],
          ...,
          [-1763.6282132, -1871.6282132,  1674.3717868, ...,
           -2360.6282132, -1910.6282132, -2258.6282132],
          [  777.3717868, -2330.6282132, -1406.6282132, ...,
           -1118.6282132, -2585.6282132, -2018.6282132],
          [-1760.6282132,  -761.6282132,  2148.3717868, ...,
           -2087.6282132,  3318.3717868,  2652.3717868]],

         [[ 2340.3717868,   -47.6282132, -1328.6282132, ...,
            -584.6282132, -1523.6282132,  2826.3717868],
          [  414.3717868,  3462.3717868, -1952.6282132, ...,
            -407.6282132, -2288.6282132,  1632.3717868],
          [  426.3717868,  1680.3717868,   621.3717868, ...,
            3306.3717868, -1505.6282132, -3125.6282132],
          ...,
          [ 1989.3717868, -2066.6282132,  2115.3717868, ...,
            2433.3717868,   -11.6282132,  -932.6282132],
          [ 1899.3717868, -3047.6282132,   -53.6282132, ...,
             816.3717868, -2489.6282132,  1434.3717868],
          [ 2085.3717868,  3219.3717868,  2886.3717868, ...,
           -2444.6282132, -1106.6282132,  2346.3717868]],

         [[-1781.6282132,  2559.3717868,  -413.6282132, ...,
           -1793.6282132,   171.3717868, -1865.6282132],
          [ 2187.3717868, -2831.6282132,  -608.6282132, ...,
           -1487.6282132,  1689.3717868,  1992.3717868],
          [-3362.6282132,  3285.3717868, -1097.6282132, ...,
             156.3717868,  2706.3717868,  2547.3717868],
          ...,
          [ 2982.3717868,  -380.6282132,  2829.3717868, ...,
            -962.6282132, -2033.6282132,  2958.3717868],
          [-3098.6282132,  1284.3717868,  1617.3717868, ...,
            1794.3717868,  -998.6282132,   756.3717868],
          [ 2289.3717868,  1329.3717868, -1391.6282132, ...,
           -2738.6282132,  -494.6282132, -2768.6282132]]],


        [[[ 1824.3717868, -1700.6282132,  2403.3717868, ...,
           -1826.6282132,  2781.3717868,  -938.6282132],
          [ -350.6282132,  1287.3717868,  -212.6282132, ...,
           -2264.6282132,  -986.6282132,  -353.6282132],
          [-1529.6282132,   765.3717868, -3389.6282132, ...,
           -1238.6282132,  2511.3717868,  2169.3717868],
          ...,
          [ 1413.3717868, -2723.6282132, -2309.6282132, ...,
            2301.3717868, -1157.6282132,  2778.3717868],
          [ -902.6282132,  2151.3717868,   195.3717868, ...,
            2925.3717868,  1239.3717868,  -590.6282132],
          [ -233.6282132,  1911.3717868, -1007.6282132, ...,
           -2321.6282132,    36.3717868,  2604.3717868]],

         [[ 3183.3717868,  -425.6282132, -3269.6282132, ...,
            -449.6282132,  1545.3717868, -1469.6282132],
          [ 1977.3717868, -2261.6282132, -2198.6282132, ...,
             270.3717868,   843.3717868, -2933.6282132],
          [ 1905.3717868,  3333.3717868,  2700.3717868, ...,
            1224.3717868, -2711.6282132,   576.3717868],
          ...,
          [ 2811.3717868,  3087.3717868,  2937.3717868, ...,
             294.3717868,  3141.3717868,    54.3717868],
          [ 1764.3717868,  -548.6282132,   693.3717868, ...,
           -3002.6282132,  2904.3717868, -2159.6282132],
          [ -974.6282132, -1820.6282132,  -944.6282132, ...,
            3120.3717868,  -677.6282132, -2045.6282132]],

         [[ 1131.3717868, -2174.6282132,  2952.3717868, ...,
            2568.3717868,  -884.6282132, -1460.6282132],
          [-3344.6282132,  1071.3717868,  2868.3717868, ...,
            1029.3717868, -2690.6282132,   -17.6282132],
          [ 1308.3717868,   300.3717868, -2492.6282132, ...,
            3030.3717868, -3095.6282132,  -533.6282132],
          ...,
          [  762.3717868,  3045.3717868,  -593.6282132, ...,
            -272.6282132,  2013.3717868,  1782.3717868],
          [ 2496.3717868,   177.3717868,  -623.6282132, ...,
            -131.6282132, -1463.6282132, -2702.6282132],
          [ 2760.3717868,   903.3717868,  2766.3717868, ...,
             891.3717868,   786.3717868,   105.3717868]],

         [[ 3006.3717868,  2871.3717868,   144.3717868, ...,
             192.3717868,  2577.3717868, -2042.6282132],
          [ -539.6282132,  -119.6282132,  -911.6282132, ...,
           -2861.6282132, -2747.6282132,  -383.6282132],
          [-1811.6282132,  2376.3717868,  -773.6282132, ...,
            -221.6282132,  1263.3717868,  2130.3717868],
          ...,
          [ 2685.3717868,  1161.3717868,  1362.3717868, ...,
            3075.3717868,   -77.6282132, -1988.6282132],
          [ 3459.3717868, -3056.6282132,  -476.6282132, ...,
           -2216.6282132,   912.3717868,  1614.3717868],
          [-2648.6282132,  1371.3717868,  -701.6282132, ...,
            1248.3717868, -2516.6282132,  2862.3717868]],

         [[-2663.6282132, -1412.6282132,   948.3717868, ...,
            2844.3717868,   489.3717868,  -416.6282132],
          [-2603.6282132,   597.3717868, -2000.6282132, ...,
             453.3717868,  1602.3717868, -1178.6282132],
          [-3014.6282132,  -257.6282132,  1746.3717868, ...,
           -2741.6282132,  -614.6282132, -2921.6282132],
          ...,
          [-1502.6282132,  1878.3717868, -2180.6282132, ...,
            2721.3717868, -3320.6282132,  3450.3717868],
          [ 1935.3717868,  3138.3717868, -3440.6282132, ...,
           -1949.6282132, -1589.6282132, -1376.6282132],
          [ 3156.3717868,  1152.3717868, -2126.6282132, ...,
            2229.3717868, -2930.6282132,    42.3717868]]],


        [[[-2399.6282132,   135.3717868, -1016.6282132, ...,
            -896.6282132, -1718.6282132, -2060.6282132],
          [ -785.6282132,   930.3717868, -3392.6282132, ...,
            2880.3717868, -1193.6282132, -2828.6282132],
          [-1592.6282132, -3431.6282132,  2283.3717868, ...,
            1407.3717868, -2342.6282132, -1526.6282132],
          ...,
          [-3281.6282132,   411.3717868,   714.3717868, ...,
            1449.3717868, -2945.6282132, -3032.6282132],
          [ 3222.3717868,    69.3717868,  -806.6282132, ...,
            -929.6282132,  -368.6282132,  -302.6282132],
          [  618.3717868, -2825.6282132, -1943.6282132, ...,
            -635.6282132, -1244.6282132,  1635.3717868]],

         [[-2810.6282132,  2106.3717868,  1059.3717868, ...,
             804.3717868,  3354.3717868, -1073.6282132],
          [ -719.6282132, -2855.6282132,  2637.3717868, ...,
           -2426.6282132,  1749.3717868, -1631.6282132],
          [-1286.6282132, -2378.6282132,   987.3717868, ...,
             564.3717868,   450.3717868,  1023.3717868],
          ...,
          [ 1776.3717868,  1107.3717868,  1473.3717868, ...,
            2901.3717868,   147.3717868, -2291.6282132],
          [  372.3717868,  2172.3717868, -1688.6282132, ...,
            1290.3717868,   -68.6282132,   327.3717868],
          [-2102.6282132, -2453.6282132,   696.3717868, ...,
           -1709.6282132,  2523.3717868, -2753.6282132]],

         [[  444.3717868,  2865.3717868,  -737.6282132, ...,
           -1229.6282132,  1389.3717868,  3018.3717868],
          [ 3414.3717868, -2108.6282132,  -116.6282132, ...,
           -3464.6282132,  3423.3717868,  1458.3717868],
          [-3233.6282132,   966.3717868, -3194.6282132, ...,
           -2192.6282132, -2459.6282132,  2175.3717868],
          ...,
          [ 1893.3717868,  2001.3717868, -2057.6282132, ...,
            3399.3717868, -1976.6282132, -3275.6282132],
          [-1610.6282132,   -83.6282132, -1400.6282132, ...,
             267.3717868,  -431.6282132,  1035.3717868],
          [ -710.6282132, -2447.6282132,  3210.3717868, ...,
            1653.3717868,    75.3717868,  2607.3717868]],

         [[ 1896.3717868,   258.3717868,   792.3717868, ...,
            -656.6282132,  3372.3717868, -2780.6282132],
          [-2798.6282132,  1683.3717868,  1116.3717868, ...,
           -2651.6282132,  -755.6282132,  3396.3717868],
          [ -953.6282132,   162.3717868,  2493.3717868, ...,
            -137.6282132, -3176.6282132, -1046.6282132],
          ...,
          [ -464.6282132,  2322.3717868,  2787.3717868, ...,
             759.3717868,  1563.3717868,  2079.3717868],
          [ 1299.3717868, -2726.6282132, -3059.6282132, ...,
           -1694.6282132, -1208.6282132,  1278.3717868],
          [-2243.6282132,   726.3717868,  2364.3717868, ...,
           -3311.6282132, -1019.6282132, -2390.6282132]],

         [[ 1515.3717868,  1854.3717868, -3305.6282132, ...,
             972.3717868,  -827.6282132,  -554.6282132],
          [ 2019.3717868,  -341.6282132, -1766.6282132, ...,
            1938.3717868, -1373.6282132,  3213.3717868],
          [ 2643.3717868, -1217.6282132,  1965.3717868, ...,
            2517.3717868,  2748.3717868, -3380.6282132],
          ...,
          [-2795.6282132,   285.3717868,  -596.6282132, ...,
            1119.3717868, -2081.6282132,  2679.3717868],
          [-1514.6282132,   753.3717868,   -62.6282132, ...,
            2913.3717868, -3185.6282132,  -824.6282132],
          [  639.3717868,  3099.3717868,    57.3717868, ...,
             894.3717868, -2609.6282132,  1053.3717868]]]]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_grad_22 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=2) out of bounds (2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1738, in verify_grad
    o_fn_out = o_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=2) out of bounds (2)
Apply node that caused the error: TopKOp{axis=-5, sorted=False}(input 0, TensorConstant{-2})
Toposort index: 0
Inputs types: [TensorType(float64, 5D), TensorType(int8, scalar)]
Inputs shapes: [(2, 3, 5, 7, 11), ()]
Inputs strides: [(9240, 3080, 616, 88, 8), ()]
Inputs values: ['not shown', array(-2, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in <lambda>
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_grad_23 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: shape mismatch: value array of shape (2,3,5,7,11) could not be broadcast to indexing result of shape (2,2,5,7,11)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 442, in test_grad
    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1780, in verify_grad
    analytic_grad = grad_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\subtensor.py", line 2339, in perform
    out[0][tuple(inputs[2:])] = inputs[1]
ValueError: ('shape mismatch: value array of shape (2,3,5,7,11) could not be broadcast to indexing result of shape (2,2,5,7,11)\nApply node that caused the error: AdvancedIncSubtensor{inplace=False,  set_instead_of_inc=True}(Alloc.0, random_projection, InplaceDimShuffle{0,x,x,x,x}.0, TopKOp{axis=-4, sorted=False}.1, InplaceDimShuffle{0,x,x}.0, InplaceDimShuffle{0,x}.0, ARange{dtype=\'int64\'}.0)\nToposort index: 14\nInputs types: [TensorType(float64, 5D), TensorType(float64, 5D), TensorType(int64, (False, True, True, True, True)), TensorType(int64, 5D), TensorType(int64, (False, True, True)), TensorType(int64, col), TensorType(int64, vector)]\nInputs shapes: [(2, 3, 5, 7, 11), (2, 3, 5, 7, 11), (2, 1, 1, 1, 1), (2, 2, 5, 7, 11), (5, 1, 1), (7, 1), (11,)]\nInputs strides: [(9240, 3080, 616, 88, 8), (9240, 3080, 616, 88, 8), (8, 8, 8, 8, 8), (6160, 3080, 616, 88, 8), (8, 8, 8), (8, 8), (8,)]\nInputs values: [\'not shown\', \'not shown\', array([[[[[0]]]],\n\n\n\n       [[[[1]]]]], dtype=int64), \'not shown\', array([[[0]],\n\n       [[1]],\n\n       [[2]],\n\n       [[3]],\n\n       [[4]]], dtype=int64), \'not shown\', \'not shown\']\nOutputs clients: [[\'output\']]\n\nBacktrace when the node is created(use Theano flag traceback.limit=N to make it longer):\n  File "C:\\Users\\mutation\\Desktop\\theano-testcase\\tests\\test_sort.py", line 442, in test_grad\n    utt.verify_grad(lambda x: topk(x, k, axis=axis, sorted=sorted), [xval], eps=1e-2)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tests\\unittest_tools.py", line 92, in verify_grad\n    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1770, in verify_grad\n    disconnected_inputs=\'ignore\')\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 605, in grad\n    grad_dict, wrt, cost_name)\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in _populate_grad_dict\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1371, in <listcomp>\n    rval = [access_grad_cache(elem) for elem in wrt]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1326, in access_grad_cache\n    term = access_term_cache(node)[idx]\n  File "C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\gradient.py", line 1162, in access_term_cache\n    new_output_grads)\n\nHINT: Use the Theano flag \'exception_verbosity=high\' for a debugprint and storage map footprint of this apply node.', '\nThe error happened with the following inputs:', [array([[[[[ 1887.3717868,   663.3717868,  2022.3717868, ...,
           -1187.6282132, -2942.6282132,  -440.6282132],
          [  297.3717868,  1980.3717868, -2705.6282132, ...,
             660.3717868, -1232.6282132,    -5.6282132],
          [ 2139.3717868, -3215.6282132,  -284.6282132, ...,
            -674.6282132, -2003.6282132, -3188.6282132],
          ...,
          [ 3315.3717868,  -602.6282132,  1050.3717868, ...,
           -1985.6282132, -1070.6282132, -2072.6282132],
          [  186.3717868, -1691.6282132,  -410.6282132, ...,
           -2879.6282132,  2010.3717868,  1323.3717868],
          [ 1452.3717868,  3261.3717868,  2262.3717868, ...,
             822.3717868,  -638.6282132,   438.3717868]],

         [[-2906.6282132,  2259.3717868, -1196.6282132, ...,
           -1739.6282132, -1175.6282132, -2816.6282132],
          [-1043.6282132,  -848.6282132,    81.3717868, ...,
           -1037.6282132,   174.3717868,  2244.3717868],
          [ 3447.3717868, -3119.6282132,  -392.6282132, ...,
            3273.3717868,  1212.3717868, -2015.6282132],
          ...,
          [-3092.6282132,  1650.3717868,   906.3717868, ...,
            -788.6282132, -1010.6282132,  1758.3717868],
          [ 1395.3717868,  -971.6282132,  -182.6282132, ...,
           -2069.6282132,  -692.6282132,  1356.3717868],
          [  606.3717868, -1712.6282132,  2070.3717868, ...,
           -3335.6282132,  -152.6282132, -2123.6282132]],

         [[-1586.6282132,  3177.3717868, -3359.6282132, ...,
           -2096.6282132,   858.3717868, -2168.6282132],
          [  642.3717868,   849.3717868, -1898.6282132, ...,
               6.3717868, -2432.6282132,  2178.3717868],
          [-2777.6282132,  2451.3717868,  1335.3717868, ...,
            -653.6282132, -2564.6282132,  2391.3717868],
          ...,
          [  708.3717868, -2510.6282132, -3410.6282132, ...,
            -227.6282132, -2567.6282132, -2975.6282132],
          [ 2049.3717868,  -521.6282132,  1380.3717868, ...,
            2235.3717868, -2675.6282132,   810.3717868],
          [ 3153.3717868, -3050.6282132, -2525.6282132, ...,
           -2150.6282132, -1733.6282132, -2954.6282132]],

         [[ 1827.3717868, -2837.6282132, -3371.6282132, ...,
             252.3717868, -2759.6282132,  -323.6282132],
          [ 2052.3717868,  3225.3717868,   -23.6282132, ...,
            2166.3717868,   636.3717868,  2487.3717868],
          [ 3057.3717868,  1809.3717868, -1481.6282132, ...,
            1080.3717868, -3083.6282132, -2852.6282132],
          ...,
          [ 2850.3717868, -3314.6282132, -1439.6282132, ...,
           -2645.6282132,  3012.3717868,  2400.3717868],
          [-1190.6282132, -1220.6282132,  1860.3717868, ...,
            1425.3717868,  -278.6282132, -1802.6282132],
          [ -791.6282132, -2201.6282132,  -428.6282132, ...,
           -1466.6282132,   420.3717868,  3201.3717868]],

         [[ -671.6282132,   678.3717868, -2156.6282132, ...,
           -3329.6282132, -1316.6282132,   570.3717868],
          [-3224.6282132, -3386.6282132,  1446.3717868, ...,
             735.3717868, -1145.6282132,  1704.3717868],
          [ 2985.3717868,  2814.3717868,  2058.3717868, ...,
           -2099.6282132,  1191.3717868, -2624.6282132],
          ...,
          [ 3078.3717868, -1895.6282132,  -857.6282132, ...,
            2745.3717868,   429.3717868,   954.3717868],
          [ 1146.3717868, -2612.6282132,  2442.3717868, ...,
              63.3717868,  1638.3717868,  1437.3717868],
          [ 2838.3717868, -2093.6282132,   771.3717868, ...,
           -2774.6282132,  2445.3717868, -2240.6282132]]],


        [[[ -743.6282132, -2558.6282132,  2124.3717868, ...,
           -1127.6282132, -1919.6282132,  1518.3717868],
          [ 2757.3717868,  1200.3717868, -1076.6282132, ...,
             465.3717868, -2273.6282132,  3069.3717868],
          [ 2931.3717868,  -206.6282132, -1484.6282132, ...,
             315.3717868, -2006.6282132,   321.3717868],
          ...,
          [ 2583.3717868,  2571.3717868,   945.3717868, ...,
            3453.3717868,  1728.3717868, -1283.6282132],
          [-3437.6282132, -1595.6282132,  1497.3717868, ...,
            1404.3717868,  3330.3717868,  -224.6282132],
          [-1682.6282132, -3152.6282132,  1047.3717868, ...,
            2331.3717868,  3021.3717868,    30.3717868]],

         [[ -665.6282132, -3317.6282132, -1367.6282132, ...,
             150.3717868,  2589.3717868,  1566.3717868],
          [-1340.6282132, -2318.6282132,  1359.3717868, ...,
             540.3717868,  -887.6282132,  2943.3717868],
          [-1724.6282132,  2316.3717868,  -524.6282132, ...,
           -3350.6282132, -2219.6282132,  1725.3717868],
          ...,
          [-2297.6282132, -1409.6282132,  1920.3717868, ...,
            1155.3717868,   -29.6282132, -3326.6282132],
          [-1727.6282132, -3293.6282132,  2616.3717868, ...,
            2883.3717868,  -473.6282132, -2084.6282132],
          [ -173.6282132, -1154.6282132, -3419.6282132, ...,
            1917.3717868,  -356.6282132, -1808.6282132]],

         [[ 3132.3717868,  1203.3717868,  2667.3717868, ...,
            1974.3717868,  1500.3717868,  2508.3717868],
          [ -644.6282132,  -362.6282132,  -296.6282132, ...,
           -2615.6282132, -2414.6282132,  2073.3717868],
          [-1436.6282132,  1026.3717868,  -605.6282132, ...,
           -2993.6282132,  3420.3717868,   882.3717868],
          ...,
          [ 1560.3717868, -1790.6282132,   984.3717868, ...,
           -2354.6282132,   282.3717868,  1197.3717868],
          [-2054.6282132,   198.3717868, -2594.6282132, ...,
             237.3717868,  3231.3717868,  1269.3717868],
          [   99.3717868, -1745.6282132,   264.3717868, ...,
           -1289.6282132,   630.3717868, -2534.6282132]],

         [[ 2307.3717868, -1850.6282132,  2610.3717868, ...,
           -3104.6282132, -1205.6282132, -1613.6282132],
          [-1430.6282132,  1947.3717868, -2750.6282132, ...,
           -2183.6282132,  1416.3717868,  1737.3717868],
          [-2792.6282132,   246.3717868, -2618.6282132, ...,
            -716.6282132, -2639.6282132, -3134.6282132],
          ...,
          [  303.3717868,  3324.3717868,   939.3717868, ...,
             474.3717868,  -707.6282132,  2034.3717868],
          [-1853.6282132,   183.3717868,  1164.3717868, ...,
            1173.3717868,  3186.3717868,   993.3717868],
          [ 2967.3717868, -3029.6282132,  2763.3717868, ...,
            1125.3717868, -1226.6282132, -1559.6282132]],

         [[  591.3717868,  1599.3717868, -1475.6282132, ...,
            -218.6282132,  -818.6282132, -3068.6282132],
          [ 2472.3717868, -1493.6282132,   -41.6282132, ...,
            1668.3717868,  -269.6282132, -2231.6282132],
          [ 1845.3717868,  1350.3717868,  1605.3717868, ...,
             318.3717868, -1814.6282132, -3323.6282132],
          ...,
          [ 2367.3717868, -1928.6282132,  3027.3717868, ...,
            -764.6282132,  2193.3717868,  -983.6282132],
          [  594.3717868,  1731.3717868,  2934.3717868, ...,
             690.3717868,  2133.3717868,  1830.3717868],
          [  423.3717868,   558.3717868,   390.3717868, ...,
            -587.6282132,  -800.6282132, -1835.6282132]]],


        [[[  624.3717868, -3200.6282132,  1779.3717868, ...,
            1218.3717868,  1695.3717868, -1655.6282132],
          [-2144.6282132,   990.3717868,  1008.3717868, ...,
             180.3717868, -1916.6282132, -1445.6282132],
          [ 2136.3717868,  -803.6282132,  2538.3717868, ...,
            2646.3717868, -3035.6282132,   210.3717868],
          ...,
          [-2969.6282132, -1946.6282132,  1332.3717868, ...,
             243.3717868, -2597.6282132,  -569.6282132],
          [-2021.6282132,  1182.3717868,  -890.6282132, ...,
            3234.3717868, -1358.6282132, -3302.6282132],
          [ 1710.3717868, -2249.6282132,  1665.3717868, ...,
           -1004.6282132, -1997.6282132,   -20.6282132]],

         [[-3251.6282132, -3206.6282132,  -251.6282132, ...,
            2499.3717868,   -14.6282132,   345.3717868],
          [-1280.6282132, -1532.6282132,  -128.6282132, ...,
           -2441.6282132, -2162.6282132,  2790.3717868],
          [  675.3717868,  -734.6282132, -2687.6282132, ...,
             855.3717868, -1922.6282132,  3054.3717868],
          ...,
          [ 2094.3717868,  3336.3717868, -1634.6282132, ...,
            1902.3717868, -2891.6282132,  -914.6282132],
          [ 2691.3717868,  -395.6282132,  2688.3717868, ...,
           -2978.6282132,   999.3717868,  1719.3717868],
          [ 1629.3717868, -1442.6282132,   108.3717868, ...,
           -3257.6282132,   -38.6282132, -2783.6282132]],

         [[  138.3717868,  -236.6282132,  1401.3717868, ...,
             408.3717868, -1250.6282132,    96.3717868],
          [  774.3717868,  2463.3717868,  2199.3717868, ...,
            1431.3717868,  -641.6282132,  -926.6282132],
          [ 1122.3717868,  2718.3717868,  1524.3717868, ...,
           -1112.6282132, -2141.6282132, -3404.6282132],
          ...,
          [ 2343.3717868,   -98.6282132,  -389.6282132, ...,
             -71.6282132, -1754.6282132,   213.3717868],
          [  378.3717868,  2754.3717868,   840.3717868, ...,
            1272.3717868,   504.3717868, -2897.6282132],
          [-1649.6282132,   834.3717868,  3378.3717868, ...,
             702.3717868,  2910.3717868,   852.3717868]],

         [[-2138.6282132, -2696.6282132,    -8.6282132, ...,
            2658.3717868,  2286.3717868,  -899.6282132],
          [ 1086.3717868, -3407.6282132,  2550.3717868, ...,
             543.3717868,  1275.3717868,  2448.3717868],
          [ 2361.3717868, -1844.6282132,  1770.3717868, ...,
            -695.6282132,  -404.6282132,  1344.3717868],
          ...,
          [ -698.6282132,  2220.3717868, -2030.6282132, ...,
             582.3717868,  2817.3717868,  -509.6282132],
          [ 2223.3717868,  2310.3717868, -1211.6282132, ...,
           -2147.6282132,  1476.3717868,  1305.3717868],
          [ 2973.3717868,  -434.6282132,  1986.3717868, ...,
           -2714.6282132, -1091.6282132,   324.3717868]],

         [[ -821.6282132, -2729.6282132,  2775.3717868, ...,
            1959.3717868, -1424.6282132,   870.3717868],
          [ 1494.3717868,  3207.3717868,   588.3717868, ...,
            3015.3717868,  -536.6282132,   114.3717868],
          [-2027.6282132,  2295.3717868, -2189.6282132, ...,
            1386.3717868,  1233.3717868,   249.3717868],
          ...,
          [ -260.6282132,  -482.6282132, -1625.6282132, ...,
           -1013.6282132,   918.3717868,   333.3717868],
          [-2606.6282132,  2160.3717868,  -293.6282132, ...,
            3357.3717868,  -305.6282132,  1659.3717868],
          [-3044.6282132,  2466.3717868,  1803.3717868, ...,
            3150.3717868, -1676.6282132,  1176.3717868]]]],



       [[[[-3236.6282132, -3062.6282132,  2088.3717868, ...,
            2100.3717868,    84.3717868,  -164.6282132],
          [ 1101.3717868,  -437.6282132,  2430.3717868, ...,
            3123.3717868,  2406.3717868, -2633.6282132],
          [  888.3717868,   441.3717868,   681.3717868, ...,
           -2477.6282132,  3387.3717868,  2298.3717868],
          ...,
          [-2465.6282132,  -575.6282132,  2274.3717868, ...,
            3429.3717868, -1796.6282132,  3282.3717868],
          [  522.3717868,  2238.3717868,  3105.3717868, ...,
            3246.3717868,  1662.3717868,  3270.3717868],
          [ 1083.3717868,  1743.3717868,  2388.3717868, ...,
           -1088.6282132,   936.3717868, -1499.6282132]],

         [[-2948.6282132,   393.3717868,  -581.6282132, ...,
            3402.3717868,  2853.3717868,  -419.6282132],
          [-2786.6282132,   585.3717868,  3327.3717868, ...,
           -1139.6282132, -1337.6282132,  2796.3717868],
          [ 2232.3717868, -1172.6282132,  2064.3717868, ...,
           -3080.6282132,  3114.3717868,  1095.3717868],
          ...,
          [ 3297.3717868, -2369.6282132, -1604.6282132, ...,
           -1508.6282132,  1857.3717868, -1352.6282132],
          [-2495.6282132,  2355.3717868, -2627.6282132, ...,
             900.3717868,  1953.3717868,  2454.3717868],
          [-3368.6282132,   837.3717868, -3170.6282132, ...,
            -563.6282132,  -101.6282132,  -197.6282132]],

         [[ 3102.3717868,   516.3717868, -2642.6282132, ...,
            2565.3717868,  1713.3717868,  -359.6282132],
          [ 1098.3717868,  -344.6282132,  -749.6282132, ...,
           -1670.6282132,  2574.3717868,  2313.3717868],
          [ 1185.3717868,  1254.3717868,   975.3717868, ...,
            1092.3717868,  -290.6282132, -2009.6282132],
          ...,
          [-1763.6282132, -1871.6282132,  1674.3717868, ...,
           -2360.6282132, -1910.6282132, -2258.6282132],
          [  777.3717868, -2330.6282132, -1406.6282132, ...,
           -1118.6282132, -2585.6282132, -2018.6282132],
          [-1760.6282132,  -761.6282132,  2148.3717868, ...,
           -2087.6282132,  3318.3717868,  2652.3717868]],

         [[ 2340.3717868,   -47.6282132, -1328.6282132, ...,
            -584.6282132, -1523.6282132,  2826.3717868],
          [  414.3717868,  3462.3717868, -1952.6282132, ...,
            -407.6282132, -2288.6282132,  1632.3717868],
          [  426.3717868,  1680.3717868,   621.3717868, ...,
            3306.3717868, -1505.6282132, -3125.6282132],
          ...,
          [ 1989.3717868, -2066.6282132,  2115.3717868, ...,
            2433.3717868,   -11.6282132,  -932.6282132],
          [ 1899.3717868, -3047.6282132,   -53.6282132, ...,
             816.3717868, -2489.6282132,  1434.3717868],
          [ 2085.3717868,  3219.3717868,  2886.3717868, ...,
           -2444.6282132, -1106.6282132,  2346.3717868]],

         [[-1781.6282132,  2559.3717868,  -413.6282132, ...,
           -1793.6282132,   171.3717868, -1865.6282132],
          [ 2187.3717868, -2831.6282132,  -608.6282132, ...,
           -1487.6282132,  1689.3717868,  1992.3717868],
          [-3362.6282132,  3285.3717868, -1097.6282132, ...,
             156.3717868,  2706.3717868,  2547.3717868],
          ...,
          [ 2982.3717868,  -380.6282132,  2829.3717868, ...,
            -962.6282132, -2033.6282132,  2958.3717868],
          [-3098.6282132,  1284.3717868,  1617.3717868, ...,
            1794.3717868,  -998.6282132,   756.3717868],
          [ 2289.3717868,  1329.3717868, -1391.6282132, ...,
           -2738.6282132,  -494.6282132, -2768.6282132]]],


        [[[ 1824.3717868, -1700.6282132,  2403.3717868, ...,
           -1826.6282132,  2781.3717868,  -938.6282132],
          [ -350.6282132,  1287.3717868,  -212.6282132, ...,
           -2264.6282132,  -986.6282132,  -353.6282132],
          [-1529.6282132,   765.3717868, -3389.6282132, ...,
           -1238.6282132,  2511.3717868,  2169.3717868],
          ...,
          [ 1413.3717868, -2723.6282132, -2309.6282132, ...,
            2301.3717868, -1157.6282132,  2778.3717868],
          [ -902.6282132,  2151.3717868,   195.3717868, ...,
            2925.3717868,  1239.3717868,  -590.6282132],
          [ -233.6282132,  1911.3717868, -1007.6282132, ...,
           -2321.6282132,    36.3717868,  2604.3717868]],

         [[ 3183.3717868,  -425.6282132, -3269.6282132, ...,
            -449.6282132,  1545.3717868, -1469.6282132],
          [ 1977.3717868, -2261.6282132, -2198.6282132, ...,
             270.3717868,   843.3717868, -2933.6282132],
          [ 1905.3717868,  3333.3717868,  2700.3717868, ...,
            1224.3717868, -2711.6282132,   576.3717868],
          ...,
          [ 2811.3717868,  3087.3717868,  2937.3717868, ...,
             294.3717868,  3141.3717868,    54.3717868],
          [ 1764.3717868,  -548.6282132,   693.3717868, ...,
           -3002.6282132,  2904.3717868, -2159.6282132],
          [ -974.6282132, -1820.6282132,  -944.6282132, ...,
            3120.3717868,  -677.6282132, -2045.6282132]],

         [[ 1131.3717868, -2174.6282132,  2952.3717868, ...,
            2568.3717868,  -884.6282132, -1460.6282132],
          [-3344.6282132,  1071.3717868,  2868.3717868, ...,
            1029.3717868, -2690.6282132,   -17.6282132],
          [ 1308.3717868,   300.3717868, -2492.6282132, ...,
            3030.3717868, -3095.6282132,  -533.6282132],
          ...,
          [  762.3717868,  3045.3717868,  -593.6282132, ...,
            -272.6282132,  2013.3717868,  1782.3717868],
          [ 2496.3717868,   177.3717868,  -623.6282132, ...,
            -131.6282132, -1463.6282132, -2702.6282132],
          [ 2760.3717868,   903.3717868,  2766.3717868, ...,
             891.3717868,   786.3717868,   105.3717868]],

         [[ 3006.3717868,  2871.3717868,   144.3717868, ...,
             192.3717868,  2577.3717868, -2042.6282132],
          [ -539.6282132,  -119.6282132,  -911.6282132, ...,
           -2861.6282132, -2747.6282132,  -383.6282132],
          [-1811.6282132,  2376.3717868,  -773.6282132, ...,
            -221.6282132,  1263.3717868,  2130.3717868],
          ...,
          [ 2685.3717868,  1161.3717868,  1362.3717868, ...,
            3075.3717868,   -77.6282132, -1988.6282132],
          [ 3459.3717868, -3056.6282132,  -476.6282132, ...,
           -2216.6282132,   912.3717868,  1614.3717868],
          [-2648.6282132,  1371.3717868,  -701.6282132, ...,
            1248.3717868, -2516.6282132,  2862.3717868]],

         [[-2663.6282132, -1412.6282132,   948.3717868, ...,
            2844.3717868,   489.3717868,  -416.6282132],
          [-2603.6282132,   597.3717868, -2000.6282132, ...,
             453.3717868,  1602.3717868, -1178.6282132],
          [-3014.6282132,  -257.6282132,  1746.3717868, ...,
           -2741.6282132,  -614.6282132, -2921.6282132],
          ...,
          [-1502.6282132,  1878.3717868, -2180.6282132, ...,
            2721.3717868, -3320.6282132,  3450.3717868],
          [ 1935.3717868,  3138.3717868, -3440.6282132, ...,
           -1949.6282132, -1589.6282132, -1376.6282132],
          [ 3156.3717868,  1152.3717868, -2126.6282132, ...,
            2229.3717868, -2930.6282132,    42.3717868]]],


        [[[-2399.6282132,   135.3717868, -1016.6282132, ...,
            -896.6282132, -1718.6282132, -2060.6282132],
          [ -785.6282132,   930.3717868, -3392.6282132, ...,
            2880.3717868, -1193.6282132, -2828.6282132],
          [-1592.6282132, -3431.6282132,  2283.3717868, ...,
            1407.3717868, -2342.6282132, -1526.6282132],
          ...,
          [-3281.6282132,   411.3717868,   714.3717868, ...,
            1449.3717868, -2945.6282132, -3032.6282132],
          [ 3222.3717868,    69.3717868,  -806.6282132, ...,
            -929.6282132,  -368.6282132,  -302.6282132],
          [  618.3717868, -2825.6282132, -1943.6282132, ...,
            -635.6282132, -1244.6282132,  1635.3717868]],

         [[-2810.6282132,  2106.3717868,  1059.3717868, ...,
             804.3717868,  3354.3717868, -1073.6282132],
          [ -719.6282132, -2855.6282132,  2637.3717868, ...,
           -2426.6282132,  1749.3717868, -1631.6282132],
          [-1286.6282132, -2378.6282132,   987.3717868, ...,
             564.3717868,   450.3717868,  1023.3717868],
          ...,
          [ 1776.3717868,  1107.3717868,  1473.3717868, ...,
            2901.3717868,   147.3717868, -2291.6282132],
          [  372.3717868,  2172.3717868, -1688.6282132, ...,
            1290.3717868,   -68.6282132,   327.3717868],
          [-2102.6282132, -2453.6282132,   696.3717868, ...,
           -1709.6282132,  2523.3717868, -2753.6282132]],

         [[  444.3717868,  2865.3717868,  -737.6282132, ...,
           -1229.6282132,  1389.3717868,  3018.3717868],
          [ 3414.3717868, -2108.6282132,  -116.6282132, ...,
           -3464.6282132,  3423.3717868,  1458.3717868],
          [-3233.6282132,   966.3717868, -3194.6282132, ...,
           -2192.6282132, -2459.6282132,  2175.3717868],
          ...,
          [ 1893.3717868,  2001.3717868, -2057.6282132, ...,
            3399.3717868, -1976.6282132, -3275.6282132],
          [-1610.6282132,   -83.6282132, -1400.6282132, ...,
             267.3717868,  -431.6282132,  1035.3717868],
          [ -710.6282132, -2447.6282132,  3210.3717868, ...,
            1653.3717868,    75.3717868,  2607.3717868]],

         [[ 1896.3717868,   258.3717868,   792.3717868, ...,
            -656.6282132,  3372.3717868, -2780.6282132],
          [-2798.6282132,  1683.3717868,  1116.3717868, ...,
           -2651.6282132,  -755.6282132,  3396.3717868],
          [ -953.6282132,   162.3717868,  2493.3717868, ...,
            -137.6282132, -3176.6282132, -1046.6282132],
          ...,
          [ -464.6282132,  2322.3717868,  2787.3717868, ...,
             759.3717868,  1563.3717868,  2079.3717868],
          [ 1299.3717868, -2726.6282132, -3059.6282132, ...,
           -1694.6282132, -1208.6282132,  1278.3717868],
          [-2243.6282132,   726.3717868,  2364.3717868, ...,
           -3311.6282132, -1019.6282132, -2390.6282132]],

         [[ 1515.3717868,  1854.3717868, -3305.6282132, ...,
             972.3717868,  -827.6282132,  -554.6282132],
          [ 2019.3717868,  -341.6282132, -1766.6282132, ...,
            1938.3717868, -1373.6282132,  3213.3717868],
          [ 2643.3717868, -1217.6282132,  1965.3717868, ...,
            2517.3717868,  2748.3717868, -3380.6282132],
          ...,
          [-2795.6282132,   285.3717868,  -596.6282132, ...,
            1119.3717868, -2081.6282132,  2679.3717868],
          [-1514.6282132,   753.3717868,   -62.6282132, ...,
            2913.3717868, -3185.6282132,  -824.6282132],
          [  639.3717868,  3099.3717868,    57.3717868, ...,
             894.3717868, -2609.6282132,  1053.3717868]]]]])], '\nThe value of eps is:', 0.01, '\nThe out_type is:', None)

======================================================================
ERROR: test_topk_1d_08 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (16,) 

======================================================================
ERROR: test_topk_1d_09 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (16,) 

======================================================================
ERROR: test_topk_1d_10 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (16,) 

======================================================================
ERROR: test_topk_1d_11 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (16,) 

======================================================================
ERROR: test_topk_1d_12 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (8,) (16,) 

======================================================================
ERROR: test_topk_1d_13 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (8,) (16,) 

======================================================================
ERROR: test_topk_1d_14 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (8,) (16,) 

======================================================================
ERROR: test_topk_1d_15 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (8,) (16,) 

======================================================================
ERROR: test_topk_1d_16 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_17 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_18 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_19 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_20 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(float64, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(8,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_21 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(float16, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(2,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_22 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(int16, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(2,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_23 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=16) out of bounds (16)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-16})
Toposort index: 0
Inputs types: [TensorType(int8, vector), TensorType(int8, scalar)]
Inputs shapes: [(16,), ()]
Inputs strides: [(1,), ()]
Inputs values: ['not shown', array(-16, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_24 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_25 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_26 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_27 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (15,) (16,) 

======================================================================
ERROR: test_topk_1d_36 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (61,) 

======================================================================
ERROR: test_topk_1d_37 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (61,) 

======================================================================
ERROR: test_topk_1d_38 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (61,) 

======================================================================
ERROR: test_topk_1d_39 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (61,) 

======================================================================
ERROR: test_topk_1d_40 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (30,) (61,) 

======================================================================
ERROR: test_topk_1d_41 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (30,) (61,) 

======================================================================
ERROR: test_topk_1d_42 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (30,) (61,) 

======================================================================
ERROR: test_topk_1d_43 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (30,) (61,) 

======================================================================
ERROR: test_topk_1d_44 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_45 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_46 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_47 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_48 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(float64, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(8,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_49 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(float16, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(2,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_50 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(int16, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(2,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_51 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=61) out of bounds (61)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-61})
Toposort index: 0
Inputs types: [TensorType(int8, vector), TensorType(int8, scalar)]
Inputs shapes: [(61,), ()]
Inputs strides: [(1,), ()]
Inputs values: ['not shown', array(-61, dtype=int8)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_52 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_53 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_54 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_55 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (60,) (61,) 

======================================================================
ERROR: test_topk_1d_64 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (257,) 

======================================================================
ERROR: test_topk_1d_65 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (257,) 

======================================================================
ERROR: test_topk_1d_66 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (257,) 

======================================================================
ERROR: test_topk_1d_67 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (10,) (257,) 

======================================================================
ERROR: test_topk_1d_68 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (128,) (257,) 

======================================================================
ERROR: test_topk_1d_69 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (128,) (257,) 

======================================================================
ERROR: test_topk_1d_70 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (128,) (257,) 

======================================================================
ERROR: test_topk_1d_71 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (128,) (257,) 

======================================================================
ERROR: test_topk_1d_72 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_73 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_74 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_75 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_76 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(float64, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(8,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_77 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(float16, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(2,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_78 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(int16, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(2,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_79 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 299, in test_topk_1d
    yval = fn(xval)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 417, in perform
    pzv[0] = _topk_py_impl(self, x, k, axis, None)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\sort.py", line 282, in _topk_py_impl
    zv = np.partition(x, -k, axis=axis)[idx]
  File "<__array_function__ internals>", line 6, in partition
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\fromnumeric.py", line 746, in partition
    a.partition(kth, axis=axis, kind=kind, order=order)
ValueError: kth(=257) out of bounds (257)
Apply node that caused the error: TopKOp{axis=-1, sorted=False}(x, TensorConstant{-257})
Toposort index: 0
Inputs types: [TensorType(int8, vector), TensorType(int16, scalar)]
Inputs shapes: [(257,), ()]
Inputs strides: [(1,), ()]
Inputs values: ['not shown', array(-257, dtype=int16)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 291, in test_topk_1d
    y = topk(x, k, sorted=sorted)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_topk_1d_80 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_81 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_82 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_83 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (256,) (257,) 

======================================================================
ERROR: test_topk_1d_84 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 304, in test_topk_1d
    utt.assert_allclose(goal, np.sort(yval))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 357, in assert_allclose
    if not T.basic._allclose(expected, value, rtol, atol):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 347, in _allclose
    return np.allclose(a, b, atol=atol_, rtol=rtol_)
  File "<__array_function__ internals>", line 6, in allclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2159, in allclose
    res = all(isclose(a, b, rtol=rtol, atol=atol, equal_nan=equal_nan))
  File "<__array_function__ internals>", line 6, in isclose
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2260, in isclose
    return within_tol(x, y, atol, rtol)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\core\numeric.py", line 2246, in within_tol
    return less_equal(abs(x-y), atol + rtol * abs(y))
ValueError: operands could not be broadcast together with shapes (1337,) (2049,) 

======================================================================
FAIL: test_argtopk_1d_08 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_09 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_10 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_11 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_12 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_13 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_14 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_15 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_16 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_17 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_18 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_19 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_32 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_33 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_34 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_35 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_36 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_37 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_38 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_39 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_40 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_41 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_42 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_43 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_56 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_57 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_58 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_59 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_60 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_61 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_62 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_63 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_64 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_65 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_66 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_67 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_1d_72 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 333, in test_argtopk_1d
    assert np.all(xval[np.sort(yval)] == xval[np.sort(goal)])
AssertionError

======================================================================
FAIL: test_argtopk_nd_04 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_05 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_06 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_07 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_12 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_13 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_14 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_15 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_20 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_21 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_22 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_23 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_28 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_29 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_30 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_31 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_36 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_37 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_38 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_39 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_44 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_45 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_46 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_argtopk_nd_47 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 421, in test_argtopk_nd
    assert np.all(np.sort(yval, axis=axis) == np.sort(goal, axis=axis))
AssertionError

======================================================================
FAIL: test_combined_1d_08 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_09 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_10 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_11 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_12 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_13 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_14 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_15 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_16 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_17 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_18 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_19 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_20 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_21 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_22 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_23 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_32 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_33 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_34 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_35 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_36 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_37 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_38 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_39 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_40 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_41 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_42 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_43 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_44 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_45 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_46 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_47 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_56 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_57 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_58 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_59 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_60 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_61 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_62 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_63 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_64 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_65 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_66 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_67 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_68 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_69 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_70 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_71 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_1d_72 (test_sort.Test_TopK)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 359, in test_combined_1d
    assert np.all(xval[np.sort(yival)] == xval[np.sort(goali)])
AssertionError

======================================================================
FAIL: test_combined_infer_shape_01 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((2, 3), array([2, 2], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_02 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((2, 3), array([2, 2], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_05 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((15, 17), array([ 8, 17], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_06 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((15, 17), array([14, 17], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_09 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((11, 7, 5), array([6, 7, 5], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_10 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((11, 7, 5), array([10,  7,  5], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_13 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((2, 3, 5, 7, 11), array([ 2,  2,  5,  7, 11], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_14 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((2, 3, 5, 7, 11), array([ 2,  2,  5,  7, 11], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_17 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((2, 4, 3, 1), array([2, 2, 3, 1], dtype=int64))

======================================================================
FAIL: test_combined_infer_shape_18 (test_sort.TopKInferShapeTester)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\parameterized\parameterized.py", line 530, in standalone_func
    return func(*(a + p.args), **p.kwargs)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_sort.py", line 467, in test_combined_infer_shape
    [x], [yv, yi], [xval], TopKOp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 274, in _compile_and_check
    assert np.all(out.shape == shape), (out.shape, shape)
AssertionError: ((2, 4, 3, 1), array([2, 3, 3, 1], dtype=int64))

----------------------------------------------------------------------
Ran 918 tests in 35.373s

FAILED (failures=120, errors=108)
