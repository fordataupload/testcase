ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x00000215CF572710>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\fg.py", line 546, in attach_feature
    attach(self)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1322, in on_import
    self.init_r(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in <listcomp>
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', x)

.ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x00000215CF572710>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\fg.py", line 546, in attach_feature
    attach(self)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1322, in on_import
    self.init_r(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in <listcomp>
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', x)

.ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x00000215CF572710>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\fg.py", line 546, in attach_feature
    attach(self)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1322, in on_import
    self.init_r(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in <listcomp>
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', x)

ERROR (theano.gof.opt): SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x00000215CF572710>
ERROR (theano.gof.opt): Traceback:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 93, in optimize
    self.add_requirements(fgraph)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1488, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\fg.py", line 546, in attach_feature
    attach(self)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1305, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1322, in on_import
    self.init_r(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1276, in init_r
    self.set_shape(r, self.shape_tuple(r))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in shape_tuple
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1031, in <listcomp>
    return tuple([self.shape_ir(i, r) for i in xrange(r.ndim)])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1019, in shape_ir
    s = Shape_i(i)(r)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\ops.py", line 369, in make_node
    raise TypeError('x must be Variable with ndim attribute', x)
TypeError: ('x must be Variable with ndim attribute', x)

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(FromFunctionOp{cumprod_plus}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: FromFunctionOp{cumprod_plus}.0

ERROR (theano.gof.opt): Optimization failure due to: local_shape_to_shape_i
ERROR (theano.gof.opt): node: Shape(FromFunctionOp{cumprod_plus}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1890, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 1281, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: FromFunctionOp{cumprod_plus}.0

F.
======================================================================
FAIL: test_infer_shape (test_ops.OpDecoratorTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_ops.py", line 70, in test_infer_shape
    cumprod_plus.__class__, warn=False)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 267, in _compile_and_check
    assert not any(isinstance(t.op, cls) for t in topo_shape)
AssertionError

----------------------------------------------------------------------
Ran 4 tests in 1.531s

FAILED (failures=1)
