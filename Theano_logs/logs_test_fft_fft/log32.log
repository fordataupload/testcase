E.EE.EE
======================================================================
ERROR: test_1Drfft (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\fft.py", line 37, in perform
    A = np.fft.rfftn(a, s=tuple(s))
  File "<__array_function__ internals>", line 6, in rfftn
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\fft\_pocketfft.py", line 1124, in rfftn
    a = rfft(a, s[-1], axes[-1], norm)
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 35, in test_1Drfft
    res_rfft = f_rfft(inputs_val)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\fft.py", line 37, in perform
    A = np.fft.rfftn(a, s=tuple(s))
  File "<__array_function__ internals>", line 6, in rfftn
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\fft\_pocketfft.py", line 1124, in rfftn
    a = rfft(a, s[-1], axes[-1], norm)
IndexError: list index out of range
Apply node that caused the error: RFFTOp(x, TensorConstant{[]})
Toposort index: 0
Inputs types: [TensorType(float64, matrix), TensorType(int64, vector)]
Inputs shapes: [(1, 16), (0,)]
Inputs strides: [(128, 8), (8,)]
Inputs values: ['not shown', array([], dtype=int64)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 33, in test_1Drfft
    rfft = fft.rfft(x)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_irfft (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 92, in test_irfft
    utt.assert_allclose(inputs_val, np.asarray(res_irfft))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (1, 16, 16) float64 (2048, 128, 8) 0.0077381629878782165 0.9936703648395476 0 0 
  Value    : (1, 16, 16) float64 (2048, 128, 8) -0.17121278831318945 0.6103755395002071 0 0 
  expected    : [[[0.1353494  0.27341393 0.03542599 0.42413226 0.13289948 0.82478808
   0.17857838 0.43939735 0.06645644 0.24663563 0.79493822 0.52490979
   0.34045301 0.53797646 0.75975521 0.30765969]
  [0.43699149 0.70807541 0.90023554 0.86306702 0.08405289 0.57291703
   0.40535822 0.54225641 0.02076264 0.92698558 0.42561029 0.01621585
   0.29405    0.67385457 0.392127   0.86358335]
  [0.84178091 0.62572733 0.39392474 0.95226946 0.92248482 0.09590177
   0.40544916 0.09754673 0.57960793 0.44384025 0.15601776 0.55353505
   0.34606006 0.74474487 0.23685693 0.4342994 ]
  [0.73492532 0.31204071 0.48146642 0.79037419 0.31327322 0.6699156
   0.11374785 0.26786318 0.67601651 0.89896688 0.93110595 0.35916609
   0.9537354  0.56391595 0.8777379  0.19202416]
  [0.52299754 0.62150589 0.06079509 0.01869926 0.298045   0.50473419
   0.29961557 0.44283401 0.38418648 0.06549254 0.32960424 0.72942794
   0.55509967 0.5288396  0.20307535 0.9765716 ]
  [0.15416925 0.3708895  0.22272072 0.36039982 0.48498188 0.24948877
   0.9814008  0.9433964  0.79067807 0.67931535 0.09682639 0.262803
   0.99367036 0.71032453 0.3901081  0.56717598]
  [0.08951013 0.44073919 0.10495735 0.68183782 0.31150283 0.66919707
   0.98841389 0.3930208  0.29226331 0.46756277 0.29031652 0.84918804
   0.712163   0.34929942 0.45208028 0.42877569]
  [0.60850074 0.73609298 0.35253624 0.35601395 0.59136704 0.82312425
   0.65087742 0.57607829 0.50310554 0.09924719 0.27264032 0.03344569
   0.70604898 0.64870168 0.41037587 0.00773816]
  [0.58266509 0.74501867 0.92419115 0.09815225 0.03236548 0.106822
   0.17913859 0.17518167 0.20578784 0.3271364  0.4913322  0.48687574
   0.5032574  0.28815934 0.47458508 0.06431285]
  [0.3308476  0.48623288 0.29528988 0.37818203 0.5417532  0.40010546
   0.76240955 0.47955264 0.15861623 0.13080003 0.48172727 0.24642311
   0.92249391 0.57461442 0.07461399 0.37269671]
  [0.19748517 0.63225866 0.94114428 0.82023108 0.26307149 0.86991022
   0.39742133 0.88811711 0.71855562 0.66002236 0.97249178 0.09441107
   0.30465039 0.0762231  0.78761657 0.64670505]
  [0.96267341 0.95592698 0.86098628 0.95262915 0.04407321 0.77759974
   0.57376583 0.71569645 0.15618335 0.53053071 0.34794832 0.14246731
   0.83683726 0.39317949 0.81061229 0.61630338]
  [0.63907216 0.12253074 0.35538833 0.04429985 0.15362478 0.19122078
   0.82903655 0.96854568 0.43481821 0.31767392 0.77021078 0.28244732
   0.38467936 0.22577154 0.59839337 0.93039134]
  [0.13158445 0.31302627 0.36936329 0.86175496 0.27551035 0.8822734
   0.51128198 0.77603478 0.05065324 0.01078841 0.36965792 0.56117075
   0.29515017 0.40854509 0.2270829  0.07465744]
  [0.89673015 0.65823359 0.58300058 0.34835623 0.6598614  0.32660515
   0.69166244 0.21705726 0.71085574 0.49495187 0.85774804 0.59884657
   0.70694106 0.24421088 0.51280413 0.1258849 ]
  [0.47038107 0.39499497 0.16628639 0.48889568 0.66479674 0.33969304
   0.31799934 0.2297029  0.05338387 0.66195348 0.11347362 0.16848512
   0.9107186  0.34193589 0.46852936 0.06549789]]]
  value    : [[[ 0.48347899  0.52479423  0.44048202  0.52745594  0.36085399
    0.51901853  0.51788481  0.5095176   0.36262069  0.43511896
    0.4813531   0.36936365  0.61037554  0.45689355  0.47977215
    0.41714235]
  [-0.01195159 -0.06709157 -0.06961139  0.13073286  0.00803728
   -0.02421063 -0.08515783 -0.02255745  0.05315234 -0.01130058
    0.05391729  0.06770171 -0.01643434 -0.02019586 -0.03933646
   -0.00486768]
  [-0.05025358  0.04928428  0.03957237 -0.12058207 -0.04863756
   -0.05639611 -0.06834012 -0.0322536  -0.05820944  0.0453234
   -0.07183598 -0.08127051  0.04558784  0.06836236  0.05213503
   -0.07221221]
  [-0.08081346  0.00842186  0.00377899 -0.01628899 -0.07485119
    0.08944933  0.04812557  0.02977256 -0.05724197  0.03295929
   -0.03280003 -0.05752354  0.04300386  0.05920946  0.06106688
    0.1334119 ]
  [-0.07751884  0.05213684 -0.04095327 -0.10596358 -0.10156579
    0.03241657 -0.0049431  -0.03170127 -0.11481774 -0.09773588
    0.04028249 -0.05554045 -0.00672592 -0.02955623  0.01439163
    0.04294699]
  [-0.05075317 -0.04548895 -0.10625215 -0.05937347  0.00932261
    0.11627455 -0.08374641  0.06920944 -0.07037188 -0.03096376
    0.07126434 -0.02277784 -0.01251812  0.03650402  0.06577463
   -0.00462732]
  [-0.03012985 -0.03385365  0.02175261  0.00808532 -0.05336361
    0.08009433 -0.07135418 -0.02673727  0.06531077  0.09752275
    0.04154362  0.04810666 -0.02251954 -0.01986231  0.08605867
   -0.09116313]
  [ 0.00987888  0.01666726 -0.07837183 -0.06256346  0.10843455
    0.0355816   0.12348559  0.08071076  0.06247025 -0.07944478
   -0.11353621 -0.06101176  0.04106965  0.0671471  -0.01640133
   -0.06165252]
  [ 0.00471983 -0.00986573 -0.01562858 -0.10395866 -0.01412208
   -0.07037113 -0.02172032 -0.05680503  0.06144576 -0.05720449
    0.10147934  0.14559154 -0.12871254 -0.0824904   0.02337372
    0.07218272]
  [ 0.07817124 -0.00963048 -0.07605147 -0.00205802  0.03472782
   -0.03377682 -0.02490547 -0.07092622  0.02321972 -0.08988149
    0.11338992  0.07057198  0.01854006  0.04411556 -0.03006229
    0.02701969]
  [-0.01330042  0.03513897  0.06563872  0.12701866 -0.04997729
   -0.01144271 -0.02116323  0.0045124  -0.05077734 -0.04712619
    0.02172253  0.0279878   0.03226172  0.01438308  0.05289381
   -0.0882793 ]
  [-0.16083847 -0.10744519 -0.04565143  0.12753603 -0.06055167
    0.1476655   0.03478247 -0.00822834  0.03091622 -0.06207087
    0.09785092  0.07311297 -0.05792817 -0.06028423 -0.01586003
   -0.0515292 ]
  [ 0.05934106 -0.12644803 -0.03995003 -0.17121279 -0.09093244
   -0.07417271 -0.11962912  0.08547837 -0.03643646 -0.04094396
   -0.02659357  0.04650046 -0.02906472  0.05033981 -0.00858524
    0.03746182]
  [-0.07601798 -0.01068227 -0.06183794  0.0652319  -0.02693684
    0.02349107  0.05173794  0.14616092  0.01243011  0.07332436
   -0.0163888  -0.02021097 -0.01965582 -0.07257685  0.04693796
    0.07467373]
  [-0.01732996  0.01802939  0.00889473  0.10029944  0.08037725
    0.04665827 -0.03187626 -0.14472169 -0.09301408 -0.04806858
    0.05518368  0.00515362 -0.07934717 -0.04500197 -0.08286962
   -0.13209295]
  [ 0.0686667  -0.02055304 -0.01038536 -0.02022684  0.05208443
    0.00450845 -0.06460195 -0.09203384 -0.12424048  0.12712745
   -0.02189441 -0.03084554 -0.07747933  0.07098935  0.0704657
    0.00924482]]]
  Max Abs Diff:  1.12351188069811
  Mean Abs Diff:  0.46657222944675547
  Median Abs Diff:  0.4232752390248313
  Std Abs Diff:  0.2705614177690551
  Max Rel Diff:  11.433865372966299
  Mean Rel Diff:  1.1960576792694821
  Median Rel Diff:  1.0202077593045846
  Std Rel Diff:  1.0566738568859924

  rtol, atol: 1e-05 1e-08


======================================================================
ERROR: test_norm_rfft (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 119, in test_norm_rfft
    utt.assert_allclose(rfft_ref / N, res_rfft_comp, atol=1e-4, rtol=1e-4)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (1, 16, 9) complex128 (16, 16, 256) (-0.5034835077894021+0.20288178950031105j) (8.356485283097623+0j) 0 0 
  Value    : (1, 16, 9) complex128 (2304, 144, 16) (-0.9376789808308922+0j) (2.567016936422501+0j) 0 0 
  expected    : [[[ 8.35648528e+00+0.j          1.62786801e-01-0.03897992j
    1.63245195e-01+0.12712463j  1.22407399e-01+0.40657787j
    6.31641318e-02-0.06578449j  9.59192585e-02+0.08166181j
    1.94613706e-01+0.28595361j  1.40770240e-01+0.12949072j
   -2.45182377e-01+0.j        ]
  [ 1.62542160e-01+0.07149381j  7.74357877e-02+0.18804654j
   -1.15194091e-01+0.35570729j  2.41140650e-01-0.1199571j
   -6.76613176e-02+0.03561281j  2.88375868e-01+0.27887119j
    1.68190288e-01+0.3852786j  -4.23340797e-02-0.10215022j
   -4.53639129e-02+0.51172057j]
  [-1.84740112e-02-0.04229543j  2.24254520e-01-0.09705774j
   -2.43133745e-01+0.06036276j -3.49683456e-01+0.12582105j
   -3.10796547e-01+0.12184727j -1.57060461e-01-0.06671376j
    1.56551230e-01-0.09059721j -3.07619105e-01-0.00390685j
    7.10256910e-02-0.07904892j]
  [-1.54497902e-01-0.01794348j -2.22465609e-01-0.08357788j
    3.27633974e-01+0.09374233j -1.78375189e-01-0.25271634j
   -6.80147749e-02-0.24378246j -2.04979517e-01-0.08983768j
   -2.18712728e-02+0.41211115j  8.76743089e-01+0.0345244j
   -1.10073326e-01-0.26163348j]
  [ 4.73585053e-01+0.15892512j  1.21775269e-01-0.12472841j
   -2.20354802e-01-0.08354206j  1.79958373e-01-0.27760883j
   -9.09152553e-02+0.04621126j -7.70745703e-02+0.1685538j
   -2.01342841e-01-0.02192611j  1.69815011e-01+0.06815003j
   -1.90409790e-02-0.34139324j]
  [-4.22678321e-01+0.04865657j  9.53437502e-02+0.13343438j
    2.08107448e-02+0.13865849j -8.23460925e-02+0.04193956j
    2.28509558e-01-0.0139267j   6.13995799e-01-0.0747192j
   -3.42439086e-01+0.06481405j  2.09672737e-01-0.06283025j
    4.37591514e-03+0.16138729j]
  [-1.22659846e-01+0.08352359j -1.62704672e-01+0.25736636j
    2.20069726e-01-0.00252331j -8.43631941e-02+0.08376128j
    1.12108440e-01-0.20918922j  2.20800157e-01-0.00233791j
    1.83665990e-01+0.06761515j -2.08274482e-01-0.17189864j
    3.57379188e-01-0.19088756j]
  [-1.38519761e-01-0.36154689j  1.96135944e-01-0.22892434j
    3.79840016e-02-0.28897248j  4.01756773e-01+0.06318749j
    1.54168960e-01-0.07324504j  1.95004207e-01+0.12016994j
    2.12844718e-01-0.08418401j  8.80976435e-02-0.23602068j
   -3.25617687e-03-0.3354762j ]
  [-3.17136869e-01+0.j         -2.15856975e-01-0.014536j
   -1.38033334e-01+0.14170602j  8.26713379e-02-0.11308486j
    2.85300829e-01-0.15072545j -7.78371936e-02-0.42879135j
   -9.12128191e-02+0.01750798j -2.41855643e-01+0.05296652j
   -7.02067409e-02+0.j        ]
  [-1.38519761e-01+0.36154689j -2.85111552e-01-0.14377681j
    1.81730517e-01-0.05596121j -1.74537623e-02-0.26563891j
    2.53361950e-01+0.12732907j  1.63523927e-01+0.41139889j
    8.80197209e-02+0.11710357j  1.79637749e-01+0.04241464j
   -3.25617687e-03+0.3354762j ]
  [-1.22659846e-01-0.08352359j  1.26648307e-01-0.14076597j
    3.20483836e-01+0.02856468j  1.94874486e-01+0.23711329j
    2.53292901e-01+0.09085789j -2.90623699e-01+0.04678494j
   -2.78938352e-01-0.00532289j  2.33503807e-01-0.00670422j
    3.57379188e-01+0.19088756j]
  [-4.22678321e-01-0.04865657j -1.06317048e-02-0.06506387j
   -5.34489011e-02-0.19141286j -2.29024109e-01-0.02882771j
    3.28963063e-01+0.27484367j  9.80558409e-02+0.16245149j
    1.09253160e-01-0.05317583j  1.53351650e-01-0.39995279j
    4.37591514e-03-0.16138729j]
  [ 4.73585053e-01-0.15892512j  4.51439488e-02+0.41626939j
    4.21282905e-02-0.45463856j -3.44631111e-01-0.05918593j
   -1.98460590e-02-0.27129939j  1.19455292e-02-0.02261593j
    1.10616844e-01-0.29388235j  1.37750221e-01+0.16736852j
   -1.90409790e-02+0.34139324j]
  [-1.54497902e-01+0.01794348j  1.13266958e-01-0.45624965j
   -1.87984654e-01-0.04109694j -5.27512457e-02-0.18594754j
    2.60124628e-02+0.03575348j -2.52846227e-02-0.29267577j
   -6.65320351e-02-0.008459j   -8.90873179e-02-0.01592516j
   -1.10073326e-01+0.26163348j]
  [-1.84740112e-02+0.04229543j -1.07996558e-01-0.1833132j
    2.65372083e-01-0.05477029j  4.32727769e-01-0.28540885j
    1.39771549e-01+0.00670093j  2.39676904e-01-0.25803267j
    7.10237136e-02+0.23566613j -2.05265128e-01-0.14269827j
    7.10256910e-02+0.07904892j]
  [ 1.62542160e-01-0.07149381j -2.19157297e-01-0.08631354j
   -3.57698953e-03-0.0044591j  -1.63576608e-01+0.03662861j
   -1.59675219e-01-0.03263054j  1.10013585e-01+0.14077738j
   -5.03483508e-01+0.20288179j -2.31768210e-01-0.23006619j
   -4.53639129e-02-0.51172057j]]]
  value    : [[[ 1.89948579e+00+0.j         -1.52832704e-02-0.16704266j
    1.54432963e-01-0.05787766j  3.83330053e-02-0.14833673j
    2.81936168e-01-0.08035673j  3.01112753e-01+0.04373629j
   -5.27601359e-02+0.30784616j  2.15784545e-01-0.21930961j
    4.86759203e-02+0.j        ]
  [ 2.34290011e+00+0.j         -9.55197781e-03+0.02319783j
   -3.05180235e-01+0.10217013j -6.64749963e-02+0.05643449j
   -2.57119066e-01-0.15977103j -6.09074588e-02+0.08726664j
   -1.50344176e-01+0.24858933j -1.29637909e-01+0.19610505j
    9.23830627e-02+0.j        ]
  [ 1.91895357e+00+0.j         -1.07823731e-01-0.00614773j
   -5.71158048e-02+0.18456712j  2.38963203e-01+0.0057883j
   -9.74138627e-02-0.0395258j  -1.44348633e-01-0.22705036j
    7.77797418e-02+0.28134088j -4.03854410e-01+0.26760869j
   -2.55035096e-01+0.j        ]
  [ 2.27004274e+00+0.j         -1.02459389e-01+0.43999361j
    1.87795570e-01-0.11520785j -1.72682736e-01+0.2000595j
    2.05273723e-01+0.01112336j  2.92691870e-01+0.34961057j
    8.87413479e-02+0.41285052j  9.25748748e-02-0.29035683j
   -7.35461908e-02+0.j        ]
  [ 2.06737618e+00+0.j         -3.79216609e-02+0.16471231j
   -3.76054078e-01-0.17755334j  4.86816085e-02+0.01330504j
   -5.40639303e-02-0.06675858j -1.22884619e-02+0.23040615j
   -5.01829528e-02-0.04230306j  2.77618702e-04+0.02866217j
   -9.37678981e-01+0.j        ]
  [ 2.27282532e+00+0.j          2.59813886e-01+0.0914126j
    1.76314584e-01-0.11568399j  1.23462062e-01+0.60621745j
   -1.74298579e-01-0.022042j   -1.95539364e-01+0.06874253j
    5.18035545e-02+0.13792289j  4.32679526e-01+0.16694694j
   -1.26502487e-02+0.j        ]
  [ 1.36802292e+00+0.j         -1.90855739e-01-0.38783328j
    1.81399838e-02+0.38634194j  1.66157972e-01+0.20795816j
    2.28720807e-01+0.11368877j -1.21400928e-01-0.21349677j
   -2.23347500e-01+0.39712168j  1.57216422e-01+0.12676015j
   -1.83556211e-01+0.j        ]
  [ 2.15020479e+00+0.j         -4.73252906e-02-0.13307094j
    3.34766103e-02+0.10693592j  4.18281023e-02+0.20090524j
    2.44239045e-01+0.19831455j  2.46842094e-01+0.23290694j
    1.62233493e-01-0.12072113j -1.95353544e-02+0.3443736j
   -3.57183785e-01+0.j        ]
  [ 2.45263961e+00+0.j          1.12308591e-01+0.20416992j
    5.04556619e-02-0.06098041j  7.86477974e-02+0.20732924j
   -6.58961729e-02-0.13533387j -3.18239791e-01-0.28448183j
    1.25248871e-01-0.210339j   -3.56372086e-01+0.26569352j
    2.02993421e-01+0.j        ]
  [ 1.87950364e+00+0.j          3.51967060e-01-0.12228792j
    5.73047271e-02-0.46321786j  9.46698319e-02-0.07952706j
   -1.36987663e-01+0.04477588j  5.58225953e-02+0.03346809j
    3.60987094e-01-0.04728652j  1.89643098e-01-0.32287745j
    1.49913771e-01+0.j        ]
  [ 1.75295461e+00+0.j          1.53767468e-01+0.14442131j
    8.57244677e-02+0.01489265j -3.36378422e-01+0.05776882j
    1.19430274e-01-0.11087692j  6.57333053e-02-0.47356395j
    2.18884390e-01-0.16024427j  4.75361694e-02-0.12442719j
    4.54286984e-03+0.j        ]
  [ 2.12287024e+00+0.j         -2.03825816e-01-0.33501391j
    3.01929637e-01+0.03110278j  1.87675979e-03-0.40800335j
    9.74408978e-02-0.2296195j  -2.14398348e-01+0.12120346j
    1.65570295e-01+0.04188004j  2.48715563e-01+0.10889382j
    3.80215517e-02+0.j        ]
  [ 2.56701694e+00+0.j          5.47453843e-02+0.0361855j
    1.81508029e-02+0.02706144j -1.25256412e-01-0.1155993j
    7.57275818e-02-0.15914889j -1.76314761e-02-0.19085228j
   -9.63089375e-03-0.06755096j  3.46789750e-01+0.34292971j
    3.32538564e-01+0.j        ]
  [ 1.86054284e+00+0.j          3.17412601e-01+0.05986489j
    1.74294661e-03+0.19966724j  1.06502062e-01+0.46112732j
    2.87579636e-02+0.15090891j  1.83210946e-01+0.2319558j
   -2.48576192e-01-0.38273977j -1.08403349e-02+0.06841445j
    2.78164250e-01+0.j        ]
  [ 2.05224721e+00+0.j         -7.50773904e-02-0.0954972j
    1.56689727e-01+0.22120955j  3.01008722e-01+0.3587725j
    2.08489056e-01+0.04529215j  2.83227362e-01+0.42104368j
    1.20810252e-01+0.10105175j -2.09548818e-01-0.32300296j
    1.56741277e-01+0.j        ]
  [ 2.44835462e+00+0.j          1.91256477e-01-0.07298401j
    1.49173217e-01+0.22507087j -4.97089637e-02+0.00211185j
   -4.51579715e-01+0.17619174j  3.97905686e-02-0.10424771j
    1.41237632e-01+0.24639588j -3.83476969e-02-0.11845117j
   -4.65053684e-01+0.j        ]]]
  Max Abs Diff:  6.456999494224164
  Mean Abs Diff:  0.5840144361257689
  Median Abs Diff:  0.3530672121108668
  Std Abs Diff:  0.7647544886443459
  Max Rel Diff:  48.230689528518155
  Mean Rel Diff:  3.1542624362364333
  Median Rel Diff:  1.4212114361223127
  Std Rel Diff:  6.653546942743862

  rtol, atol: 0.0001 0.0001


======================================================================
ERROR: test_rfft (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 77, in test_rfft
    utt.assert_allclose(rfft_ref, res_rfft_comp, atol=1e-4, rtol=1e-4)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (1, 16, 9) complex128 (2304, 16, 256) (-8.915166459159428-3.2527963536200692j) (123.0427996877643+0j) 0 0 
  Value    : (1, 16, 9) complex128 (2304, 144, 16) (-2.581539644180288-0.08404379013016061j) (9.41165874310197+0j) 0 0 
  expected    : [[[ 1.23042800e+02+0.00000000e+00j -4.08557420e+00+4.55504166e+00j
   -4.25774359e+00-5.79492672e-01j -7.76036427e-01-1.68244179e+00j
    4.63123057e-02+1.90794565e-01j  1.78530395e+00+1.98573172e+00j
   -3.76487049e+00+4.66998816e+00j -4.84634203e+00+4.51410521e+00j
    8.80470732e-01+0.00000000e+00j]
  [ 6.59487652e-01-1.55274357e+00j -6.10424587e+00+1.37041591e+00j
   -2.55169596e-01-2.10457229e+00j  2.37607419e+00-6.17684881e-02j
    4.73959578e+00-2.17512680e+00j -3.35117127e+00+5.33231475e-01j
    7.91202830e+00-4.66386044e+00j -8.91516646e+00-3.25279635e+00j
   -1.67783115e+00-1.64804183e+00j]
  [ 1.62022401e+00-3.44687035e+00j  7.95461206e-01+2.17009010e+00j
   -5.02826265e+00-1.47759612e+00j  3.11040518e+00-3.57375785e-01j
    5.37305967e+00+1.48625721e+00j -1.03609349e+00+3.12565782e+00j
   -4.03497505e+00+1.46332186e+00j -3.36952848e+00+2.42174023e+00j
   -3.66086731e+00-7.80152922e-01j]
  [ 3.93973265e+00-8.14592232e-01j  1.31400286e+00-1.50404862e+00j
    7.21985273e-01-2.30111396e+00j -7.88102932e-02-4.49016000e+00j
   -3.80748405e+00-3.56469729e-01j  1.37362309e+00+2.20948151e+00j
   -4.15126168e+00+3.75786416e+00j -3.15247035e+00+2.48264141e-01j
    5.86469243e+00+2.97086948e+00j]
  [ 4.01279763e+00+4.65072624e-01j -1.04938080e+00+2.30830568e-01j
    1.00481751e+00-7.89066403e-02j -5.68812708e+00+1.02740910e+00j
    2.25187742e+00+1.59149394e+00j -1.22593321e+00-2.43533630e-02j
   -2.50505238e+00-5.35036053e+00j -1.58823919e+00-7.95509341e-01j
    9.48846731e-01+1.63068022e+00j]
  [-2.57323148e-01-6.40726992e+00j  1.88132028e+00-5.69308939e-02j
   -1.16052912e-01+3.93125038e+00j -3.84278297e+00+8.43031809e-01j
   -2.93807245e-01-5.75120014e+00j  1.14768809e+00-3.35294302e+00j
    3.48059486e+00-5.91669778e-01j -3.66319223e+00-5.53919012e-01j
    5.75274476e+00+5.59542529e+00j]
  [ 1.18749464e+00-5.88053776e-01j  4.73978446e-01+3.73894667e-01j
    3.63875722e+00+4.99696919e+00j -5.79328557e+00-8.66643198e-03j
   -2.66294308e-01+2.82763325e-01j -2.48508299e+00-2.83077987e+00j
   -5.39933332e+00-4.97870651e+00j  7.03034115e-01-6.75441926e+00j
   -6.37853402e+00+1.56616700e+00j]
  [ 2.02018032e+00+4.90725357e+00j -5.07789444e+00+1.00623598e+00j
   -1.83064848e+00+6.78824583e+00j  6.81141039e+00+2.76925034e+00j
   -5.56629222e+00-1.22307875e+00j -3.59703967e+00+1.97578191e+00j
    5.98430856e+00+4.93794187e-01j -2.44346168e+00-7.31228312e+00j
    1.01363955e-01-3.11116705e-01j]
  [-9.97045060e-01+0.00000000e+00j  5.28741490e-01-7.14749260e+00j
    2.45464358e-02-7.37617178e-01j -1.42585570e+00+2.48296588e+00j
   -9.07060221e-01-2.06993773e+00j  5.12218553e+00+1.71723693e-02j
    6.29483175e+00+1.70985378e+00j  2.76472669e+00+2.04433383e+00j
   -2.50445000e+00+0.00000000e+00j]
  [ 2.02018032e+00-4.90725357e+00j -1.91786917e+00-4.68267328e+00j
    2.69681352e+00+4.42619552e-02j -4.27965191e+00+4.92657010e+00j
   -1.93089725e+00+5.18067634e-01j  6.42721127e+00+1.21642867e+00j
    2.97145882e+00+5.09929334e+00j -2.94596551e+00+3.28854123e-01j
    1.01363955e-01+3.11116705e-01j]
  [ 1.18749464e+00+5.88053776e-01j  3.85926233e+00+1.72456574e+00j
    2.45927391e+00+3.47170944e-01j  3.58444706e+00-2.68798331e+00j
    2.38926153e+00-4.11259977e-01j -3.80883894e+00+2.21004894e+00j
   -4.06796307e+00-3.20094025e+00j  2.55052538e+00-8.79496837e-01j
   -6.37853402e+00-1.56616700e+00j]
  [-2.57323148e-01+6.40726992e+00j  4.42473177e+00+8.44134751e+00j
   -4.04965131e+00+7.60435862e-01j -7.06875963e-01-9.48293353e-01j
    3.98273748e+00-6.84120714e+00j -2.47661074e+00+2.07317531e-01j
    1.03293658e+00+2.66569700e+00j -4.24491157e+00+2.34271706e+00j
    5.75274476e+00-5.59542529e+00j]
  [ 4.01279763e+00-4.65072624e-01j -7.18653306e-01+7.65617554e-01j
    3.96990140e+00-2.07659327e+00j -2.61407534e-01+1.61404240e+00j
   -1.82342603e+00-1.10985453e+00j -5.33550704e+00+4.65133060e+00j
   -3.34535661e+00+2.02677218e+00j -2.16530857e+00+7.00717399e-01j
    9.48846731e-01-1.63068022e+00j]
  [ 3.93973265e+00+8.14592232e-01j  1.76168558e+00-1.25033427e+00j
   -3.68979850e+00-3.84282596e+00j -4.32756850e+00-2.77388953e+00j
    4.69562450e+00-3.68875747e+00j  2.14137279e+00+2.70118840e+00j
    2.10795894e+00-7.09840830e+00j  1.21995181e+00+7.91820062e-01j
    5.86469243e+00-2.97086948e+00j]
  [ 1.62022401e+00+3.44687035e+00j  5.35070799e+00-1.09936894e+01j
   -2.37750012e+00+1.83078586e+00j -2.12016394e+00-2.02144823e+00j
    4.20744215e+00-8.18059130e+00j -5.66028184e+00+5.24328148e-01j
   -5.51769905e+00+8.37589118e-01j -7.51243045e-01-6.84004929e-02j
   -3.66086731e+00+7.80152922e-01j]
  [ 6.59487652e-01+1.55274357e+00j -7.19439301e-01-5.99307559e+00j
   -2.98540902e+00+5.75612870e+00j  2.73137502e+00-7.71166456e-01j
    2.40186078e+00-9.61192142e-01j -3.39495563e+00+5.71980652e+00j
   -3.73808288e-01-1.14049173e+00j  4.29773244e+00+1.33210205e+00j
   -1.67783115e+00+1.64804183e+00j]]]
  value    : [[[ 9.27568388+0.j          0.04480218-0.68688781j
   -0.62963381+0.70353316j -0.66792838-0.13374523j
    0.96828189-1.79370619j -0.89838313+1.30433934j
   -0.21101263-0.26876648j -1.65936617-0.30576065j
    0.01730322+0.j        ]
  [ 8.80642508+0.j         -0.57106883-0.82101654j
   -1.50245665-0.46496974j  0.20915729-1.11140197j
    0.35604857-0.66494265j  0.07645666+1.12715078j
   -0.60355345-0.03007482j  0.12007069+0.1859839j
   -0.91721794+0.j        ]
  [ 7.4716423 +0.j         -2.48267894-0.91871867j
    0.849655  +0.68240585j  1.05941666+1.24743768j
   -0.98177314+0.73398457j  0.22166229+0.63253828j
    0.32175839+0.67722326j -0.66472784-0.97596327j
   -0.74285321+0.j        ]
  [ 6.84637409+0.j         -1.69637099+1.08253584j
    0.40452028+0.59696568j -0.19065106+0.68417579j
    0.22920266-0.21004215j -0.72520568-1.09629106j
   -0.03928313+0.45962669j  0.20338336-0.99938899j
    0.64369688+0.j        ]
  [ 9.28507889+0.j         -0.57714344+0.05053913j
    0.93905223-0.14940147j -0.83169643-0.64459869j
   -0.65129354+0.9765638j   1.39692678+1.12879438j
    1.79568947+1.43217845j -0.35444436+0.18643514j
    1.11107847+0.j        ]
  [ 7.11639751+0.j         -0.96667128+0.50194463j
    0.60816123-0.74281534j  0.15992053-0.04635877j
   -0.21638052+1.53443722j  0.66111752-0.32435849j
    0.09162549+0.47118677j  0.74439793-0.86117596j
    0.57104946+0.j        ]
  [ 6.93419949+0.j          1.38234217+0.45869954j
   -0.56576686+0.10615516j -0.53431521-1.83656038j
    0.57583237-0.8747063j   1.71628032-0.45885633j
   -0.61734109+0.23218948j  0.39559863+0.15744698j
    1.00294163+0.j        ]
  [ 8.12215578+0.j          0.5408773 +0.56427847j
   -0.71721484+0.9213885j   0.21542577+1.26088541j
    0.05293127-1.17074097j  0.15058022-0.65113074j
   -1.15016702+1.42675025j -0.74113118-0.04028173j
    0.02963144+0.j        ]
  [ 7.68516451+0.j          0.59951572-0.35325491j
    0.55885757-0.42544315j -0.50332462-0.07044204j
    0.44061467+0.76616438j -0.68214787-0.09694729j
   -2.58153964-0.08404379j  0.82156928+0.45364449j
   -2.49293928+0.j        ]
  [ 7.37206437+0.j         -0.82277165+0.57525919j
   -0.59468403-0.45708598j -0.15574435-0.42608277j
   -0.83116674+0.7449104j   0.27094474+0.53582645j
    0.3625122 +1.44486673j -1.23705561+0.68290562j
    1.27413414+0.j        ]
  [ 7.49558177+0.j          0.44477279+0.32386092j
   -1.00587198-1.05638782j -0.4640558 +0.34848411j
   -0.30097992-0.55143573j  0.50668412-0.54799337j
    0.42535051+0.8874673j  -0.1719135 +1.71126787j
    0.8892241 +0.j        ]
  [ 9.41165874+0.j         -0.15164973+0.68515431j
    0.38491676+0.10453328j -0.46811707-0.92116482j
   -1.34730203+0.43187109j -0.02516953+0.97691161j
   -2.0309485 -1.1076292j  -0.3908151 -0.04150292j
   -0.43228085+0.j        ]
  [ 6.27191018+0.j         -1.39839116+0.59060289j
   -0.68289556-0.99684098j -0.03490726+1.70927986j
   -0.86567716-0.29839792j  0.27011653-0.6787161j
    0.16675087-0.31530477j -0.26654952+1.28159279j
    1.43298614+0.j        ]
  [ 7.48253791+0.j          1.34062958+2.58676442j
   -0.08101472+0.96313122j  0.09577967-0.8141883j
    0.25450471-0.03039604j -0.67381833+0.18091455j
   -0.52122663-0.93586904j -1.15612351+0.75399664j
   -0.89707559+0.j        ]
  [ 6.60361629+0.j          0.20836434-0.76106656j
   -1.57999518+0.47742433j  0.87586497-0.21959327j
    0.38462087+0.10196181j  0.92260571-0.28170687j
    1.96532474+0.62897753j  0.85902582+0.77055617j
   -2.0297307 +0.j        ]
  [ 6.86230888+0.j          0.01986775+0.67634682j
   -0.64337305-0.84208537j  0.45913886-0.70856841j
    1.97884835+0.49526924j -1.4033464 +0.23525657j
   -1.13881008-0.24879021j -1.34826094+1.55434914j
    1.42052281+0.j        ]]]
  Max Abs Diff:  113.76711580479937
  Mean Abs Diff:  5.403879033838397
  Median Abs Diff:  4.5542777869057325
  Std Abs Diff:  9.406534129098054
  Max Rel Diff:  11.14530216646809
  Mean Rel Diff:  1.3174829137178545
  Median Rel Diff:  1.0428118885636937
  Std Rel Diff:  1.2613575342010628

  rtol, atol: 0.0001 0.0001


======================================================================
ERROR: test_rfft_float (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\fft.py", line 37, in perform
    A = np.fft.rfftn(a, s=tuple(s))
  File "<__array_function__ internals>", line 6, in rfftn
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\fft\_pocketfft.py", line 1124, in rfftn
    a = rfft(a, s[-1], axes[-1], norm)
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 22, in test_rfft_float
    utt.verify_grad(f_rfft, [inputs_val], eps=eps)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1738, in verify_grad
    o_fn_out = o_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 892, in rval
    r = p(n, [x[0] for x in i], o)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\fft.py", line 37, in perform
    A = np.fft.rfftn(a, s=tuple(s))
  File "<__array_function__ internals>", line 6, in rfftn
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\numpy\fft\_pocketfft.py", line 1124, in rfftn
    a = rfft(a, s[-1], axes[-1], norm)
IndexError: list index out of range
Apply node that caused the error: RFFTOp(input 0, TensorConstant{[]})
Toposort index: 0
Inputs types: [TensorType(float64, row), TensorType(int64, vector)]
Inputs shapes: [(1, 16), (0,)]
Inputs strides: [(128, 8), (8,)]
Inputs values: ['not shown', array([], dtype=int64)]
Outputs clients: [['output']]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 22, in test_rfft_float
    utt.verify_grad(f_rfft, [inputs_val], eps=eps)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 20, in f_rfft
    return fft.rfft(inp)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

----------------------------------------------------------------------
Ran 7 tests in 5.030s

FAILED (errors=5)
