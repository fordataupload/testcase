ERROR (theano.gof.opt): Optimization failure due to: local_mul_zero
ERROR (theano.gof.opt): node: Elemwise{mul,no_inplace}(TensorConstant{2}, Elemwise{add,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 5811, in local_mul_zero
    value = get_scalar_constant_value(i)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in get_scalar_constant_value
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in <listcomp>
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 591, in get_scalar_constant_value
    ret = v.owner.inputs[0].owner.inputs[idx]
IndexError: list index out of range

ERROR (theano.gof.opt): Optimization failure due to: local_mul_zero
ERROR (theano.gof.opt): node: Elemwise{mul,no_inplace}(TensorConstant{2}, Elemwise{add,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 5811, in local_mul_zero
    value = get_scalar_constant_value(i)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in get_scalar_constant_value
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in <listcomp>
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 591, in get_scalar_constant_value
    ret = v.owner.inputs[0].owner.inputs[idx]
IndexError: list index out of range

ERROR (theano.gof.opt): Optimization failure due to: local_add_specialize
ERROR (theano.gof.opt): node: Elemwise{add,no_inplace}(TensorConstant{-1}, Subtensor{int64}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 6102, in local_add_specialize
    y = get_scalar_constant_value(input)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 591, in get_scalar_constant_value
    ret = v.owner.inputs[0].owner.inputs[idx]
IndexError: list index out of range

E.EE..ERROR (theano.gof.opt): Optimization failure due to: local_mul_zero
ERROR (theano.gof.opt): node: Elemwise{mul,no_inplace}(TensorConstant{2}, Elemwise{add,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 5811, in local_mul_zero
    value = get_scalar_constant_value(i)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in get_scalar_constant_value
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in <listcomp>
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 591, in get_scalar_constant_value
    ret = v.owner.inputs[0].owner.inputs[idx]
IndexError: list index out of range

ERROR (theano.gof.opt): Optimization failure due to: local_mul_zero
ERROR (theano.gof.opt): node: Elemwise{mul,no_inplace}(TensorConstant{2}, Elemwise{add,no_inplace}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 5811, in local_mul_zero
    value = get_scalar_constant_value(i)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in get_scalar_constant_value
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 509, in <listcomp>
    for i in v.owner.inputs]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 591, in get_scalar_constant_value
    ret = v.owner.inputs[0].owner.inputs[idx]
IndexError: list index out of range

ERROR (theano.gof.opt): Optimization failure due to: local_add_specialize
ERROR (theano.gof.opt): node: Elemwise{add,no_inplace}(TensorConstant{-1}, Subtensor{int64}.0)
ERROR (theano.gof.opt): TRACEBACK:
ERROR (theano.gof.opt): Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\opt.py", line 6102, in local_add_specialize
    y = get_scalar_constant_value(input)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\basic.py", line 591, in get_scalar_constant_value
    ret = v.owner.inputs[0].owner.inputs[idx]
IndexError: list index out of range

E
======================================================================
ERROR: test_1Drfft (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
IndexError: index out of bounds

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 47, in test_1Drfft
    res_irfft = f_irfft(res_rfft)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
IndexError: index out of bounds
Apply node that caused the error: Subtensor{int64}(MakeVector{dtype='int64'}.0, Constant{-4})
Toposort index: 4
Inputs types: [TensorType(int64, vector), Scalar(int64)]
Inputs shapes: [(3,), ()]
Inputs strides: [(8,), ()]
Inputs values: [array([1, 9, 2], dtype=int64), -4]
Outputs clients: [[Elemwise{Composite{(i0 * (i1 + i2))}}[(0, 2)](TensorConstant{2}, TensorConstant{-1}, Subtensor{int64}.0)]]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 45, in test_1Drfft
    irfft = fft.irfft(m)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 45, in test_1Drfft
    irfft = fft.irfft(m)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

======================================================================
ERROR: test_irfft (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 92, in test_irfft
    utt.assert_allclose(inputs_val, np.asarray(res_irfft))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (1, 16, 16) float64 (2048, 128, 8) 0.0077381629878782165 0.9936703648395476 0 0 
  Value    : (1, 16, 16) float64 (2048, 128, 8) -2.739404613011031 9.766008632003313 0 0 
  expected    : [[[0.1353494  0.27341393 0.03542599 0.42413226 0.13289948 0.82478808
   0.17857838 0.43939735 0.06645644 0.24663563 0.79493822 0.52490979
   0.34045301 0.53797646 0.75975521 0.30765969]
  [0.43699149 0.70807541 0.90023554 0.86306702 0.08405289 0.57291703
   0.40535822 0.54225641 0.02076264 0.92698558 0.42561029 0.01621585
   0.29405    0.67385457 0.392127   0.86358335]
  [0.84178091 0.62572733 0.39392474 0.95226946 0.92248482 0.09590177
   0.40544916 0.09754673 0.57960793 0.44384025 0.15601776 0.55353505
   0.34606006 0.74474487 0.23685693 0.4342994 ]
  [0.73492532 0.31204071 0.48146642 0.79037419 0.31327322 0.6699156
   0.11374785 0.26786318 0.67601651 0.89896688 0.93110595 0.35916609
   0.9537354  0.56391595 0.8777379  0.19202416]
  [0.52299754 0.62150589 0.06079509 0.01869926 0.298045   0.50473419
   0.29961557 0.44283401 0.38418648 0.06549254 0.32960424 0.72942794
   0.55509967 0.5288396  0.20307535 0.9765716 ]
  [0.15416925 0.3708895  0.22272072 0.36039982 0.48498188 0.24948877
   0.9814008  0.9433964  0.79067807 0.67931535 0.09682639 0.262803
   0.99367036 0.71032453 0.3901081  0.56717598]
  [0.08951013 0.44073919 0.10495735 0.68183782 0.31150283 0.66919707
   0.98841389 0.3930208  0.29226331 0.46756277 0.29031652 0.84918804
   0.712163   0.34929942 0.45208028 0.42877569]
  [0.60850074 0.73609298 0.35253624 0.35601395 0.59136704 0.82312425
   0.65087742 0.57607829 0.50310554 0.09924719 0.27264032 0.03344569
   0.70604898 0.64870168 0.41037587 0.00773816]
  [0.58266509 0.74501867 0.92419115 0.09815225 0.03236548 0.106822
   0.17913859 0.17518167 0.20578784 0.3271364  0.4913322  0.48687574
   0.5032574  0.28815934 0.47458508 0.06431285]
  [0.3308476  0.48623288 0.29528988 0.37818203 0.5417532  0.40010546
   0.76240955 0.47955264 0.15861623 0.13080003 0.48172727 0.24642311
   0.92249391 0.57461442 0.07461399 0.37269671]
  [0.19748517 0.63225866 0.94114428 0.82023108 0.26307149 0.86991022
   0.39742133 0.88811711 0.71855562 0.66002236 0.97249178 0.09441107
   0.30465039 0.0762231  0.78761657 0.64670505]
  [0.96267341 0.95592698 0.86098628 0.95262915 0.04407321 0.77759974
   0.57376583 0.71569645 0.15618335 0.53053071 0.34794832 0.14246731
   0.83683726 0.39317949 0.81061229 0.61630338]
  [0.63907216 0.12253074 0.35538833 0.04429985 0.15362478 0.19122078
   0.82903655 0.96854568 0.43481821 0.31767392 0.77021078 0.28244732
   0.38467936 0.22577154 0.59839337 0.93039134]
  [0.13158445 0.31302627 0.36936329 0.86175496 0.27551035 0.8822734
   0.51128198 0.77603478 0.05065324 0.01078841 0.36965792 0.56117075
   0.29515017 0.40854509 0.2270829  0.07465744]
  [0.89673015 0.65823359 0.58300058 0.34835623 0.6598614  0.32660515
   0.69166244 0.21705726 0.71085574 0.49495187 0.85774804 0.59884657
   0.70694106 0.24421088 0.51280413 0.1258849 ]
  [0.47038107 0.39499497 0.16628639 0.48889568 0.66479674 0.33969304
   0.31799934 0.2297029  0.05338387 0.66195348 0.11347362 0.16848512
   0.9107186  0.34193589 0.46852936 0.06549789]]]
  value    : [[[ 7.73566389  8.39670771  7.04771227  8.43929503  5.77366382
    8.30429655  8.28615689  8.15228167  5.801931    6.96190338
    7.70164962  5.90981844  9.76600863  7.31029684  7.67635434
    6.67427758]
  [ 1.09866726 -0.32884868 -0.16616582 -0.32362936  0.83335092
    0.07213513 -1.03363126 -1.47254147 -1.98784771  2.03403925
   -0.35031053 -0.49352864 -1.23966921  1.13582953  1.1274512
    0.14791709]
  [-0.27727936  0.2884703   0.14231574  1.60479098  1.28603601
    0.74653236 -0.5100202  -2.31554711 -1.48822534 -0.7690972
    0.88293881  0.08245796 -1.26955474 -0.72003149 -1.32591386
   -2.11348723]
  [-1.21628763 -0.17091631 -0.989407    1.04371033 -0.4309894
    0.3758571   0.82780701  2.33857478  0.19888183  1.17318971
   -0.26222086 -0.32337555 -0.31449308 -1.16122953  0.7510074
    1.19477962]
  [ 0.949457   -2.02316844 -0.63920056 -2.73940461 -1.45491902
   -1.18676343 -1.91406592  1.367654   -0.58298341 -0.65510336
   -0.42549712  0.74400736 -0.46503551  0.80543699 -0.13736383
    0.59938905]
  [-2.57341556 -1.71912298 -0.73042283  2.0405765  -0.96882665
    2.36264795  0.55651947 -0.13165342  0.49465947 -0.99313388
    1.5656147   1.16980759 -0.92685071 -0.96454769 -0.25376054
   -0.82446718]
  [-0.21280673  0.56222345  1.0502195   2.03229856 -0.79963661
   -0.1830834  -0.33861175  0.0721984  -0.81243749 -0.75401903
    0.34756053  0.44780474  0.5161875   0.23012934  0.84630089
   -1.41246882]
  [ 1.25073991 -0.15408763 -1.21682345 -0.03292834  0.55564516
   -0.54042905 -0.39848746 -1.13481958  0.37151553 -1.43810391
    1.81423871  1.12915167  0.29664098  0.7058489  -0.48099661
    0.43231511]
  [ 0.07551722 -0.15785172 -0.25005725 -1.66333858 -0.22595324
   -1.12593802 -0.34752509 -0.90888044  0.98313213 -0.91527189
    1.62366945  2.32946462 -2.05940072 -1.31984641  0.3739795
    1.15492345]
  [ 0.15806202  0.2666762  -1.25394936 -1.00101544  1.73495282
    0.56930556  1.9757694   1.29137215  0.99952396 -1.27111644
   -1.8165793  -0.97618816  0.65711446  1.07435361 -0.26242122
   -0.98644031]
  [-0.48207753 -0.54165834  0.34804171  0.12936515 -0.85381776
    1.28150927 -1.14166684 -0.42779639  1.04497226  1.56036407
    0.66469796  0.76970656 -0.36031267 -0.31779695  1.37693872
   -1.45861013]
  [-0.81205073 -0.72782313 -1.70003444 -0.94997551  0.14916179
    1.86039277 -1.33994261  1.10735106 -1.12595015 -0.49542024
    1.14022937 -0.36444541 -0.20028988  0.58406439  1.05239402
   -0.07403704]
  [-1.24030136  0.83418938 -0.65525225 -1.69541735 -1.62505258
    0.51866511 -0.07908954 -0.50722037 -1.83708383 -1.56377411
    0.64451982 -0.88864726 -0.10761464 -0.47289965  0.23026602
    0.6871518 ]
  [-1.29301536  0.13474981  0.06046382 -0.26062384 -1.19761911
    1.43118932  0.77000904  0.47636104 -0.91587147  0.52734859
   -0.52480055 -0.92037658  0.68806175  0.94735143  0.97707016
    2.13459039]
  [-0.80405726  0.78854847  0.63315793 -1.92931311 -0.77820096
   -0.90233781 -1.09344185 -0.51605757 -0.93135104  0.72517445
   -1.14937567 -1.30032819  0.72940541  1.09379773  0.83416051
   -1.15539541]
  [-0.1912254  -1.07346516 -1.11378218  2.09172577  0.12859648
   -0.38737008 -1.36252526 -0.36091916  0.85043737 -0.18080924
    0.86267666  1.0832274  -0.26294943 -0.32313375 -0.62938339
   -0.07788293]]]
  Max Abs Diff:  9.425555622404676
  Mean Abs Diff:  1.387649255608665
  Median Abs Diff:  1.0066980183304153
  Std Abs Diff:  1.6244328048250039
  Max Rel Diff:  197.94184596746078
  Mean Rel Diff:  7.273956537267762
  Median Rel Diff:  2.3800857319491113
  Std Rel Diff:  18.812429851053775

  rtol, atol: 1e-05 1e-08


======================================================================
ERROR: test_norm_rfft (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 142, in test_norm_rfft
    utt.assert_allclose(irfft_ref * N, res_irfft, atol=1e-4, rtol=1e-4)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 358, in assert_allclose
    raise WrongValue(expected, value, rtol, atol)
theano.tests.unittest_tools.WrongValue: WrongValue
           : shape, dtype, strides, min, max, n_inf, n_nan:
  Expected : (1, 16, 16) float64 (2048, 128, 8) -3.739261330202185 7.840687928460648 0 0 
  Value    : (1, 16, 16) float64 (2048, 128, 8) -1.3805017208237949 2.8181922520551903 0 0 
  expected    : [[[ 7.84068793e+00 -3.73926133e+00 -1.35197036e-01 -1.99412988e+00
    1.77334857e-01 -1.11301370e+00  3.51073928e-01  4.99613837e-02
   -3.04138216e-02 -1.65631875e-01 -1.52517328e-01  1.02204038e+00
    4.76344354e-01  1.12221217e+00  3.95676569e-01  5.31906632e+00]
  [ 1.02054472e-01  3.92193118e-01 -8.83993509e-01  9.48842601e-02
   -7.15610054e-01  1.04210026e-01 -3.60224147e-02  1.26170660e-01
    3.74804945e-01 -4.53556686e-01 -7.16198611e-01 -7.28760754e-02
    3.66029834e-01  7.54862099e-01 -3.15692364e-01  4.77554418e-01]
  [-2.30949322e-01 -1.54584114e-01  2.40195375e-01 -2.07435680e-01
   -4.37932024e-01 -1.17490886e-01  3.82559622e-01 -4.12163193e-01
    5.85122635e-01 -1.23382143e-01 -3.08781432e-01 -8.72983013e-01
   -8.36542794e-01  5.68844994e-01  1.12734413e-01  4.19039104e-03]
  [ 5.06987521e-01 -3.41409404e-01  5.21266168e-01 -1.92947822e-01
    9.11906183e-01  2.30367309e-01  5.80365185e-02  8.57718355e-01
   -1.44631970e-01  7.50073590e-01 -5.99411016e-02 -2.93252766e-01
    2.75484805e-01  3.84349817e-01 -2.92728564e-01 -1.34552225e-01]
  [-2.41367028e-01  5.93024994e-02  9.38205071e-02 -6.17643583e-01
   -1.10424567e-01 -2.32934433e-01 -1.20222577e-02 -4.88157418e-02
    3.92930353e-01  2.47296977e-01 -4.58072080e-01  7.73543930e-01
   -3.83845984e-01  3.15166164e-01  5.42007960e-01 -3.13619201e-01]
  [-2.17835144e-01  5.06780847e-01 -2.12625118e-01 -1.13734541e-01
   -1.00567378e-01  3.54569239e-01 -2.03877853e-01  2.82373384e-01
   -1.31010153e-01 -4.28707228e-01 -9.06750766e-01  6.43427106e-01
    5.96023580e-01  3.41873876e-01  9.01465458e-01  1.57137807e-01]
  [-4.99275579e-01  1.82747079e-01  3.25146302e-01 -2.17568924e-01
    2.28752044e-01  1.29476887e-01  5.00782807e-02 -1.50989159e-01
   -8.65317459e-01 -4.12215568e-01  3.19339377e-01  3.06865919e-01
    1.53175984e-01  7.08653620e-01  3.45128801e-02 -3.42856131e-01]
  [-2.27092207e-02 -4.29376413e-01  7.30532793e-02  1.21816817e-01
   -3.14184235e-01 -1.51820245e-01 -2.45376767e-01 -6.10419950e-02
   -2.35399080e-01 -1.18023126e-01 -2.59957809e-01  4.65833739e-01
    1.11105538e-01 -1.78756056e-01  6.29689239e-02  9.98203321e-01]
  [ 4.57894549e-01  7.48732754e-02 -3.24399020e-02 -5.73369003e-01
   -7.61301415e-01 -1.83599523e-01  4.76433843e-02  1.26810895e-01
    5.86854768e-02 -2.67449256e-01  7.94345479e-01  7.91168475e-01
    4.05584426e-01  2.46819658e-01 -2.62405666e-01  3.71526826e-01]
  [ 1.52354603e-01  7.89609317e-01  4.81725725e-02 -4.56594173e-01
   -5.45098886e-01 -3.99149618e-01  3.11125156e-01 -1.77750902e-01
   -1.99543831e-01  2.69693307e-01  6.41877735e-01 -5.87839056e-01
   -1.84327632e-01  2.54917996e-01 -1.97316599e-01  4.46458999e-01]
  [ 8.34786058e-01 -2.63359993e-01 -1.37386087e-01  1.16825423e-01
    4.59899912e-01  1.60410300e-01 -1.22498356e-02 -5.39497221e-01
    7.43693233e-02 -1.96379645e-01 -1.36700867e-01  5.52784791e-01
    1.61890327e-01 -2.65867496e-01 -6.49180551e-01  7.41914890e-01]
  [-4.75692509e-01  2.62174704e-01 -9.27514835e-02  2.29703450e-01
    5.21326158e-01 -6.50109454e-01 -4.18998347e-01  3.37504184e-01
    9.65958022e-01 -8.11792803e-01  3.84816874e-01 -1.94634121e-01
   -4.28409166e-02 -1.50776194e-01 -1.83226452e-01  2.29301413e-01]
  [ 1.14612837e-01  3.99982433e-01 -2.82736669e-01  7.57437566e-01
    7.00764858e-01  6.37883517e-02 -2.19565274e-01  4.65996314e-01
   -2.85664274e-02 -2.24206990e-01 -6.29192015e-02  6.46592368e-01
   -6.31798104e-01 -3.60732553e-01  2.14910746e-01 -1.22031487e-01]
  [ 4.15308970e-01  1.77471488e-01  9.45707971e-02 -2.54356380e-01
   -5.35753099e-02  1.56717233e-01  1.80324561e-01  7.02104166e-01
    3.50254458e-01 -9.96665962e-01  2.59988040e-01 -2.95126375e-01
    1.11320015e-01  7.96908280e-02 -6.17496801e-01 -3.51895407e-02]
  [ 3.35917210e-01 -4.84906460e-01 -4.51941414e-01 -1.22806137e-01
   -1.03481407e-02  4.54738837e-01  1.83100574e-01 -5.85419881e-01
    8.71474457e-02 -6.71407497e-02  4.29909209e-01  1.50525384e-01
   -6.51738069e-01  3.61474212e-02 -7.26621122e-01 -3.84610095e-01]
  [ 2.46266534e-01  5.27014188e-02  3.85899724e-02 -8.78458405e-03
   -6.01148081e-02 -2.51511683e-01  1.04995558e-01  4.87279263e-02
   -3.54396521e-01 -6.44403234e-01  4.07223867e-01 -4.14376921e-01
   -4.33906129e-01  3.95917065e-01  2.57496156e-01 -1.18634419e-01]]]
  value    : [[[ 2.32976047 -0.62876538 -0.19856406 -0.8596758  -0.0272932
   -0.36133784  0.13020621  0.25542229  0.22499835 -0.91062285
    0.04391535  0.65542344 -0.12701019  1.06333085 -0.18072375
    1.82346532]
  [ 2.16515386 -1.19991749 -0.07951352  0.17541781 -0.35705399
    0.01689986  0.05881607  0.52137253 -0.18776829  0.22309461
   -0.23118484 -1.05405863 -0.52119033  0.3645492   0.54688745
    1.55016176]
  [ 2.40797736 -0.99075816  0.07344468 -0.78602539 -0.45511417
   -0.52028163  0.19299325 -0.7702872  -0.45391091  0.47849381
    0.94564409  0.06183709  0.08392496  0.54768264 -0.35603213
    1.51949637]
  [ 1.52805689 -0.71347479 -0.49551513 -0.18868259  0.63273281
   -0.29078322 -0.21110724 -0.27379051  0.36668488 -0.14991664
   -0.67352781  0.41457274  0.25007566  0.37182358  0.33859314
    1.68181321]
  [ 1.58519193 -0.2166289   0.34725175 -0.33229285 -0.27515161
   -1.05476397  0.07064086  0.58372892  0.17118071  0.26952828
   -0.30447453  0.47971452 -0.01521382  0.25434516  0.50498136
    1.43570468]
  [ 2.81819225 -0.8763974   0.30684406 -0.65377889  0.49864771
   -0.37298995  0.36927951 -0.2994039  -0.54340766  0.67524427
   -0.28929176 -0.20754322  0.75488554  0.4614442  -0.31609866
    1.04853373]
  [ 1.7975405  -1.18411959  0.29390979 -0.93374388  0.16542516
   -0.07585566 -0.04086289  0.34708996  0.05426109 -0.51430847
    0.47714396  0.49308204  0.61570195  0.61210871  0.21477472
    1.24749819]
  [ 1.89959561 -0.58476581 -0.28162768 -0.75745793 -0.01643198
   -0.04991004  0.44108521 -0.0844902   0.16049396  0.23554084
    0.00543844 -0.60361184  0.39587406 -0.05972876  0.25035854
    1.05597614]
  [ 1.97639286 -1.33383792  0.0082946  -0.56966931  0.15066596
   -0.05797424  0.255103   -0.8024806  -0.08801959  0.30606822
    0.16838623  1.02984567 -0.52645474  0.12229114  0.01154137
    0.81332543]
  [ 1.30010244 -1.38050172  0.35926029 -0.12070461 -0.03854077
   -0.71513748 -0.26903349 -0.43346086  0.22235346  0.35025658
   -0.3196105   0.52686474 -0.96870801  0.0061398   0.35537446
    1.75017453]
  [ 2.3270232  -0.9484664   0.08252961 -0.44912643  0.27771052
   -0.20863584  0.17243744  0.32593631  0.29215002  0.09502029
   -0.03532849 -0.13049158  0.71530606 -0.10697241 -0.52640151
    1.2545752 ]
  [ 1.65928521 -1.2802167   0.39352587 -0.31619122  0.5587804
    0.12963125 -0.00695822  0.72459574 -0.39630588 -0.07391463
    0.30331631  0.47311501 -0.15980548 -0.16063242 -0.12195973
    1.65164895]
  [ 2.28048303 -1.02587092 -0.51353539 -0.66606694  0.15815258
    0.00831675 -0.28882029  0.55728223  0.0844761  -0.0749648
    0.21300982  1.06836151  0.53496344 -0.1165017   0.55439064
    1.18244702]
  [ 1.54027726 -0.54885953 -0.02511835 -0.09982836  0.05240777
   -0.42876138 -0.22101691 -0.01110069 -0.55072217 -0.6452174
   -0.2438649   0.66944691  0.50076323  0.08805999  0.75699527
    1.1167181 ]
  [ 1.89279562 -1.00032883 -0.42860486 -0.53839717 -1.16232835
   -0.32269401  0.30573705 -0.14314735 -0.22859248 -0.51537676
   -0.22464013 -0.031355    0.48263989  0.36177928  0.04401111
    2.10467407]
  [ 1.85492324 -1.04413577 -0.38336981 -0.88029596  0.5467306
   -0.1477774   0.44579617 -0.29742113  0.75047309 -0.41145287
   -0.44500056  0.24295809 -0.1103748   0.67912944 -0.49398599
    0.04005255]]]
  Max Abs Diff:  5.510927458761607
  Mean Abs Diff:  0.6470394212310079
  Median Abs Diff:  0.465646254219143
  Std Abs Diff:  0.6640965119782527
  Max Rel Diff:  361.6144558352565
  Mean Rel Diff:  5.460306070753918
  Median Rel Diff:  1.7581480989696603
  Std Rel Diff:  24.89307686527449

  rtol, atol: 0.0001 0.0001


======================================================================
ERROR: test_rfft_float (test_fft.TestFFT)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
IndexError: index out of bounds

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 27, in test_rfft_float
    utt.verify_grad(f_irfft, [inputs_val], eps=eps)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1738, in verify_grad
    o_fn_out = o_fn(*[p.copy() for p in pt])
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 917, in __call__
    storage_map=getattr(self.fn, 'storage_map', None))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 325, in raise_with_op
    reraise(exc_type, exc_value, exc_trace)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\six.py", line 702, in reraise
    raise value.with_traceback(tb)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 903, in __call__
    self.fn() if output_subset is None else\
IndexError: index out of bounds
Apply node that caused the error: Subtensor{int64}(MakeVector{dtype='int64'}.0, Constant{-4})
Toposort index: 3
Inputs types: [TensorType(int64, vector), Scalar(int64)]
Inputs shapes: [(3,), ()]
Inputs strides: [(8,), ()]
Inputs values: [array([1, 9, 2], dtype=int64), -4]
Outputs clients: [[Elemwise{Composite{(i0 * (i1 + i2))}}[(0, 2)](TensorConstant{2}, TensorConstant{-1}, Subtensor{int64}.0)]]

Backtrace when the node is created(use Theano flag traceback.limit=N to make it longer):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 27, in test_rfft_float
    utt.verify_grad(f_irfft, [inputs_val], eps=eps)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 25, in f_irfft
    return fft.irfft(inp)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\suite.py", line 122, in run
    test(result)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 653, in __call__
    return self.run(*args, **kwds)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\unittest\case.py", line 605, in run
    testMethod()
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 27, in test_rfft_float
    utt.verify_grad(f_irfft, [inputs_val], eps=eps)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tests\unittest_tools.py", line 92, in verify_grad
    T.verify_grad(op, pt, n_tests, rng, *args, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gradient.py", line 1728, in verify_grad
    o_output = fun(*tensor_pt)
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_fft.py", line 25, in f_irfft
    return fft.irfft(inp)

HINT: Use the Theano flag 'exception_verbosity=high' for a debugprint and storage map footprint of this apply node.

----------------------------------------------------------------------
Ran 7 tests in 6.389s

FAILED (errors=4)
3
