............C:\Users\mutation\Desktop\theano-testcase\tests\test_corr.py:283: DeprecationWarning: Please use assertEqual instead.
  assert_equals(f(a_tens_val, b_tens_val).dtype, c_dtype)
C:\Users\mutation\Desktop\theano-testcase\tests\test_corr.py:283: DeprecationWarning: Please use assertEqual instead.
  assert_equals(f(a_tens_val, b_tens_val).dtype, c_dtype)
C:\Users\mutation\Desktop\theano-testcase\tests\test_corr.py:283: DeprecationWarning: Please use assertEqual instead.
  assert_equals(f(a_tens_val, b_tens_val).dtype, c_dtype)
C:\Users\mutation\Desktop\theano-testcase\tests\test_corr.py:283: DeprecationWarning: Please use assertEqual instead.
  assert_equals(f(a_tens_val, b_tens_val).dtype, c_dtype)
C:\Users\mutation\Desktop\theano-testcase\tests\test_corr.py:283: DeprecationWarning: Please use assertEqual instead.
  assert_equals(f(a_tens_val, b_tens_val).dtype, c_dtype)
C:\Users\mutation\Desktop\theano-testcase\tests\test_corr.py:283: DeprecationWarning: Please use assertEqual instead.
  assert_equals(f(a_tens_val, b_tens_val).dtype, c_dtype)
............C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\corr.py:244: ResourceWarning: unclosed file <_io.TextIOWrapper name='C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tensor\\nnet\\c_code\\corr_gemm.c' mode='r' encoding='cp936'>
  for f in files]
FFFF...C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\corr.py:244: ResourceWarning: unclosed file <_io.TextIOWrapper name='C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tensor\\nnet\\c_code\\corr_gemm.c' mode='r' encoding='cp936'>
  for f in files]
FFC:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\corr.py:244: ResourceWarning: unclosed file <_io.TextIOWrapper name='C:\\ProgramData\\Anaconda3\\envs\\keras\\lib\\site-packages\\theano\\tensor\\nnet\\c_code\\corr_gemm.c' mode='r' encoding='cp936'>
  for f in files]
F
======================================================================
FAIL: test_fwd (test_corr.TestGroupCorr2d)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\tests\test_abstract_conv.py", line 1525, in test_fwd
    grouped_func = theano.function([img_sym, kern_sym], grouped_conv_output, mode=self.mode)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function.py", line 317, in function
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1841, in orig_function
    fn = m.create(defaults)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1715, in create
    input_storage=input_storage_lists, storage_map=storage_map)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 699, in make_thunk
    storage_map=storage_map)[:3]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\vm.py", line 1091, in make_all
    impl=impl))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 955, in make_thunk
    no_recycling)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 858, in make_c_thunk
    output_storage=node_output_storage)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1217, in make_thunk
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1157, in __compile__
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1624, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1155, in module_from_key
    module = self._get_from_hash(module_hash, key, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1065, in _get_from_hash
    self.check_key(key, key_data.key_pkl)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1263, in check_key
    "Ops. The file is: %s. The key is: %s" % (msg, key_pkl, key))
AssertionError: ('The following error happened while compiling the node', CorrMM{valid, (1, 1), (1, 1), 3 False}(img, Subtensor{::, ::, ::int64, ::int64}.0), '\n', 'Key not found in unpickled KeyData file. Verify the __eq__ and __hash__ functions of your Ops. The file is: C:\\Users\\mutation\\AppData\\Local\\Theano\\compiledir_Windows-10-10.0.18362-SP0-Intel64_Family_6_Model_85_Stepping_4_GenuineIntel-3.6.12-64\\tmpdws8xz0h\\key.pkl. The key is: (((10, False, (9,)), (\'border_mode\', \'subsample\', \'filter_dilation\', \'num_groups\', \'unshared\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\')), (\'CLinker.cmodule_key\', (\'--param\', \'--param\', \'--param\', \'-DMS_WIN64\', \'-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION\', \'-D_hypot=hypot\', \'-O3\', \'-Wl,-rpath,"C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\bin"\', \'-Wno-unused-label\', \'-Wno-unused-variable\', \'-Wno-write-strings\', \'-fno-math-errno\', \'-m64\', \'-mabm\', \'-madx\', \'-maes\', \'-march=knl\', \'-mavx\', \'-mavx2\', \'-mavx512bw\', \'-mavx512cd\', \'-mavx512dq\', \'-mavx512f\', \'-mbmi\', \'-mbmi2\', \'-mclflushopt\', \'-mclwb\', \'-mcx16\', \'-mf16c\', \'-mfma\', \'-mfsgsbase\', \'-mfxsr\', \'-mhle\', \'-mlzcnt\', \'-mmmx\', \'-mmovbe\', \'-mno-3dnow\', \'-mno-avx512er\', \'-mno-avx512ifma\', \'-mno-avx512pf\', \'-mno-avx512vbmi\', \'-mno-avx512vl\', \'-mno-fma4\', \'-mno-lwp\', \'-mno-mwaitx\', \'-mno-pcommit\', \'-mno-prefetchwt1\', \'-mno-sha\', \'-mno-sse4a\', \'-mno-tbm\', \'-mno-xop\', \'-mpclmul\', \'-mpopcnt\', \'-mprfchw\', \'-mrdrnd\', \'-mrdseed\', \'-mrtm\', \'-msahf\', \'-msse\', \'-msse2\', \'-msse3\', \'-msse4.1\', \'-msse4.2\', \'-mssse3\', \'-mtune=generic\', \'-mxsave\', \'-mxsavec\', \'-mxsaveopt\', \'-mxsaves\', \'l1-cache-line-size=64\', \'l1-cache-size=32\', \'l2-cache-size=11264\'), (\'mkl_core\', \'mkl_intel_thread\', \'mkl_rt\'), (), \'NPY_ABI_VERSION=0x1000009\', \'c_compiler_str="C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\mingw-w64\\\\bin\\\\g++.exe" 5.3.0\', \'md5:m9c3464d5c3cd1492b72c317a15c53eb717da23ada0f044128239eee1002b25f9\', (<theano.tensor.nnet.corr.CorrMM object at 0x00000227AB4AAB38>, ((TensorType(float64, 4D), ((-1, 0), False)), (TensorType(float64, 4D), ((-1, 1), False))), (1, (False,)))))')

======================================================================
FAIL: test_gradinputs (test_corr.TestGroupCorr2d)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\tests\test_abstract_conv.py", line 1618, in test_gradinputs
    grouped_func = theano.function([kern_sym, top_sym], grouped_conv_output, mode=self.mode)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function.py", line 317, in function
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1841, in orig_function
    fn = m.create(defaults)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1715, in create
    input_storage=input_storage_lists, storage_map=storage_map)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 699, in make_thunk
    storage_map=storage_map)[:3]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\vm.py", line 1091, in make_all
    impl=impl))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 955, in make_thunk
    no_recycling)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 858, in make_c_thunk
    output_storage=node_output_storage)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1217, in make_thunk
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1157, in __compile__
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1624, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1155, in module_from_key
    module = self._get_from_hash(module_hash, key, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1065, in _get_from_hash
    self.check_key(key, key_data.key_pkl)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1263, in check_key
    "Ops. The file is: %s. The key is: %s" % (msg, key_pkl, key))
AssertionError: ('The following error happened while compiling the node', CorrMM_gradInputs{valid, (1, 1), (1, 1), 3 False}(Subtensor{::, ::, ::int64, ::int64}.0, top, Elemwise{Cast{int64}}.0, Elemwise{Cast{int64}}.0), '\n', 'Key not found in unpickled KeyData file. Verify the __eq__ and __hash__ functions of your Ops. The file is: C:\\Users\\mutation\\AppData\\Local\\Theano\\compiledir_Windows-10-10.0.18362-SP0-Intel64_Family_6_Model_85_Stepping_4_GenuineIntel-3.6.12-64\\tmpjz9ec105\\key.pkl. The key is: (((10, False, (9,)), (\'border_mode\', \'subsample\', \'filter_dilation\', \'num_groups\', \'unshared\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\')), (\'CLinker.cmodule_key\', (\'--param\', \'--param\', \'--param\', \'-DMS_WIN64\', \'-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION\', \'-D_hypot=hypot\', \'-O3\', \'-Wl,-rpath,"C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\bin"\', \'-Wno-unused-label\', \'-Wno-unused-variable\', \'-Wno-write-strings\', \'-fno-math-errno\', \'-m64\', \'-mabm\', \'-madx\', \'-maes\', \'-march=knl\', \'-mavx\', \'-mavx2\', \'-mavx512bw\', \'-mavx512cd\', \'-mavx512dq\', \'-mavx512f\', \'-mbmi\', \'-mbmi2\', \'-mclflushopt\', \'-mclwb\', \'-mcx16\', \'-mf16c\', \'-mfma\', \'-mfsgsbase\', \'-mfxsr\', \'-mhle\', \'-mlzcnt\', \'-mmmx\', \'-mmovbe\', \'-mno-3dnow\', \'-mno-avx512er\', \'-mno-avx512ifma\', \'-mno-avx512pf\', \'-mno-avx512vbmi\', \'-mno-avx512vl\', \'-mno-fma4\', \'-mno-lwp\', \'-mno-mwaitx\', \'-mno-pcommit\', \'-mno-prefetchwt1\', \'-mno-sha\', \'-mno-sse4a\', \'-mno-tbm\', \'-mno-xop\', \'-mpclmul\', \'-mpopcnt\', \'-mprfchw\', \'-mrdrnd\', \'-mrdseed\', \'-mrtm\', \'-msahf\', \'-msse\', \'-msse2\', \'-msse3\', \'-msse4.1\', \'-msse4.2\', \'-mssse3\', \'-mtune=generic\', \'-mxsave\', \'-mxsavec\', \'-mxsaveopt\', \'-mxsaves\', \'l1-cache-line-size=64\', \'l1-cache-size=32\', \'l2-cache-size=11264\'), (\'mkl_core\', \'mkl_intel_thread\', \'mkl_rt\'), (), \'NPY_ABI_VERSION=0x1000009\', \'c_compiler_str="C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\mingw-w64\\\\bin\\\\g++.exe" 5.3.0\', \'md5:m9c3464d5c3cd1492b72c317a15c53eb717da23ada0f044128239eee1002b25f9\', (<theano.tensor.nnet.corr.CorrMM_gradInputs object at 0x00000227AB49FCF8>, ((TensorType(float64, 4D), ((-1, 0), False)), (TensorType(float64, 4D), ((-1, 1), False)), (TensorType(int64, scalar), ((-1, 2), False)), (TensorType(int64, scalar), ((-1, 3), False))), (1, (False,)))))')

======================================================================
FAIL: test_gradweights (test_corr.TestGroupCorr2d)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\tests\test_abstract_conv.py", line 1569, in test_gradweights
    grouped_func = theano.function([img_sym, top_sym], grouped_conv_output, mode=self.mode)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function.py", line 317, in function
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1841, in orig_function
    fn = m.create(defaults)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1715, in create
    input_storage=input_storage_lists, storage_map=storage_map)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 699, in make_thunk
    storage_map=storage_map)[:3]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\vm.py", line 1091, in make_all
    impl=impl))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 955, in make_thunk
    no_recycling)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 858, in make_c_thunk
    output_storage=node_output_storage)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1217, in make_thunk
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1157, in __compile__
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1624, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1155, in module_from_key
    module = self._get_from_hash(module_hash, key, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1065, in _get_from_hash
    self.check_key(key, key_data.key_pkl)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1263, in check_key
    "Ops. The file is: %s. The key is: %s" % (msg, key_pkl, key))
AssertionError: ('The following error happened while compiling the node', CorrMM_gradWeights{valid, (1, 1), (1, 1), 3 False}(img, kern, Elemwise{Cast{int64}}.0, Elemwise{Cast{int64}}.0), '\n', 'Key not found in unpickled KeyData file. Verify the __eq__ and __hash__ functions of your Ops. The file is: C:\\Users\\mutation\\AppData\\Local\\Theano\\compiledir_Windows-10-10.0.18362-SP0-Intel64_Family_6_Model_85_Stepping_4_GenuineIntel-3.6.12-64\\tmp9nmdbitj\\key.pkl. The key is: (((10, False, (9,)), (\'border_mode\', \'subsample\', \'filter_dilation\', \'num_groups\', \'unshared\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\')), (\'CLinker.cmodule_key\', (\'--param\', \'--param\', \'--param\', \'-DMS_WIN64\', \'-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION\', \'-D_hypot=hypot\', \'-O3\', \'-Wl,-rpath,"C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\bin"\', \'-Wno-unused-label\', \'-Wno-unused-variable\', \'-Wno-write-strings\', \'-fno-math-errno\', \'-m64\', \'-mabm\', \'-madx\', \'-maes\', \'-march=knl\', \'-mavx\', \'-mavx2\', \'-mavx512bw\', \'-mavx512cd\', \'-mavx512dq\', \'-mavx512f\', \'-mbmi\', \'-mbmi2\', \'-mclflushopt\', \'-mclwb\', \'-mcx16\', \'-mf16c\', \'-mfma\', \'-mfsgsbase\', \'-mfxsr\', \'-mhle\', \'-mlzcnt\', \'-mmmx\', \'-mmovbe\', \'-mno-3dnow\', \'-mno-avx512er\', \'-mno-avx512ifma\', \'-mno-avx512pf\', \'-mno-avx512vbmi\', \'-mno-avx512vl\', \'-mno-fma4\', \'-mno-lwp\', \'-mno-mwaitx\', \'-mno-pcommit\', \'-mno-prefetchwt1\', \'-mno-sha\', \'-mno-sse4a\', \'-mno-tbm\', \'-mno-xop\', \'-mpclmul\', \'-mpopcnt\', \'-mprfchw\', \'-mrdrnd\', \'-mrdseed\', \'-mrtm\', \'-msahf\', \'-msse\', \'-msse2\', \'-msse3\', \'-msse4.1\', \'-msse4.2\', \'-mssse3\', \'-mtune=generic\', \'-mxsave\', \'-mxsavec\', \'-mxsaveopt\', \'-mxsaves\', \'l1-cache-line-size=64\', \'l1-cache-size=32\', \'l2-cache-size=11264\'), (\'mkl_core\', \'mkl_intel_thread\', \'mkl_rt\'), (), \'NPY_ABI_VERSION=0x1000009\', \'c_compiler_str="C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\mingw-w64\\\\bin\\\\g++.exe" 5.3.0\', \'md5:m9c3464d5c3cd1492b72c317a15c53eb717da23ada0f044128239eee1002b25f9\', (<theano.tensor.nnet.corr.CorrMM_gradWeights object at 0x00000227ABB478D0>, ((TensorType(float64, 4D), ((-1, 0), False)), (TensorType(float64, 4D), ((-1, 1), False)), (TensorType(int64, scalar), ((-1, 2), False)), (TensorType(int64, scalar), ((-1, 3), False))), (1, (False,)))))')

======================================================================
FAIL: test_graph (test_corr.TestGroupCorr2d)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\Users\mutation\Desktop\theano-testcase\tests\test_corr.py", line 429, in test_graph
    gconv_func = theano.function([bottom_sym, kern_sym], conv_group, mode=self.mode)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function.py", line 317, in function
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1841, in orig_function
    fn = m.create(defaults)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1715, in create
    input_storage=input_storage_lists, storage_map=storage_map)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 699, in make_thunk
    storage_map=storage_map)[:3]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\vm.py", line 1091, in make_all
    impl=impl))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 955, in make_thunk
    no_recycling)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 858, in make_c_thunk
    output_storage=node_output_storage)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1217, in make_thunk
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1157, in __compile__
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1624, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1155, in module_from_key
    module = self._get_from_hash(module_hash, key, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1055, in _get_from_hash
    key_data.add_key(key, save_pkl=bool(key[0]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 516, in add_key
    assert key not in self.keys
AssertionError: ('The following error happened while compiling the node', CorrMM{valid, (1, 1), (1, 1), 3 False}(bottom, Subtensor{::, ::, ::int64, ::int64}.0), '\n')

======================================================================
FAIL: test_fwd (test_corr.TestUnsharedCorr2d)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\tests\test_abstract_conv.py", line 1840, in test_fwd
    unshared_func = theano.function([img_sym, kern_sym], unshared_out_sym, mode=self.mode)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function.py", line 317, in function
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1841, in orig_function
    fn = m.create(defaults)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1715, in create
    input_storage=input_storage_lists, storage_map=storage_map)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 699, in make_thunk
    storage_map=storage_map)[:3]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\vm.py", line 1091, in make_all
    impl=impl))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 955, in make_thunk
    no_recycling)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 858, in make_c_thunk
    output_storage=node_output_storage)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1217, in make_thunk
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1157, in __compile__
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1624, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1155, in module_from_key
    module = self._get_from_hash(module_hash, key, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1065, in _get_from_hash
    self.check_key(key, key_data.key_pkl)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1263, in check_key
    "Ops. The file is: %s. The key is: %s" % (msg, key_pkl, key))
AssertionError: ('The following error happened while compiling the node', CorrMM{valid, (2, 1), (1, 1), 3 True}(img, Subtensor{::, ::, ::, ::, ::int64, ::int64}.0), '\n', 'Key not found in unpickled KeyData file. Verify the __eq__ and __hash__ functions of your Ops. The file is: C:\\Users\\mutation\\AppData\\Local\\Theano\\compiledir_Windows-10-10.0.18362-SP0-Intel64_Family_6_Model_85_Stepping_4_GenuineIntel-3.6.12-64\\tmpdws8xz0h\\key.pkl. The key is: (((10, False, (9,)), (\'border_mode\', \'subsample\', \'filter_dilation\', \'num_groups\', \'unshared\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\')), (\'CLinker.cmodule_key\', (\'--param\', \'--param\', \'--param\', \'-DMS_WIN64\', \'-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION\', \'-D_hypot=hypot\', \'-O3\', \'-Wl,-rpath,"C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\bin"\', \'-Wno-unused-label\', \'-Wno-unused-variable\', \'-Wno-write-strings\', \'-fno-math-errno\', \'-m64\', \'-mabm\', \'-madx\', \'-maes\', \'-march=knl\', \'-mavx\', \'-mavx2\', \'-mavx512bw\', \'-mavx512cd\', \'-mavx512dq\', \'-mavx512f\', \'-mbmi\', \'-mbmi2\', \'-mclflushopt\', \'-mclwb\', \'-mcx16\', \'-mf16c\', \'-mfma\', \'-mfsgsbase\', \'-mfxsr\', \'-mhle\', \'-mlzcnt\', \'-mmmx\', \'-mmovbe\', \'-mno-3dnow\', \'-mno-avx512er\', \'-mno-avx512ifma\', \'-mno-avx512pf\', \'-mno-avx512vbmi\', \'-mno-avx512vl\', \'-mno-fma4\', \'-mno-lwp\', \'-mno-mwaitx\', \'-mno-pcommit\', \'-mno-prefetchwt1\', \'-mno-sha\', \'-mno-sse4a\', \'-mno-tbm\', \'-mno-xop\', \'-mpclmul\', \'-mpopcnt\', \'-mprfchw\', \'-mrdrnd\', \'-mrdseed\', \'-mrtm\', \'-msahf\', \'-msse\', \'-msse2\', \'-msse3\', \'-msse4.1\', \'-msse4.2\', \'-mssse3\', \'-mtune=generic\', \'-mxsave\', \'-mxsavec\', \'-mxsaveopt\', \'-mxsaves\', \'l1-cache-line-size=64\', \'l1-cache-size=32\', \'l2-cache-size=11264\'), (\'mkl_core\', \'mkl_intel_thread\', \'mkl_rt\'), (), \'NPY_ABI_VERSION=0x1000009\', \'c_compiler_str="C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\mingw-w64\\\\bin\\\\g++.exe" 5.3.0\', \'md5:m9c3464d5c3cd1492b72c317a15c53eb717da23ada0f044128239eee1002b25f9\', (<theano.tensor.nnet.corr.CorrMM object at 0x00000227AB7FADD8>, ((TensorType(float64, 4D), ((-1, 0), False)), (TensorType(float64, 6D), ((-1, 1), False))), (1, (False,)))))')

======================================================================
FAIL: test_gradinput (test_corr.TestUnsharedCorr2d)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\tests\test_abstract_conv.py", line 1920, in test_gradinput
    unshared_func = theano.function([kern_sym, top_sym], unshared_out_sym, mode=self.mode)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function.py", line 317, in function
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1841, in orig_function
    fn = m.create(defaults)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1715, in create
    input_storage=input_storage_lists, storage_map=storage_map)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 699, in make_thunk
    storage_map=storage_map)[:3]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\vm.py", line 1091, in make_all
    impl=impl))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 955, in make_thunk
    no_recycling)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 858, in make_c_thunk
    output_storage=node_output_storage)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1217, in make_thunk
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1157, in __compile__
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1624, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1155, in module_from_key
    module = self._get_from_hash(module_hash, key, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1065, in _get_from_hash
    self.check_key(key, key_data.key_pkl)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1263, in check_key
    "Ops. The file is: %s. The key is: %s" % (msg, key_pkl, key))
AssertionError: ('The following error happened while compiling the node', CorrMM_gradInputs{valid, (2, 1), (1, 1), 3 True}(Subtensor{::, ::, ::, ::, ::int64, ::int64}.0, top, Elemwise{Cast{int64}}.0, Elemwise{Cast{int64}}.0), '\n', 'Key not found in unpickled KeyData file. Verify the __eq__ and __hash__ functions of your Ops. The file is: C:\\Users\\mutation\\AppData\\Local\\Theano\\compiledir_Windows-10-10.0.18362-SP0-Intel64_Family_6_Model_85_Stepping_4_GenuineIntel-3.6.12-64\\tmpjz9ec105\\key.pkl. The key is: (((10, False, (9,)), (\'border_mode\', \'subsample\', \'filter_dilation\', \'num_groups\', \'unshared\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\')), (\'CLinker.cmodule_key\', (\'--param\', \'--param\', \'--param\', \'-DMS_WIN64\', \'-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION\', \'-D_hypot=hypot\', \'-O3\', \'-Wl,-rpath,"C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\bin"\', \'-Wno-unused-label\', \'-Wno-unused-variable\', \'-Wno-write-strings\', \'-fno-math-errno\', \'-m64\', \'-mabm\', \'-madx\', \'-maes\', \'-march=knl\', \'-mavx\', \'-mavx2\', \'-mavx512bw\', \'-mavx512cd\', \'-mavx512dq\', \'-mavx512f\', \'-mbmi\', \'-mbmi2\', \'-mclflushopt\', \'-mclwb\', \'-mcx16\', \'-mf16c\', \'-mfma\', \'-mfsgsbase\', \'-mfxsr\', \'-mhle\', \'-mlzcnt\', \'-mmmx\', \'-mmovbe\', \'-mno-3dnow\', \'-mno-avx512er\', \'-mno-avx512ifma\', \'-mno-avx512pf\', \'-mno-avx512vbmi\', \'-mno-avx512vl\', \'-mno-fma4\', \'-mno-lwp\', \'-mno-mwaitx\', \'-mno-pcommit\', \'-mno-prefetchwt1\', \'-mno-sha\', \'-mno-sse4a\', \'-mno-tbm\', \'-mno-xop\', \'-mpclmul\', \'-mpopcnt\', \'-mprfchw\', \'-mrdrnd\', \'-mrdseed\', \'-mrtm\', \'-msahf\', \'-msse\', \'-msse2\', \'-msse3\', \'-msse4.1\', \'-msse4.2\', \'-mssse3\', \'-mtune=generic\', \'-mxsave\', \'-mxsavec\', \'-mxsaveopt\', \'-mxsaves\', \'l1-cache-line-size=64\', \'l1-cache-size=32\', \'l2-cache-size=11264\'), (\'mkl_core\', \'mkl_intel_thread\', \'mkl_rt\'), (), \'NPY_ABI_VERSION=0x1000009\', \'c_compiler_str="C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\mingw-w64\\\\bin\\\\g++.exe" 5.3.0\', \'md5:m9c3464d5c3cd1492b72c317a15c53eb717da23ada0f044128239eee1002b25f9\', (<theano.tensor.nnet.corr.CorrMM_gradInputs object at 0x00000227AB3F4C18>, ((TensorType(float64, 6D), ((-1, 0), False)), (TensorType(float64, 4D), ((-1, 1), False)), (TensorType(int64, scalar), ((-1, 2), False)), (TensorType(int64, scalar), ((-1, 3), False))), (1, (False,)))))')

======================================================================
FAIL: test_gradweight (test_corr.TestUnsharedCorr2d)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\tensor\nnet\tests\test_abstract_conv.py", line 1876, in test_gradweight
    unshared_func = theano.function([img_sym, top_sym], unshared_out_sym, mode=self.mode)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function.py", line 317, in function
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1841, in orig_function
    fn = m.create(defaults)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\compile\function_module.py", line 1715, in create
    input_storage=input_storage_lists, storage_map=storage_map)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\link.py", line 699, in make_thunk
    storage_map=storage_map)[:3]
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\vm.py", line 1091, in make_all
    impl=impl))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 955, in make_thunk
    no_recycling)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\op.py", line 858, in make_c_thunk
    output_storage=node_output_storage)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1217, in make_thunk
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1157, in __compile__
    keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cc.py", line 1624, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1155, in module_from_key
    module = self._get_from_hash(module_hash, key, keep_lock=keep_lock)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1065, in _get_from_hash
    self.check_key(key, key_data.key_pkl)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\theano\gof\cmodule.py", line 1263, in check_key
    "Ops. The file is: %s. The key is: %s" % (msg, key_pkl, key))
AssertionError: ('The following error happened while compiling the node', CorrMM_gradWeights{valid, (2, 1), (1, 1), 3 True}(img, top, Elemwise{Cast{int64}}.0, Elemwise{Cast{int64}}.0), '\n', 'Key not found in unpickled KeyData file. Verify the __eq__ and __hash__ functions of your Ops. The file is: C:\\Users\\mutation\\AppData\\Local\\Theano\\compiledir_Windows-10-10.0.18362-SP0-Intel64_Family_6_Model_85_Stepping_4_GenuineIntel-3.6.12-64\\tmp9nmdbitj\\key.pkl. The key is: (((10, False, (9,)), (\'border_mode\', \'subsample\', \'filter_dilation\', \'num_groups\', \'unshared\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\'), (11, 13, \'1.18.5\')), (\'CLinker.cmodule_key\', (\'--param\', \'--param\', \'--param\', \'-DMS_WIN64\', \'-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION\', \'-D_hypot=hypot\', \'-O3\', \'-Wl,-rpath,"C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\bin"\', \'-Wno-unused-label\', \'-Wno-unused-variable\', \'-Wno-write-strings\', \'-fno-math-errno\', \'-m64\', \'-mabm\', \'-madx\', \'-maes\', \'-march=knl\', \'-mavx\', \'-mavx2\', \'-mavx512bw\', \'-mavx512cd\', \'-mavx512dq\', \'-mavx512f\', \'-mbmi\', \'-mbmi2\', \'-mclflushopt\', \'-mclwb\', \'-mcx16\', \'-mf16c\', \'-mfma\', \'-mfsgsbase\', \'-mfxsr\', \'-mhle\', \'-mlzcnt\', \'-mmmx\', \'-mmovbe\', \'-mno-3dnow\', \'-mno-avx512er\', \'-mno-avx512ifma\', \'-mno-avx512pf\', \'-mno-avx512vbmi\', \'-mno-avx512vl\', \'-mno-fma4\', \'-mno-lwp\', \'-mno-mwaitx\', \'-mno-pcommit\', \'-mno-prefetchwt1\', \'-mno-sha\', \'-mno-sse4a\', \'-mno-tbm\', \'-mno-xop\', \'-mpclmul\', \'-mpopcnt\', \'-mprfchw\', \'-mrdrnd\', \'-mrdseed\', \'-mrtm\', \'-msahf\', \'-msse\', \'-msse2\', \'-msse3\', \'-msse4.1\', \'-msse4.2\', \'-mssse3\', \'-mtune=generic\', \'-mxsave\', \'-mxsavec\', \'-mxsaveopt\', \'-mxsaves\', \'l1-cache-line-size=64\', \'l1-cache-size=32\', \'l2-cache-size=11264\'), (\'mkl_core\', \'mkl_intel_thread\', \'mkl_rt\'), (), \'NPY_ABI_VERSION=0x1000009\', \'c_compiler_str="C:\\\\ProgramData\\\\Anaconda3\\\\envs\\\\keras\\\\Library\\\\mingw-w64\\\\bin\\\\g++.exe" 5.3.0\', \'md5:m9c3464d5c3cd1492b72c317a15c53eb717da23ada0f044128239eee1002b25f9\', (<theano.tensor.nnet.corr.CorrMM_gradWeights object at 0x00000227ABD76898>, ((TensorType(float64, 4D), ((-1, 0), False)), (TensorType(float64, 4D), ((-1, 1), False)), (TensorType(int64, scalar), ((-1, 2), False)), (TensorType(int64, scalar), ((-1, 3), False))), (1, (False,)))))')

----------------------------------------------------------------------
Ran 34 tests in 82.682s

FAILED (failures=7)
