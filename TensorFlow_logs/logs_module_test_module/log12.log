2020-10-05 21:20:34.880043: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
Running tests under Python 3.6.12: C:\ProgramData\Anaconda3\envs\keras\python.exe
[ RUN      ] AbcTest.testAbstract
[       OK ] AbcTest.testAbstract
[ RUN      ] AbcTest.testConcrete
[       OK ] AbcTest.testConcrete
[ RUN      ] AbcTest.test_session
[  SKIPPED ] AbcTest.test_session
[ RUN      ] FlattenTest.test_attribute_traversal_key
WARNING:tensorflow:From C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W1005 21:20:37.582230 21792 deprecation.py:506] From C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
[       OK ] FlattenTest.test_attribute_traversal_key
[ RUN      ] FlattenTest.test_attributes_to_ignore
[  FAILED  ] FlattenTest.test_attributes_to_ignore
[ RUN      ] FlattenTest.test_flatten0 (<function FlattenTest.<lambda> at 0x00000215C0C93730>)
[  FAILED  ] FlattenTest.test_flatten0 (<function FlattenTest.<lambda> at 0x00000215C0C93730>)
[ RUN      ] FlattenTest.test_flatten1 (<class 'list'>)
[  FAILED  ] FlattenTest.test_flatten1 (<class 'list'>)
[ RUN      ] FlattenTest.test_flatten2 (<class 'tuple'>)
[  FAILED  ] FlattenTest.test_flatten2 (<class 'tuple'>)
[ RUN      ] FlattenTest.test_flatten3 (<function <lambda> at 0x00000215C0C88EA0>)
[  FAILED  ] FlattenTest.test_flatten3 (<function <lambda> at 0x00000215C0C88EA0>)
[ RUN      ] FlattenTest.test_model_discover_submodule
[  FAILED  ] FlattenTest.test_model_discover_submodule
[ RUN      ] FlattenTest.test_module_discover_layer_variable
[  FAILED  ] FlattenTest.test_module_discover_layer_variable
[ RUN      ] FlattenTest.test_session
[  SKIPPED ] FlattenTest.test_session
[ RUN      ] FlattenTest.test_with_path
[  FAILED  ] FlattenTest.test_with_path
[ RUN      ] ForwardMethodsTest.testEntersNameScope_call
2020-10-05 21:20:37.636844: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-10-05 21:20:37.765026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:37.765557: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:37.769065: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:37.772507: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:37.774096: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:37.778755: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:37.781995: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:37.791434: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:37.792416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:37.792944: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
2020-10-05 21:20:37.807712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:37.808266: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:37.808613: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:37.808954: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:37.809298: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:37.809664: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:37.810008: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:37.810356: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:37.811205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:38.755912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:38.756723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:38.756940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:38.757719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
WARNING:tensorflow:From C:\ProgramData\Anaconda3\envs\keras\lib\contextlib.py:60: TensorFlowTestCase.test_session (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `self.session()` or `self.cached_session()` instead.
W1005 21:20:38.785118 21792 deprecation.py:323] From C:\ProgramData\Anaconda3\envs\keras\lib\contextlib.py:60: TensorFlowTestCase.test_session (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `self.session()` or `self.cached_session()` instead.
2020-10-05 21:20:38.787980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:38.788498: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:38.788840: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:38.789201: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:38.789541: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:38.789892: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:38.790237: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:38.790582: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:38.791153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:38.791458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:38.791877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:38.792099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:38.792611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
[       OK ] ForwardMethodsTest.testEntersNameScope_call
[ RUN      ] ForwardMethodsTest.testEntersNameScope_concreteFunction
WARNING:tensorflow:Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x00000215C0DCAA60> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
W1005 21:20:40.112982 21792 ag_logging.py:146] Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x00000215C0DCAA60> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
2020-10-05 21:20:40.127150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:40.127686: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:40.128044: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:40.128396: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:40.128825: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:40.129259: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:40.129701: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:40.130129: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:40.130723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:40.131048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:40.131412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:40.131642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:40.132247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
WARNING:tensorflow:Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x00000218236DF1E0> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
W1005 21:20:40.237914 21792 ag_logging.py:146] Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x00000218236DF1E0> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
[       OK ] ForwardMethodsTest.testEntersNameScope_concreteFunction
[ RUN      ] ForwardMethodsTest.testFunctionType
[       OK ] ForwardMethodsTest.testFunctionType
[ RUN      ] ForwardMethodsTest.test_session
[  SKIPPED ] ForwardMethodsTest.test_session
[ RUN      ] ModuleTrackingTest.test_non_ctor_submodule
[       OK ] ModuleTrackingTest.test_non_ctor_submodule
[ RUN      ] ModuleTrackingTest.test_session
[  SKIPPED ] ModuleTrackingTest.test_session
[ RUN      ] ModuleTrackingTest.test_submodules
[       OK ] ModuleTrackingTest.test_submodules
[ RUN      ] NameScopeTest.test_memoized_in_tf2
[  SKIPPED ] NameScopeTest.test_memoized_in_tf2
[ RUN      ] NameScopeTest.test_not_memoized_in_tf1
[       OK ] NameScopeTest.test_not_memoized_in_tf1
[ RUN      ] NameScopeTest.test_session
[  SKIPPED ] NameScopeTest.test_session
[ RUN      ] TestModuleNaming.test_construct_in_scope
[       OK ] TestModuleNaming.test_construct_in_scope
[ RUN      ] TestModuleNaming.test_ctor_error_closes_name_scope
[       OK ] TestModuleNaming.test_ctor_error_closes_name_scope
[ RUN      ] TestModuleNaming.test_ctor_error_handles_ctor_not_opening_name_scope
[       OK ] TestModuleNaming.test_ctor_error_handles_ctor_not_opening_name_scope
[ RUN      ] TestModuleNaming.test_does_not_evaluate_property_methods
[       OK ] TestModuleNaming.test_does_not_evaluate_property_methods
[ RUN      ] TestModuleNaming.test_enters_name_scope_in_call
[       OK ] TestModuleNaming.test_enters_name_scope_in_call
[ RUN      ] TestModuleNaming.test_enters_name_scope_in_other_method
[       OK ] TestModuleNaming.test_enters_name_scope_in_other_method
[ RUN      ] TestModuleNaming.test_forward_method_closes_name_scope
[       OK ] TestModuleNaming.test_forward_method_closes_name_scope
[ RUN      ] TestModuleNaming.test_get_attr_doesnt_enter_name_scope
[       OK ] TestModuleNaming.test_get_attr_doesnt_enter_name_scope
[ RUN      ] TestModuleNaming.test_get_attribute_doesnt_enter_name_scope
[       OK ] TestModuleNaming.test_get_attribute_doesnt_enter_name_scope
[ RUN      ] TestModuleNaming.test_invalid_name
[       OK ] TestModuleNaming.test_invalid_name
[ RUN      ] TestModuleNaming.test_module_numbering_in_graph
2020-10-05 21:20:40.296913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:40.297769: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:40.298345: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:40.298916: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:40.299256: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:40.299600: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:40.299949: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:40.300316: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:40.301023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:40.301357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:40.301740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:40.301960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:40.302468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
[  SKIPPED ] TestModuleNaming.test_module_numbering_in_graph
[ RUN      ] TestModuleNaming.test_modules_not_numbered_in_eager
2020-10-05 21:20:40.314848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:40.315375: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:40.315739: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:40.316110: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:40.316550: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:40.316974: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:40.317394: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:40.317742: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:40.318308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:40.318618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:40.318979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:40.319206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:40.319702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
[       OK ] TestModuleNaming.test_modules_not_numbered_in_eager
[ RUN      ] TestModuleNaming.test_overridden_name_scope
[       OK ] TestModuleNaming.test_overridden_name_scope
[ RUN      ] TestModuleNaming.test_patched_callable
[       OK ] TestModuleNaming.test_patched_callable
[ RUN      ] TestModuleNaming.test_property
[       OK ] TestModuleNaming.test_property
[ RUN      ] TestModuleNaming.test_property_no_name_scope
[       OK ] TestModuleNaming.test_property_no_name_scope
[ RUN      ] TestModuleNaming.test_session
[  SKIPPED ] TestModuleNaming.test_session
[ RUN      ] TestModuleNaming.test_single_name
[       OK ] TestModuleNaming.test_single_name
[ RUN      ] TestModuleNaming.test_subclassed_module
[       OK ] TestModuleNaming.test_subclassed_module
[ RUN      ] TestModuleNaming.test_submodule_created_late
[       OK ] TestModuleNaming.test_submodule_created_late
[ RUN      ] VariableNamingTest.test_session
[  SKIPPED ] VariableNamingTest.test_session
[ RUN      ] VariableNamingTest.test_variable_names
[       OK ] VariableNamingTest.test_variable_names
[ RUN      ] VariableTrackingTest.test_session
[  SKIPPED ] VariableTrackingTest.test_session
[ RUN      ] VariableTrackingTest.test_supports_distributed_variables
[       OK ] VariableTrackingTest.test_supports_distributed_variables
[ RUN      ] VariableTrackingTest.test_trainable_variables
[       OK ] VariableTrackingTest.test_trainable_variables
[ RUN      ] VariableTrackingTest.test_trainable_variables_ignores_non_trainable
[       OK ] VariableTrackingTest.test_trainable_variables_ignores_non_trainable
[ RUN      ] VariableTrackingTest.test_variables
[       OK ] VariableTrackingTest.test_variables
======================================================================
ERROR: test_model_discover_submodule (__main__.FlattenTest)
FlattenTest.test_model_discover_submodule
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 1072, in test_model_discover_submodule
    self.assertEqual(m.submodules, (m.layers[0], m.layers[1]))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\module\module.py", line 193, in submodules
    return tuple(self._flatten(predicate=_is_module))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\module\module.py", line 339, in _flatten_module
    for leaf_path, leaf in nest.flatten_with_tuple_paths(module_dict[key]):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\util\nest.py", line 1327, in flatten_with_tuple_paths
    flatten(structure, expand_composites=expand_composites)))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\util\nest.py", line 263, in flatten
    return _pywrap_tensorflow.Flatten(structure, expand_composites)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\pywrap_tensorflow_internal.py", line 2651, in Flatten
    return _pywrap_tensorflow_internal.Flatten(nested, expand_composites)
TypeError: '<' not supported between instances of 'Dense' and 'Dense'

======================================================================
ERROR: test_module_discover_layer_variable (__main__.FlattenTest)
FlattenTest.test_module_discover_layer_variable
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 1036, in test_module_discover_layer_variable
    self.assertEmpty(m.variables)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\module\module.py", line 155, in variables
    return tuple(self._flatten(predicate=_is_variable))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\module\module.py", line 370, in _flatten_module
    for subvalue in subvalues:
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\module\module.py", line 339, in _flatten_module
    for leaf_path, leaf in nest.flatten_with_tuple_paths(module_dict[key]):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\util\nest.py", line 1327, in flatten_with_tuple_paths
    flatten(structure, expand_composites=expand_composites)))
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\util\nest.py", line 263, in flatten
    return _pywrap_tensorflow.Flatten(structure, expand_composites)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\pywrap_tensorflow_internal.py", line 2651, in Flatten
    return _pywrap_tensorflow_internal.Flatten(nested, expand_composites)
TypeError: '<' not supported between instances of 'function' and 'int'

======================================================================
FAIL: test_attributes_to_ignore (__main__.FlattenTest)
FlattenTest.test_attributes_to_ignore
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 982, in test_attributes_to_ignore
    self.assertEmpty(mod.submodules)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\absltest.py", line 894, in assertEmpty
    self.fail('{!r} has length of {}.'.format(container, len(container)), msg)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\absltest.py", line 1764, in fail
    return super(TestCase, self).fail(self._formatMessage(prefix, msg))
AssertionError: (<tensorflow.python.module.module.Module object at 0x00000215C0CB9358>,) has length of 1.

======================================================================
FAIL: test_flatten0 (<function FlattenTest.<lambda> at 0x00000215C0C93730>) (__main__.FlattenTest)
FlattenTest.test_flatten0 (<function FlattenTest.<lambda> at 0x00000215C0C93730>)
test_flatten(<function FlattenTest.<lambda> at 0x00000215C0C93730>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: [] != [<__main__.MemberType object at 0x00000215[109 chars]320>]

Second list contains 3 additional elements.
First extra element 0:
<__main__.MemberType object at 0x00000215C0CF0358>

- []
+ [<__main__.MemberType object at 0x00000215C0CF0358>,
+  <__main__.MemberType object at 0x00000215C0D02E10>,
+  <__main__.MemberType object at 0x00000215C0CF0320>]

======================================================================
FAIL: test_flatten1 (<class 'list'>) (__main__.FlattenTest)
FlattenTest.test_flatten1 (<class 'list'>)
test_flatten(<class 'list'>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: [<__m[88 chars]5C0D02E48>] != [<__m[88 chars]5C0D02E48>, <__main__.MemberType object at 0x00000215C0CAEAC8>]

Second list contains 1 additional elements.
First extra element 2:
<__main__.MemberType object at 0x00000215C0CAEAC8>

  [<__main__.MemberType object at 0x00000215C0CAE9E8>,
-  <__main__.MemberType object at 0x00000215C0D02E48>]
?                                                    ^

+  <__main__.MemberType object at 0x00000215C0D02E48>,
?                                                    ^

+  <__main__.MemberType object at 0x00000215C0CAEAC8>]

======================================================================
FAIL: test_flatten2 (<class 'tuple'>) (__main__.FlattenTest)
FlattenTest.test_flatten2 (<class 'tuple'>)
test_flatten(<class 'tuple'>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: [] != [<__main__.MemberType object at 0x00000215[109 chars]320>]

Second list contains 3 additional elements.
First extra element 0:
<__main__.MemberType object at 0x00000215C0CF0630>

- []
+ [<__main__.MemberType object at 0x00000215C0CF0630>,
+  <__main__.MemberType object at 0x00000215C0D02EB8>,
+  <__main__.MemberType object at 0x00000215C0CF0320>]

======================================================================
FAIL: test_flatten3 (<function <lambda> at 0x00000215C0C88EA0>) (__main__.FlattenTest)
FlattenTest.test_flatten3 (<function <lambda> at 0x00000215C0C88EA0>)
test_flatten(<function <lambda> at 0x00000215C0C88EA0>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: [<__m[88 chars]5C0D02E80>] != [<__m[88 chars]5C0D02E80>, <__main__.MemberType object at 0x00000215C0CAEAC8>]

Second list contains 1 additional elements.
First extra element 2:
<__main__.MemberType object at 0x00000215C0CAEAC8>

  [<__main__.MemberType object at 0x00000215C0CAE9E8>,
-  <__main__.MemberType object at 0x00000215C0D02E80>]
?                                                    ^

+  <__main__.MemberType object at 0x00000215C0D02E80>,
?                                                    ^

+  <__main__.MemberType object at 0x00000215C0CAEAC8>]

======================================================================
FAIL: test_with_path (__main__.FlattenTest)
FlattenTest.test_with_path
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 1020, in test_with_path
    ("decoder", "w", 0, 1, "k"): mod.decoder.w[0][1]["k"]},)
AssertionError: {('_self_unconditional_checkpoint_dependencies', 0, 'ref'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('_self_unconditional_dependency_names', 'w'): <tf.Variable 'Variable:0' shape=() dtype=float32>} != {('decoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('decoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('encoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('encoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('w',): <tf.Variable 'Variable:0' shape=() dtype=float32>}
Unexpected, but present entries:
('decoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('decoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('encoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('encoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('w',): <tf.Variable 'Variable:0' shape=() dtype=float32>

Missing entries:
('_self_unconditional_checkpoint_dependencies', 0, 'ref'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 1, 'ref', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_checkpoint_dependencies', 2, 'ref', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'decoder', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_checkpoint_dependencies', 0, 'ref', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_dependency_names', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'encoder', '_self_unconditional_dependency_names', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>
('_self_unconditional_dependency_names', 'w'): <tf.Variable 'Variable:0' shape=() dtype=float32>


----------------------------------------------------------------------
Ran 50 tests in 2.812s

FAILED (failures=6, errors=2, skipped=10)
