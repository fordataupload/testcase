2020-10-05 21:20:47.319753: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
Running tests under Python 3.6.12: C:\ProgramData\Anaconda3\envs\keras\python.exe
[ RUN      ] AbcTest.testAbstract
[       OK ] AbcTest.testAbstract
[ RUN      ] AbcTest.testConcrete
[       OK ] AbcTest.testConcrete
[ RUN      ] AbcTest.test_session
[  SKIPPED ] AbcTest.test_session
[ RUN      ] FlattenTest.test_attribute_traversal_key
WARNING:tensorflow:From C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W1005 21:20:49.968777 14404 deprecation.py:506] From C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
2020-10-05 21:20:49.996893: W tensorflow/python/util/util.cc:299] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
[  FAILED  ] FlattenTest.test_attribute_traversal_key
[ RUN      ] FlattenTest.test_attributes_to_ignore
[  FAILED  ] FlattenTest.test_attributes_to_ignore
[ RUN      ] FlattenTest.test_flatten0 (<function FlattenTest.<lambda> at 0x0000020DCE923730>)
[  FAILED  ] FlattenTest.test_flatten0 (<function FlattenTest.<lambda> at 0x0000020DCE923730>)
[ RUN      ] FlattenTest.test_flatten1 (<class 'list'>)
[  FAILED  ] FlattenTest.test_flatten1 (<class 'list'>)
[ RUN      ] FlattenTest.test_flatten2 (<class 'tuple'>)
[  FAILED  ] FlattenTest.test_flatten2 (<class 'tuple'>)
[ RUN      ] FlattenTest.test_flatten3 (<function <lambda> at 0x0000020DCE919EA0>)
[  FAILED  ] FlattenTest.test_flatten3 (<function <lambda> at 0x0000020DCE919EA0>)
[ RUN      ] FlattenTest.test_model_discover_submodule
[  FAILED  ] FlattenTest.test_model_discover_submodule
[ RUN      ] FlattenTest.test_module_discover_layer_variable
[  FAILED  ] FlattenTest.test_module_discover_layer_variable
[ RUN      ] FlattenTest.test_session
[  SKIPPED ] FlattenTest.test_session
[ RUN      ] FlattenTest.test_with_path
[  FAILED  ] FlattenTest.test_with_path
[ RUN      ] ForwardMethodsTest.testEntersNameScope_call
2020-10-05 21:20:50.032418: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-10-05 21:20:50.160485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:50.161018: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:50.164452: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:50.167817: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:50.169392: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:50.174299: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:50.177512: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:50.186722: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:50.188164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:50.188969: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
2020-10-05 21:20:50.202323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:50.202972: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:50.203416: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:50.203880: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:50.204329: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:50.204757: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:50.205142: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:50.205533: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:50.206456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:51.149949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:51.150366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:51.150599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:51.151354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
WARNING:tensorflow:From C:\ProgramData\Anaconda3\envs\keras\lib\contextlib.py:60: TensorFlowTestCase.test_session (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `self.session()` or `self.cached_session()` instead.
W1005 21:20:51.171665 14404 deprecation.py:323] From C:\ProgramData\Anaconda3\envs\keras\lib\contextlib.py:60: TensorFlowTestCase.test_session (from tensorflow.python.framework.test_util) is deprecated and will be removed in a future version.
Instructions for updating:
Use `self.session()` or `self.cached_session()` instead.
2020-10-05 21:20:51.182129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:51.182650: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:51.182989: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:51.183349: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:51.183696: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:51.184039: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:51.184388: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:51.184742: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:51.185312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:51.185688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:51.186042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:51.186264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:51.186775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
[       OK ] ForwardMethodsTest.testEntersNameScope_call
[ RUN      ] ForwardMethodsTest.testEntersNameScope_concreteFunction
WARNING:tensorflow:Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x0000020DCEA80950> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
W1005 21:20:52.499528 14404 ag_logging.py:146] Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x0000020DCEA80950> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
2020-10-05 21:20:52.504033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:52.504603: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:52.504984: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:52.505334: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:52.505677: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:52.506031: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:52.506380: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:52.506731: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:52.507313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:52.507624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:52.507988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:52.508212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:52.508720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
WARNING:tensorflow:Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x00000210206C40D0> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
W1005 21:20:52.624504 14404 ag_logging.py:146] Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x00000210206C40D0> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 'NoneType' object has no attribute '_fields'
[       OK ] ForwardMethodsTest.testEntersNameScope_concreteFunction
[ RUN      ] ForwardMethodsTest.testFunctionType
[       OK ] ForwardMethodsTest.testFunctionType
[ RUN      ] ForwardMethodsTest.test_session
[  SKIPPED ] ForwardMethodsTest.test_session
[ RUN      ] ModuleTrackingTest.test_non_ctor_submodule
[  FAILED  ] ModuleTrackingTest.test_non_ctor_submodule
[ RUN      ] ModuleTrackingTest.test_session
[  SKIPPED ] ModuleTrackingTest.test_session
[ RUN      ] ModuleTrackingTest.test_submodules
[  FAILED  ] ModuleTrackingTest.test_submodules
[ RUN      ] NameScopeTest.test_memoized_in_tf2
[  SKIPPED ] NameScopeTest.test_memoized_in_tf2
[ RUN      ] NameScopeTest.test_not_memoized_in_tf1
[       OK ] NameScopeTest.test_not_memoized_in_tf1
[ RUN      ] NameScopeTest.test_session
[  SKIPPED ] NameScopeTest.test_session
[ RUN      ] TestModuleNaming.test_construct_in_scope
[       OK ] TestModuleNaming.test_construct_in_scope
[ RUN      ] TestModuleNaming.test_ctor_error_closes_name_scope
[       OK ] TestModuleNaming.test_ctor_error_closes_name_scope
[ RUN      ] TestModuleNaming.test_ctor_error_handles_ctor_not_opening_name_scope
[       OK ] TestModuleNaming.test_ctor_error_handles_ctor_not_opening_name_scope
[ RUN      ] TestModuleNaming.test_does_not_evaluate_property_methods
[       OK ] TestModuleNaming.test_does_not_evaluate_property_methods
[ RUN      ] TestModuleNaming.test_enters_name_scope_in_call
[       OK ] TestModuleNaming.test_enters_name_scope_in_call
[ RUN      ] TestModuleNaming.test_enters_name_scope_in_other_method
[       OK ] TestModuleNaming.test_enters_name_scope_in_other_method
[ RUN      ] TestModuleNaming.test_forward_method_closes_name_scope
[       OK ] TestModuleNaming.test_forward_method_closes_name_scope
[ RUN      ] TestModuleNaming.test_get_attr_doesnt_enter_name_scope
[       OK ] TestModuleNaming.test_get_attr_doesnt_enter_name_scope
[ RUN      ] TestModuleNaming.test_get_attribute_doesnt_enter_name_scope
[       OK ] TestModuleNaming.test_get_attribute_doesnt_enter_name_scope
[ RUN      ] TestModuleNaming.test_invalid_name
[       OK ] TestModuleNaming.test_invalid_name
[ RUN      ] TestModuleNaming.test_module_numbering_in_graph
2020-10-05 21:20:52.656348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:52.656916: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:52.657260: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:52.657603: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:52.657939: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:52.658278: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:52.658624: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:52.658984: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:52.659568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:52.659877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:52.660231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:52.660512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:52.661098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
[  SKIPPED ] TestModuleNaming.test_module_numbering_in_graph
[ RUN      ] TestModuleNaming.test_modules_not_numbered_in_eager
2020-10-05 21:20:52.673615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-05 21:20:52.674130: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-05 21:20:52.674499: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-05 21:20:52.674845: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-05 21:20:52.675181: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-05 21:20:52.675528: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-05 21:20:52.675872: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-05 21:20:52.676216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-05 21:20:52.676783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-05 21:20:52.677085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-05 21:20:52.677457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-05 21:20:52.677678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-05 21:20:52.678178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
[       OK ] TestModuleNaming.test_modules_not_numbered_in_eager
[ RUN      ] TestModuleNaming.test_overridden_name_scope
[       OK ] TestModuleNaming.test_overridden_name_scope
[ RUN      ] TestModuleNaming.test_patched_callable
[       OK ] TestModuleNaming.test_patched_callable
[ RUN      ] TestModuleNaming.test_property
[       OK ] TestModuleNaming.test_property
[ RUN      ] TestModuleNaming.test_property_no_name_scope
[       OK ] TestModuleNaming.test_property_no_name_scope
[ RUN      ] TestModuleNaming.test_session
[  SKIPPED ] TestModuleNaming.test_session
[ RUN      ] TestModuleNaming.test_single_name
[       OK ] TestModuleNaming.test_single_name
[ RUN      ] TestModuleNaming.test_subclassed_module
[       OK ] TestModuleNaming.test_subclassed_module
[ RUN      ] TestModuleNaming.test_submodule_created_late
[       OK ] TestModuleNaming.test_submodule_created_late
[ RUN      ] VariableNamingTest.test_session
[  SKIPPED ] VariableNamingTest.test_session
[ RUN      ] VariableNamingTest.test_variable_names
[       OK ] VariableNamingTest.test_variable_names
[ RUN      ] VariableTrackingTest.test_session
[  SKIPPED ] VariableTrackingTest.test_session
[ RUN      ] VariableTrackingTest.test_supports_distributed_variables
[  FAILED  ] VariableTrackingTest.test_supports_distributed_variables
[ RUN      ] VariableTrackingTest.test_trainable_variables
[  FAILED  ] VariableTrackingTest.test_trainable_variables
[ RUN      ] VariableTrackingTest.test_trainable_variables_ignores_non_trainable
[  FAILED  ] VariableTrackingTest.test_trainable_variables_ignores_non_trainable
[ RUN      ] VariableTrackingTest.test_variables
[  FAILED  ] VariableTrackingTest.test_variables
======================================================================
ERROR: test_non_ctor_submodule (__main__.ModuleTrackingTest)
ModuleTrackingTest.test_non_ctor_submodule
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 560, in test_non_ctor_submodule
    self.assertEqual(set(m.submodules), {leaf1})
TypeError: unhashable type: 'set'

======================================================================
FAIL: test_attribute_traversal_key (__main__.FlattenTest)
FlattenTest.test_attribute_traversal_key
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 954, in test_attribute_traversal_key
    mod._trainable_variables + mod._non_trainable_variables + [mod._bonus])
AssertionError: [<tf.Variable 'a:0' shape=() dtype=float3[224 chars], -1] != ListWrapper([<tf.Variable 'a:0' shape=() [187 chars]32>])

======================================================================
FAIL: test_attributes_to_ignore (__main__.FlattenTest)
FlattenTest.test_attributes_to_ignore
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 982, in test_attributes_to_ignore
    self.assertEmpty(mod.submodules)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\absltest.py", line 894, in assertEmpty
    self.fail('{!r} has length of {}.'.format(container, len(container)), msg)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\absltest.py", line 1764, in fail
    return super(TestCase, self).fail(self._formatMessage(prefix, msg))
AssertionError: ('dangerous_module', 'dangerous_module/', set(), True, -1, <tf.Variable 'Variable_1:0' shape=() dtype=float32>) has length of 6.

======================================================================
FAIL: test_flatten0 (<function FlattenTest.<lambda> at 0x0000020DCE923730>) (__main__.FlattenTest)
FlattenTest.test_flatten0 (<function FlattenTest.<lambda> at 0x0000020DCE923730>)
test_flatten(<function FlattenTest.<lambda> at 0x0000020DCE923730>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: ['simple_module', 'simple_module/', set(),[215 chars]748>] != [<__main__.MemberType object at 0x0000020D[109 chars]748>]

First differing element 0:
'simple_module'
<__main__.MemberType object at 0x0000020DCE9809E8>

First list contains 6 additional elements.
First extra element 3:
True

- ['simple_module',
-  'simple_module/',
-  set(),
-  True,
-  -1,
-  <__main__.MemberType object at 0x0000020DCE9809E8>,
? ^

+ [<__main__.MemberType object at 0x0000020DCE9809E8>,
? ^

   <__main__.MemberType object at 0x0000020DCE99FE80>,
-  <__main__.SimpleModule object at 0x0000020DCE99FEB8>,
   <__main__.MemberType object at 0x0000020DCE980748>]

======================================================================
FAIL: test_flatten1 (<class 'list'>) (__main__.FlattenTest)
FlattenTest.test_flatten1 (<class 'list'>)
test_flatten(<class 'list'>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: ['simple_module', 'simple_module/', set(),[215 chars]A58>] != [<__main__.MemberType object at 0x0000020D[109 chars]A58>]

First differing element 0:
'simple_module'
<__main__.MemberType object at 0x0000020DCE93E828>

First list contains 6 additional elements.
First extra element 3:
True

- ['simple_module',
-  'simple_module/',
-  set(),
-  True,
-  -1,
-  <__main__.MemberType object at 0x0000020DCE93E828>,
? ^

+ [<__main__.MemberType object at 0x0000020DCE93E828>,
? ^

   <__main__.MemberType object at 0x0000020DCE99FEB8>,
-  <__main__.SimpleModule object at 0x0000020DCE99FF28>,
   <__main__.MemberType object at 0x0000020DCE93EA58>]

======================================================================
FAIL: test_flatten2 (<class 'tuple'>) (__main__.FlattenTest)
FlattenTest.test_flatten2 (<class 'tuple'>)
test_flatten(<class 'tuple'>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: ['simple_module', 'simple_module/', set(),[215 chars]748>] != [<__main__.MemberType object at 0x0000020D[109 chars]748>]

First differing element 0:
'simple_module'
<__main__.MemberType object at 0x0000020DCE980898>

First list contains 6 additional elements.
First extra element 3:
True

- ['simple_module',
-  'simple_module/',
-  set(),
-  True,
-  -1,
-  <__main__.MemberType object at 0x0000020DCE980898>,
? ^

+ [<__main__.MemberType object at 0x0000020DCE980898>,
? ^

   <__main__.MemberType object at 0x0000020DCE99FF28>,
-  <__main__.SimpleModule object at 0x0000020DCE99FEF0>,
   <__main__.MemberType object at 0x0000020DCE980748>]

======================================================================
FAIL: test_flatten3 (<function <lambda> at 0x0000020DCE919EA0>) (__main__.FlattenTest)
FlattenTest.test_flatten3 (<function <lambda> at 0x0000020DCE919EA0>)
test_flatten(<function <lambda> at 0x0000020DCE919EA0>)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\parameterized.py", line 286, in bound_param_test
    return test_method(self, testcase_params)
  File "module_test.py", line 934, in test_flatten
    [parent.a[0], parent.a[1], parent.z])
AssertionError: Lists differ: ['simple_module', 'simple_module/', set(),[215 chars]A58>] != [<__main__.MemberType object at 0x0000020D[109 chars]A58>]

First differing element 0:
'simple_module'
<__main__.MemberType object at 0x0000020DCE93E828>

First list contains 6 additional elements.
First extra element 3:
True

- ['simple_module',
-  'simple_module/',
-  set(),
-  True,
-  -1,
-  <__main__.MemberType object at 0x0000020DCE93E828>,
? ^

+ [<__main__.MemberType object at 0x0000020DCE93E828>,
? ^

   <__main__.MemberType object at 0x0000020DCE99FEF0>,
-  <__main__.SimpleModule object at 0x0000020DCE99FF60>,
   <__main__.MemberType object at 0x0000020DCE93EA58>]

======================================================================
FAIL: test_model_discover_submodule (__main__.FlattenTest)
FlattenTest.test_model_discover_submodule
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 1072, in test_model_discover_submodule
    self.assertEqual(m.submodules, (m.layers[0], m.layers[1]))
AssertionError: Tuples differ: (None, False, True, <Policy "infer", loss_[968 chars]>, 2) != (<tensorflow.python.keras.layers.core.Dens[101 chars]A58>)

First differing element 0:
None
<tensorflow.python.keras.layers.core.Dense object at 0x0000020DCE980358>

First tuple contains 27 additional elements.
First extra element 2:
True

- (None,
-  False,
-  True,
-  <Policy "infer", loss_scale=None>,
-  <tensorflow.python.framework.ops.Graph object at 0x0000020D97CF9710>,
-  <tensorflow.python.keras.layers.core.Dense object at 0x0000020DCE980358>,
? ^

+ (<tensorflow.python.keras.layers.core.Dense object at 0x0000020DCE980358>,
? ^

-  <tensorflow.python.keras.layers.core.Dense object at 0x0000020DCE99FA58>,
?                                                                          ^

+  <tensorflow.python.keras.layers.core.Dense object at 0x0000020DCE99FA58>)
?                                                                          ^

-  'sequential',
-  set(),
-  -1,
-  <_thread._local object at 0x0000020DCE99B150>,
-  <tensorflow.python.training.tracking.util.TrackableSaver object at 0x0000020DCE99F2E8>,
-  <Policy "infer", loss_scale=None>,
-  InputSpec(min_ndim=2),
-  'dense',
-  set(),
-  <_thread._local object at 0x0000020DCE906A40>,
-  <function linear at 0x0000020DCC0FBBF8>,
-  <tensorflow.python.ops.init_ops.Zeros object at 0x0000020DCE99F908>,
-  <tensorflow.python.ops.init_ops.GlorotUniform object at 0x0000020DCE99FEF0>,
-  1,
-  <Policy "infer", loss_scale=None>,
-  InputSpec(min_ndim=2),
-  'dense_1',
-  set(),
-  <_thread._local object at 0x0000020DCE906A98>,
-  <tensorflow.python.ops.init_ops.Zeros object at 0x0000020DCE99F400>,
-  <tensorflow.python.ops.init_ops.GlorotUniform object at 0x0000020DCE99F6D8>,
-  2)

======================================================================
FAIL: test_module_discover_layer_variable (__main__.FlattenTest)
FlattenTest.test_module_discover_layer_variable
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 1036, in test_module_discover_layer_variable
    self.assertEmpty(m.variables)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\absltest.py", line 894, in assertEmpty
    self.fail('{!r} has length of {}.'.format(container, len(container)), msg)
  File "C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\absl\testing\absltest.py", line 1764, in fail
    return super(TestCase, self).fail(self._formatMessage(prefix, msg))
AssertionError: ('module', 'module/', set(), True, -1, <tensorflow.python.keras.layers.core.Dense object at 0x0000020DCE99F710>, <tensorflow.python.keras.layers.core.Dense object at 0x0000020DCE99FF28>, None, False, <Policy "infer", loss_scale=None>, InputSpec(min_ndim=2), 'dense', set(), <_thread._local object at 0x0000020DCE997D00>, <function linear at 0x0000020DCC0FBBF8>, <tensorflow.python.ops.init_ops.Zeros object at 0x0000020DCE99F978>, <tensorflow.python.ops.init_ops.GlorotUniform object at 0x0000020DCE99FEF0>, 1, <Policy "infer", loss_scale=None>, InputSpec(min_ndim=2), 'dense_1', set(), <_thread._local object at 0x0000020DCE997D58>, <tensorflow.python.ops.init_ops.Zeros object at 0x0000020DCE99FB70>, <tensorflow.python.ops.init_ops.GlorotUniform object at 0x0000020DCE99F358>, 2) has length of 26.

======================================================================
FAIL: test_with_path (__main__.FlattenTest)
FlattenTest.test_with_path
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 1020, in test_with_path
    ("decoder", "w", 0, 1, "k"): mod.decoder.w[0][1]["k"]},)
AssertionError: {('_name',): 'module', ('_scope_name',): 'module/', ('_self_name_based_restores',): set(), ('_self_setattr_tracking',): True, ('_self_update_uid',): -1, ('decoder', '_name'): 'module', ('decoder', '_scope_name'): 'module_1/', ('decoder', '_self_name_based_restores'): set(), ('decoder', '_self_setattr_tracking'): True, ('decoder', '_self_update_uid'): -1, ('decoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('decoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('decoder',): <tensorflow.python.module.module.Module object at 0x0000020DCE99F7B8>, ('encoder', '_name'): 'module', ('encoder', '_scope_name'): 'module_1/', ('encoder', '_self_name_based_restores'): set(), ('encoder', '_self_setattr_tracking'): True, ('encoder', '_self_update_uid'): -1, ('encoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('encoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('encoder',): <tensorflow.python.module.module.Module object at 0x0000020DCE99F7B8>, ('w',): <tf.Variable 'Variable:0' shape=() dtype=float32>} != {('decoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('decoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('encoder', 'w', 0, 0, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('encoder', 'w', 0, 1, 'k'): <tf.Variable 'Variable:0' shape=() dtype=float32>, ('w',): <tf.Variable 'Variable:0' shape=() dtype=float32>}
Missing entries:
('_name',): 'module'
('_scope_name',): 'module/'
('_self_name_based_restores',): set()
('_self_setattr_tracking',): True
('_self_update_uid',): -1
('decoder',): <tensorflow.python.module.module.Module object at 0x0000020DCE99F7B8>
('decoder', '_name'): 'module'
('decoder', '_scope_name'): 'module_1/'
('decoder', '_self_name_based_restores'): set()
('decoder', '_self_setattr_tracking'): True
('decoder', '_self_update_uid'): -1
('encoder',): <tensorflow.python.module.module.Module object at 0x0000020DCE99F7B8>
('encoder', '_name'): 'module'
('encoder', '_scope_name'): 'module_1/'
('encoder', '_self_name_based_restores'): set()
('encoder', '_self_setattr_tracking'): True
('encoder', '_self_update_uid'): -1


======================================================================
FAIL: test_submodules (__main__.ModuleTrackingTest)
ModuleTrackingTest.test_submodules
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 546, in test_submodules
    self.assertEqual(list(m.submodules), [m.child, m.child.child])
AssertionError: Lists differ: ['badger', 'badger/', set(), True, -1, <__[363 chars]t32>] != [<__main__.RecursiveModule object at 0x000[67 chars]208>]

First differing element 0:
'badger'
<__main__.RecursiveModule object at 0x0000020DCE99F630>

First list contains 13 additional elements.
First extra element 2:
set()

- ['badger',
-  'badger/',
-  set(),
-  True,
-  -1,
-  <__main__.RecursiveModule object at 0x0000020DCE99F630>,
? ^

+ [<__main__.RecursiveModule object at 0x0000020DCE99F630>,
? ^

-  <tf.Variable 'badger/mushroom:0' shape=() dtype=float32>,
-  'badger/badger/',
-  set(),
-  <__main__.RecursiveModule object at 0x0000020DCE99F208>,
?                                                         ^

+  <__main__.RecursiveModule object at 0x0000020DCE99F208>]
?                                                         ^

-  <tf.Variable 'badger/badger/mushroom:0' shape=() dtype=float32>,
-  'badger/badger/badger/',
-  set(),
-  None,
-  <tf.Variable 'badger/badger/badger/mushroom:0' shape=() dtype=float32>]

======================================================================
FAIL: test_supports_distributed_variables (__main__.VariableTrackingTest)
VariableTrackingTest.test_supports_distributed_variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 532, in test_supports_distributed_variables
    self.assertEqual(m.variables, (mirrored, tpu, aggregating))
AssertionError: Tuples differ: ('module', 'module/', set(), True, -1, Mir[265 chars]t32>) != (MirroredVariable:{
  0 /replica:0/task:0/[227 chars]t32>)

First differing element 0:
'module'
MirroredVariable:{
  0 /replica:0/task:0/[60 chars]32>
}

First tuple contains 5 additional elements.
First extra element 3:
True

- ('module',
-  'module/',
-  set(),
-  True,
-  -1,
-  MirroredVariable:{
? ^

+ (MirroredVariable:{
? ^

    0 /replica:0/task:0/device:CPU:0: <tf.Variable 'Variable:0' shape=() dtype=float32>
  },
   TPUMirroredVariable:{
    0 /replica:0/task:0/device:CPU:0: <tf.Variable 'Variable_1:0' shape=() dtype=float32>
  },
   <tf.Variable 'Variable_2:0' shape=() dtype=float32>)

======================================================================
FAIL: test_trainable_variables (__main__.VariableTrackingTest)
VariableTrackingTest.test_trainable_variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 476, in test_trainable_variables
    (m.w, m.child.w, m.child.child.w))
AssertionError: Tuples differ: ('badger', 'badger/', set(), True, -1, <__[363 chars]t32>) != (<tf.Variable 'badger/mushroom:0' shape=()[148 chars]t32>)

First differing element 0:
'badger'
<tf.Variable 'badger/mushroom:0' shape=() dtype=float32>

First tuple contains 12 additional elements.
First extra element 3:
True

- ('badger',
-  'badger/',
-  set(),
-  True,
-  -1,
-  <__main__.RecursiveModule object at 0x0000021020796588>,
-  <tf.Variable 'badger/mushroom:0' shape=() dtype=float32>,
? ^

+ (<tf.Variable 'badger/mushroom:0' shape=() dtype=float32>,
? ^

-  'badger/badger/',
-  set(),
-  <__main__.RecursiveModule object at 0x0000021020776780>,
   <tf.Variable 'badger/badger/mushroom:0' shape=() dtype=float32>,
-  'badger/badger/badger/',
-  set(),
-  None,
   <tf.Variable 'badger/badger/badger/mushroom:0' shape=() dtype=float32>)

======================================================================
FAIL: test_trainable_variables_ignores_non_trainable (__main__.VariableTrackingTest)
VariableTrackingTest.test_trainable_variables_ignores_non_trainable
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 490, in test_trainable_variables_ignores_non_trainable
    self.assertEqual(len(m.trainable_variables), 0)
AssertionError: 15 != 0

======================================================================
FAIL: test_variables (__main__.VariableTrackingTest)
VariableTrackingTest.test_variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "module_test.py", line 462, in test_variables
    self.assertEqual(m.variables, (m.w, m.child.w, m.child.child.w))
AssertionError: Tuples differ: ('badger', 'badger/', set(), True, -1, <__[363 chars]t32>) != (<tf.Variable 'badger/mushroom:0' shape=()[148 chars]t32>)

First differing element 0:
'badger'
<tf.Variable 'badger/mushroom:0' shape=() dtype=float32>

First tuple contains 12 additional elements.
First extra element 3:
True

- ('badger',
-  'badger/',
-  set(),
-  True,
-  -1,
-  <__main__.RecursiveModule object at 0x0000020DCE93EE10>,
-  <tf.Variable 'badger/mushroom:0' shape=() dtype=float32>,
? ^

+ (<tf.Variable 'badger/mushroom:0' shape=() dtype=float32>,
? ^

-  'badger/badger/',
-  set(),
-  <__main__.RecursiveModule object at 0x0000020DCE93ED68>,
   <tf.Variable 'badger/badger/mushroom:0' shape=() dtype=float32>,
-  'badger/badger/badger/',
-  set(),
-  None,
   <tf.Variable 'badger/badger/badger/mushroom:0' shape=() dtype=float32>)

----------------------------------------------------------------------
Ran 50 tests in 2.765s

FAILED (failures=14, errors=1, skipped=10)
