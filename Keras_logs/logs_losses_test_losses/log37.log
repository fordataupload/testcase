2020-10-03 14:54:45.324280: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
============================= test session starts =============================
platform win32 -- Python 3.6.12, pytest-6.0.2, py-1.9.0, pluggy-0.13.1
rootdir: C:\Users\mutation\Desktop\testcase\tests\keras
plugins: flaky-3.7.0
collected 111 items

losses_test.py ......................................................... [ 51%]
.....................FFFFF.F..........................                   [100%]

================================== FAILURES ===================================
_________ TestMeanAbsolutePercentageError.test_all_correct_unweighted _________

self = <losses_test.TestMeanAbsolutePercentageError object at 0x00000141A125FCF8>

    def test_all_correct_unweighted(self):
        mape_obj = losses.MeanAbsolutePercentageError()
        y_true = K.constant([4, 8, 12, 8, 1, 3], shape=(2, 3))
        loss = mape_obj(y_true, y_true)
>       assert np.allclose(K.eval(loss), 0.0, atol=1e-3)
E       AssertionError: assert False
E        +  where False = <function allclose at 0x00000141FF031158>(inf, 0.0, atol=0.001)
E        +    where <function allclose at 0x00000141FF031158> = np.allclose
E        +    and   inf = <function eval at 0x00000141A0E4BBF8>(<tf.Tensor 'mean_absolute_percentage_error/weighted_loss/truediv:0' shape=() dtype=float32>)
E        +      where <function eval at 0x00000141A0E4BBF8> = K.eval

losses_test.py:355: AssertionError
---------------------------- Captured stderr call -----------------------------
2020-10-03 14:54:56.789441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:54:56.790011: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:54:56.790355: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:54:56.790696: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:54:56.791048: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:54:56.791400: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:54:56.791745: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:54:56.792090: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:54:56.792649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:54:56.792951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-03 14:54:56.793297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-03 14:54:56.793514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-03 14:54:56.793994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
_______________ TestMeanAbsolutePercentageError.test_unweighted _______________

self = <losses_test.TestMeanAbsolutePercentageError object at 0x00000141E69BBB38>

    def test_unweighted(self):
        mape_obj = losses.MeanAbsolutePercentageError()
        y_true = K.constant([1, 9, 2, -5, -2, 6], shape=(2, 3))
        y_pred = K.constant([4, 8, 12, 8, 1, 3], shape=(2, 3))
        loss = mape_obj(y_true, y_pred)
>       assert np.allclose(K.eval(loss), 211.8518, atol=1e-3)
E       AssertionError: assert False
E        +  where False = <function allclose at 0x00000141FF031158>(51.101845, 211.8518, atol=0.001)
E        +    where <function allclose at 0x00000141FF031158> = np.allclose
E        +    and   51.101845 = <function eval at 0x00000141A0E4BBF8>(<tf.Tensor 'mean_absolute_percentage_error/weighted_loss/truediv:0' shape=() dtype=float32>)
E        +      where <function eval at 0x00000141A0E4BBF8> = K.eval

losses_test.py:362: AssertionError
---------------------------- Captured stderr call -----------------------------
2020-10-03 14:54:58.218091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:54:58.218674: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:54:58.219029: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:54:58.219374: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:54:58.219710: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:54:58.220052: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:54:58.220395: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:54:58.220737: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:54:58.221294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:54:58.221607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-03 14:54:58.221958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-03 14:54:58.222176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-03 14:54:58.222668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
____________ TestMeanAbsolutePercentageError.test_scalar_weighted _____________

self = <losses_test.TestMeanAbsolutePercentageError object at 0x0000014430A59908>

    def test_scalar_weighted(self):
        mape_obj = losses.MeanAbsolutePercentageError()
        y_true = K.constant([1, 9, 2, -5, -2, 6], shape=(2, 3))
        y_pred = K.constant([4, 8, 12, 8, 1, 3], shape=(2, 3))
        loss = mape_obj(y_true, y_pred, sample_weight=2.3)
>       assert np.allclose(K.eval(loss), 487.259, atol=1e-3)
E       AssertionError: assert False
E        +  where False = <function allclose at 0x00000141FF031158>(117.53424, 487.259, atol=0.001)
E        +    where <function allclose at 0x00000141FF031158> = np.allclose
E        +    and   117.53424 = <function eval at 0x00000141A0E4BBF8>(<tf.Tensor 'mean_absolute_percentage_error/weighted_loss/truediv:0' shape=() dtype=float32>)
E        +      where <function eval at 0x00000141A0E4BBF8> = K.eval

losses_test.py:369: AssertionError
---------------------------- Captured stderr call -----------------------------
2020-10-03 14:54:58.287270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:54:58.287850: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:54:58.288199: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:54:58.288544: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:54:58.288882: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:54:58.289223: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:54:58.289602: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:54:58.289971: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:54:58.290567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:54:58.290895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-03 14:54:58.291244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-03 14:54:58.291461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-03 14:54:58.291948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
____________ TestMeanAbsolutePercentageError.test_sample_weighted _____________

self = <losses_test.TestMeanAbsolutePercentageError object at 0x00000144298A64E0>

    def test_sample_weighted(self):
        mape_obj = losses.MeanAbsolutePercentageError()
        y_true = K.constant([1, 9, 2, -5, -2, 6], shape=(2, 3))
        y_pred = K.constant([4, 8, 12, 8, 1, 3], shape=(2, 3))
        sample_weight = K.constant([1.2, 3.4], shape=(2, 1))
        loss = mape_obj(y_true, y_pred, sample_weight=sample_weight)
>       assert np.allclose(K.eval(loss), 422.8888, atol=1e-3)
E       AssertionError: assert False
E        +  where False = <function allclose at 0x00000141FF031158>(133.06136, 422.8888, atol=0.001)
E        +    where <function allclose at 0x00000141FF031158> = np.allclose
E        +    and   133.06136 = <function eval at 0x00000141A0E4BBF8>(<tf.Tensor 'mean_absolute_percentage_error/weighted_loss/truediv:0' shape=() dtype=float32>)
E        +      where <function eval at 0x00000141A0E4BBF8> = K.eval

losses_test.py:377: AssertionError
---------------------------- Captured stderr call -----------------------------
2020-10-03 14:54:58.403810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:54:58.404478: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:54:58.404853: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:54:58.405225: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:54:58.405596: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:54:58.405940: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:54:58.406284: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:54:58.406633: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:54:58.407200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:54:58.407516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-03 14:54:58.407864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-03 14:54:58.408080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-03 14:54:58.408572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
___________ TestMeanAbsolutePercentageError.test_timestep_weighted ____________

self = <losses_test.TestMeanAbsolutePercentageError object at 0x00000141A7BCC320>

    def test_timestep_weighted(self):
        mape_obj = losses.MeanAbsolutePercentageError()
        y_true = K.constant([1, 9, 2, -5, -2, 6], shape=(2, 3, 1))
        y_pred = K.constant([4, 8, 12, 8, 1, 3], shape=(2, 3, 1))
        sample_weight = K.constant([3, 6, 5, 0, 4, 2], shape=(2, 3))
        loss = mape_obj(y_true, y_pred, sample_weight=sample_weight)
>       assert np.allclose(K.eval(loss), 694.4445, atol=1e-3)
E       AssertionError: assert False
E        +  where False = <function allclose at 0x00000141FF031158>(1044.4445, 694.4445, atol=0.001)
E        +    where <function allclose at 0x00000141FF031158> = np.allclose
E        +    and   1044.4445 = <function eval at 0x00000141A0E4BBF8>(<tf.Tensor 'mean_absolute_percentage_error/weighted_loss/truediv:0' shape=() dtype=float32>)
E        +      where <function eval at 0x00000141A0E4BBF8> = K.eval

losses_test.py:385: AssertionError
---------------------------- Captured stderr call -----------------------------
2020-10-03 14:54:58.471988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:54:58.472580: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:54:58.472959: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:54:58.473324: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:54:58.473686: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:54:58.474041: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:54:58.474384: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:54:58.474728: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:54:58.475282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:54:58.475613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-03 14:54:58.475988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-03 14:54:58.476223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-03 14:54:58.476734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
______________ TestMeanAbsolutePercentageError.test_no_reduction ______________

self = <losses_test.TestMeanAbsolutePercentageError object at 0x00000141A126D668>

    def test_no_reduction(self):
        mape_obj = losses.MeanAbsolutePercentageError(
            reduction=losses_utils.Reduction.NONE)
        y_true = K.constant([1, 9, 2, -5, -2, 6], shape=(2, 3))
        y_pred = K.constant([4, 8, 12, 8, 1, 3], shape=(2, 3))
        loss = mape_obj(y_true, y_pred, sample_weight=2.3)
>       assert np.allclose(K.eval(loss), [621.8518, 352.6666], atol=1e-3)
E       AssertionError: assert False
E        +  where False = <function allclose at 0x00000141FF031158>(array([ 85.06849, 150.     ], dtype=float32), [621.8518, 352.6666], atol=0.001)
E        +    where <function allclose at 0x00000141FF031158> = np.allclose
E        +    and   array([ 85.06849, 150.     ], dtype=float32) = <function eval at 0x00000141A0E4BBF8>(<tf.Tensor 'mean_absolute_percentage_error/weighted_loss/mul:0' shape=(2,) dtype=float32>)
E        +      where <function eval at 0x00000141A0E4BBF8> = K.eval

losses_test.py:400: AssertionError
---------------------------- Captured stderr call -----------------------------
2020-10-03 14:54:58.584203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:54:58.585227: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:54:58.585868: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:54:58.586504: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:54:58.587131: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:54:58.587763: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:54:58.588401: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:54:58.589041: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:54:58.589911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:54:58.590255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-03 14:54:58.590629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-03 14:54:58.590862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-03 14:54:58.591375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
=========================== short test summary info ===========================
FAILED losses_test.py::TestMeanAbsolutePercentageError::test_all_correct_unweighted
FAILED losses_test.py::TestMeanAbsolutePercentageError::test_unweighted - Ass...
FAILED losses_test.py::TestMeanAbsolutePercentageError::test_scalar_weighted
FAILED losses_test.py::TestMeanAbsolutePercentageError::test_sample_weighted
FAILED losses_test.py::TestMeanAbsolutePercentageError::test_timestep_weighted
FAILED losses_test.py::TestMeanAbsolutePercentageError::test_no_reduction - A...
======================= 6 failed, 105 passed in 10.81s ========================
