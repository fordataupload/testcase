2020-10-03 14:41:50.794914: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
============================= test session starts =============================
platform win32 -- Python 3.6.12, pytest-6.0.2, py-1.9.0, pluggy-0.13.1
rootdir: C:\Users\mutation\Desktop\testcase\tests\keras
plugins: flaky-3.7.0
collected 15 items

activations_test.py ..F.F..........                                      [100%]

================================== FAILURES ===================================
_____________________________ test_softmax_valid ______________________________

    def test_softmax_valid():
        """Test using a reference implementation of softmax.
        """
        def softmax(values):
            m = np.max(values)
            e = np.exp(values - m)
            return e / np.sum(e)
    
        x = K.placeholder(ndim=2)
>       f = K.function([x], [activations.softmax(x)])

activations_test.py:63: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

x = <tf.Tensor 'Placeholder:0' shape=(?, ?) dtype=float32>, axis = -1

    def softmax(x, axis=-1):
        """Softmax activation function.
    
        # Arguments
            x: Input tensor.
            axis: Integer, axis along which the softmax normalization is applied.
    
        # Returns
            Tensor, output of softmax transformation.
    
        # Raises
            ValueError: In case `dim(x) == 1`.
        """
        ndim = K.ndim(x)
        if ndim == 3:
            return K.softmax(x)
        elif ndim > 2:
            e = K.exp(x - K.max(x, axis=axis, keepdims=True))
            s = K.sum(e, axis=axis, keepdims=True)
            return e / s
        else:
            raise ValueError('Cannot apply softmax to a tensor that is 1D. '
>                            'Received input: %s' % x)
E           ValueError: Cannot apply softmax to a tensor that is 1D. Received input: Tensor("Placeholder:0", shape=(?, ?), dtype=float32)

C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\keras\activations.py:36: ValueError
_______________________________ test_softmax_3d _______________________________

    def test_softmax_3d():
        """Test using a reference implementation of softmax.
        """
        def softmax(values, axis):
            m = np.max(values, axis=axis, keepdims=True)
            e = np.exp(values - m)
            return e / np.sum(e, axis=axis, keepdims=True)
    
        x = K.placeholder(ndim=3)
        f = K.function([x], [activations.softmax(x, axis=1)])
        test_values = get_standard_values()[:, :, np.newaxis].copy()
    
        result = f([test_values])[0]
        expected = softmax(test_values, axis=1)
>       assert_allclose(result, expected, rtol=1e-05)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-05, atol=0
E       
E       Mismatched elements: 5 / 5 (100%)
E       Max absolute difference: 0.8880402
E       Max relative difference: 7.9317765
E        x: array([[[1.],
E               [1.],
E               [1.],...
E        y: array([[[0.11196 ],
E               [0.123735],
E               [0.184591],...

activations_test.py:96: AssertionError
---------------------------- Captured stderr call -----------------------------
2020-10-03 14:41:54.788407: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-10-03 14:41:54.909674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:41:54.911393: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:41:54.917092: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:41:54.922873: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:41:54.924724: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:41:54.931135: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:41:54.935258: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:41:54.947295: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:41:54.948308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:41:54.949030: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
2020-10-03 14:41:54.964715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.65
pciBusID: 0000:73:00.0
2020-10-03 14:41:54.965272: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-10-03 14:41:54.965665: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-10-03 14:41:54.966068: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-10-03 14:41:54.966497: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-10-03 14:41:54.966932: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-10-03 14:41:54.967302: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-10-03 14:41:54.967656: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-10-03 14:41:54.968646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-10-03 14:41:56.029035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-03 14:41:56.029867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-10-03 14:41:56.030088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-10-03 14:41:56.031012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 8686 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:73:00.0, compute capability: 7.5)
Using TensorFlow backend.
WARNING:tensorflow:From C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\keras\backend\tensorflow_backend.py:422: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

------------------------------ Captured log call ------------------------------
WARNING  tensorflow:module_wrapper.py:139 From C:\ProgramData\Anaconda3\envs\keras\lib\site-packages\keras\backend\tensorflow_backend.py:422: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.
=========================== short test summary info ===========================
FAILED activations_test.py::test_softmax_valid - ValueError: Cannot apply sof...
FAILED activations_test.py::test_softmax_3d - AssertionError: 
======================== 2 failed, 13 passed in 2.94s =========================
